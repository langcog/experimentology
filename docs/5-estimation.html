<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 5 Estimation | Experimentology" />
<meta property="og:type" content="book" />





<meta name="author" content="Michael C. Frank, Mika Braginsky, Julie Cachia, Nicholas Coles, Tom Hardwicke, Robert Hawkins, Maya Mathur, and Rondeline Williams" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Chapter 5 Estimation | Experimentology">

<title>Chapter 5 Estimation | Experimentology</title>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="toc/toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="part"><span><b>I Preliminaries</b></span></li>
<li><a href="1-experiments.html#experiments"><span class="toc-section-number">1</span> Experiments</a></li>
<li><a href="2-theories.html#theories"><span class="toc-section-number">2</span> Theories</a></li>
<li><a href="3-replication.html#replication"><span class="toc-section-number">3</span> Replication and reproducibility</a></li>
<li><a href="4-ethics.html#ethics"><span class="toc-section-number">4</span> Ethics</a></li>
<li class="part"><span><b>II Statistics</b></span></li>
<li><a href="5-estimation.html#estimation"><span class="toc-section-number">5</span> Estimation</a></li>
<li><a href="6-inference.html#inference"><span class="toc-section-number">6</span> Inference</a></li>
<li><a href="7-models.html#models"><span class="toc-section-number">7</span> Models</a></li>
<li class="part"><span><b>III Design and Planning</b></span></li>
<li><a href="8-measurement.html#measurement"><span class="toc-section-number">8</span> Measurement</a></li>
<li><a href="9-design.html#design"><span class="toc-section-number">9</span> Design of experiments</a></li>
<li><a href="10-sampling.html#sampling"><span class="toc-section-number">10</span> Sampling</a></li>
<li><a href="11-prereg.html#prereg"><span class="toc-section-number">11</span> Preregistration</a></li>
<li class="part"><span><b>IV Execution</b></span></li>
<li><a href="12-selection.html#selection"><span class="toc-section-number">12</span> Experimental strategy</a></li>
<li><a href="13-collection.html#collection"><span class="toc-section-number">13</span> Data collection</a></li>
<li><a href="14-management.html#management"><span class="toc-section-number">14</span> Project management</a></li>
<li class="part"><span><b>V Analysis and Reporting</b></span></li>
<li><a href="15-viz.html#viz"><span class="toc-section-number">15</span> Visualization</a></li>
<li><a href="16-eda.html#eda"><span class="toc-section-number">16</span> Exploratory data analysis</a></li>
<li><a href="17-writing.html#writing"><span class="toc-section-number">17</span> Reproducible writing</a></li>
<li><a href="18-meta.html#meta"><span class="toc-section-number">18</span> Meta-analysis</a></li>
<li><a href="19-conclusions.html#conclusions"><span class="toc-section-number">19</span> Conclusions</a></li>
<li class="part"><span><b>VI Appendices</b></span></li>
<li><a href="20-git.html#git"><span class="toc-section-number">20</span> GitHub Tutorial</a></li>
<li><a href="21-rmarkdown.html#rmarkdown"><span class="toc-section-number">21</span> R Markdown Tutorial</a></li>
<li><a href="22-tidyverse.html#tidyverse"><span class="toc-section-number">22</span> Tidyverse Tutorial</a></li>
<li><a href="23-ggplot.html#ggplot"><span class="toc-section-number">23</span> ggplot Tutorial</a></li>
<li><a href="24-instructors.html#instructors"><span class="toc-section-number">24</span> Instructor‚Äôs guide</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="estimation" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Estimation</h1>
<p><img src="images/estimation/meme.jpg" width="\linewidth"  /></p>
<div class="learning-goals">
<p>üçé Learning goals:</p>
<ul>
<li>Contrast inference and estimation as two goals of statistical analysis</li>
<li>Discuss differences between frequentist and Bayesian perspectives</li>
<li>Reason about standardized effect sizes and their strengths and weaknesses</li>
</ul>
</div>
<p>In the first section of this book, our goal was to set up some of the theoretical ideas that motivate our approach to experimental design and planning. We introduced our key thesis, namely that experiments are about measuring causal effects. We also began to discuss some of our key themes, including precision of measurement, reduction of bias, and generalization across populations. In this next section of the book ‚Äì treating statistical topics ‚Äì we will integrate these ideas with an analytic toolkit for <strong>estimating</strong> effects, <strong>quantifying the size and precision</strong> of these estimates (this chapter), making <strong>inferences</strong> about the evidence for such effects (Chapter <a href="6-inference.html#inference">6</a>), and making <strong>models</strong> for estimation and inference in more complex settings (Chapter <a href="7-models.html#models">7</a>). Although this book is not a statistics text, we hope that these chapters provide some practical foundations for beginning the statistical analysis of your experimental data.</p>
<div class="case-study">
<p>üî¨ Case study: The Lady Tasting Tea</p>
<p>The birth of modern statistical inference came from a single, epochal act of mansplaining.<label for="tufte-sn-54" class="margin-toggle sidenote-number">54</label><input type="checkbox" id="tufte-sn-54" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">54</span> If you would like a credential helper to help you store the PAT, follow instructions <a href="https://docs.github.com/en/get-started/getting-started-with-git/caching-your-github-credentials-in-git">here</a> based on your operation system.</span> Sir Ronald Fisher was apparently at a party when a lady declared that she could tell the difference between cups when the tea was added to the milk vs.¬†the milk to the tea. Rather than taking her at her word, Fisher devised an experimental and data analysis procedure to test her claim.<label for="tufte-sn-55" class="margin-toggle sidenote-number">55</label><input type="checkbox" id="tufte-sn-55" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">55</span> There will be lots of files that are simple text files, with <strong>.md</strong>, <strong>.rmd</strong> etc. as filetypes. You can open all these with a text editor. Although your computer comes with a default one (e.g.¬†Notepad, TextEdit), we would recommend downloading <a href="https://www.sublimetext.com/3">Sublime Text</a>, which is free and has a lot of powerful tools that will be helpful in the future.</span></p>
<p>The basic schema of the experiment was that the lady would have to judge a set of new cups of tea and sort them into milk-first vs.¬†tea-first sets. Her data would then be analyzed to determine whether her level of correct choice exceeded that expected by chance. While this process now sounds like a quotidian experiment that might be done on a cooking reality show, it seems unremarkable only because it literally established the way science was done for the next century.</p>
<p>One important and unusual element of the experiment was its treatment of design confounds such as pouring order or cup material. Prior experimental practice would have been to try to equate all of the cups as closely as possible, decreasing the influence of confounders. Fisher recognized that this strategy was insufficient. Random assignment was critical for making strong causal inferences about the treatment (milk then tea vs.¬†tea then milk). We discussed the causal power of random assignment in Chapter <a href="1-experiments.html#experiments">1</a> ‚Äì this experiment is a key touchstone in the popularization of randomized experiments!<label for="tufte-sn-56" class="margin-toggle sidenote-number">56</label><input type="checkbox" id="tufte-sn-56" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">56</span> For future reference (feel free to ignore this!): you can add just part of the file by using <code>git add -p README.md</code> and following the instructions at the bottom of the terminal window.</span></p>
</div>
<div id="estimating-a-quantity" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Estimating a quantity</h2>
<p>If experiments are about estimating effects, how do we actually use our experimental data to make these estimates? With apologies to Fisher, for our example we‚Äôll design a slightly more modern version of his experiment using a Likert scale (1‚Äì7 ratings) and a between-participants design (so each participant gets only one cup of tea). Each of these elements will be discussed in more detail in future chapters.</p>
<p>Our causal theory is that the tea quality is affected by milk ordering, so we‚Äôll test that by rating tea quality both milk-first and tea-first. We‚Äôll do this as a field trial in an English tea cafe: when people order tea with milk, we‚Äôll randomly present it milk-first or tea-first and then elicit a rating on a Likert scale from 1 (terrible) to 7 (delicious). We‚Äôll do this for 48 customers and then take a look at the data.<label for="tufte-sn-57" class="margin-toggle sidenote-number">57</label><input type="checkbox" id="tufte-sn-57" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">57</span> We‚Äôll be using R and RStudio in the future. If you do not yet have those downloaded, you can open up a text editor and do the same thing.</span></p>
<p>Eventually, we‚Äôll want to estimate the effect of milk-first preparation on quality ratings (our effect of interest). But for now, our goal will be to estimate the quality of the tea when it is milk-first [the better way, according to some data; <span class="citation"><a href="#ref-kennedy2003" role="doc-biblioref">Kennedy</a> (<a href="#ref-kennedy2003" role="doc-biblioref">2003</a>)</span>]. More formally, we want to use our <strong>sample</strong> of 24 milk-first tea judgments to estimate a <strong>population parameter</strong> that we can‚Äôt directly observe, namely the true perceived quality of all possible milk-first cups.</p>
<p>We‚Äôll try to go easy on notation but some amount will make things clearer. We will use <span class="math inline">\(\theta\)</span> (‚Äútheta‚Äù) to denote the parameter we want to estimate (the <strong>population parameter</strong> or ‚Äúestimand,‚Äù though we will try not to say that word too much) and <span class="math inline">\(\widehat{\theta}\)</span>, its <strong>sample estimate</strong>.<label for="tufte-sn-58" class="margin-toggle sidenote-number">58</label><input type="checkbox" id="tufte-sn-58" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">58</span> Statisticians use ‚Äúhats‚Äù like this to denote sample estimates. One way to remember this is that the ‚Äúperson in the hat‚Äù is wearing a hat to dress up as the actual quantity. Feel free to ignore this mnemonic; it helps us.</span></p>
<!-- [^8]: Out of date -->
<!-- \[Note from NC: we do not currently use the terms "sample estimate", "point estimate" and "estimands" consistently in this chapter. For example, in the section on the precision of mean estimates, we refer to "point estimates" and "population parameters", but here we talk about "estimands" and "sample estimates")\] -->
<div id="maximum-likelihood-estimation" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Maximum likelihood estimation</h3>
<p>OK, you are probably saying, if we we want our estimate of milk-first quality, shouldn‚Äôt we just take the average rating across the 24 cups of milk-first tea? The answer is yes. But let‚Äôs unpack that choice: taking the sample mean as our estimate <span class="math inline">\(\widehat{\theta}\)</span> is an example of an estimation approach called <strong>maximum likelihood estimation</strong>. In general terms, maximum likelihood estimation is a two-step process.</p>
<p>First, we assume a <strong>model</strong> for how the data were generated. This model is specified in terms of certain population parameters. In our example, the ‚Äúmodel‚Äù is as simple as they come: we just assume there is some average level of tea quality and that the measurements vary around it.</p>
<p>Second, we try to find the values of the population parameters that make our observed data as likely as possible. For example, if our sample mean is <span class="math inline">\(\widehat{\theta_{milk first}} = 4.5\)</span>, what underlying value of <span class="math inline">\(\theta_{milk first}\)</span> would make these data most likely to occur? Well, suppose the underlying parameter were <span class="math inline">\(\theta_{milk first}=2.5\)</span>. Then it would be pretty unlikely that our sample mean would be so much bigger. So <span class="math inline">\(\theta_{milk first}=2.5\)</span> is a poor guess for the population parameter based on these data. Conversely, if the parameter were <span class="math inline">\(\theta_{milk first}=6.5\)</span>, it would be a bit unlikely that our sample mean would be so much <em>smaller</em>. The value of <span class="math inline">\(\theta_{milk first}\)</span> that makes these data most likely is just 4.5 itself: the sample mean! That is why the sample mean in this case is the maximum likelihood estimate.</p>
</div>
<div id="estimating-variation-in-ratings" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Estimating variation in ratings</h3>
<p>Let‚Äôs visualize our 24 milk-first tea ratings. Since ratings on our scale are discrete, Figure <a href="5-estimation.html#fig:estimation-milk-first">5.1</a> shows them as a histogram. Our estimate of the mean, <span class="math inline">\(\widehat{\theta_{milk first}}\)</span>, is shown as a blue dashed line.</p>
<div class="figure"><span id="fig:estimation-milk-first"></span>
<p class="caption marginnote shownote">
Figure 5.1: Ratings of the quality of milk-first tea, with the best fitting normal distribution shown in blue (mean shown by the dashed line).
</p>
<img src="experimentology_files/figure-html/estimation-milk-first-1.png" alt="Ratings of the quality of milk-first tea, with the best fitting normal distribution shown in blue (mean shown by the dashed line)." width="\linewidth"  />
</div>
<p>Our observations are clustered around the mean, but they also show some variation. Some are higher and some are lower. Variation of this type is a feature of every data set. This variation can be summarized via a <strong>probability distribution</strong>, a mathematical entity that describes the properties of possible datasets. The only probability distribution we‚Äôll discuss here is the ubiquitous <strong>normal distribution</strong> (also sometimes called a ‚ÄúGaussian distribution‚Äù). A normal distribution has two <strong>parameters</strong>, a <strong>mean</strong> and a <strong>standard deviation</strong>. These two parameters define the shape of the curve. The mean describes where its center goes, and the standard deviation describes how wide it is.</p>
<p>The blue curve shown in Figure <a href="5-estimation.html#fig:estimation-milk-first">5.1</a> is the normal distribution that is closest to the data in our milk-first condition. Its mean is of course <span class="math inline">\(\widehat{\theta_{milk first}}\)</span>, the parameter we just estimated. But to plot this curve, we also had to estimate the standard deviation. It turns out that the standard deviation is just exactly what its name says: the average deviation between the mean and any given observation. We won‚Äôt discuss how to estimate the standard deviation for your sample here; you can do this computation easily in any software package. What‚Äôs important for now is just that the standard deviation gives us a way to describe the width of the normal distribution.</p>
</div>
<div id="bayesian-estimation" class="section level3" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Bayesian estimation</h3>
<p>The maximum likelihood estimation example above describes a common approach to estimating values, where the researcher completely puts aside their prior expectations about what these values might be. Often this approach makes sense, especially when we have no prior expectations about the values we are estimating. But sometimes we <em>do</em> have relevant beliefs about the value. For example, before we perform our tea experiment, we don‚Äôt know exactly what <span class="math inline">\(\theta\)</span> will be, but it seems a bit unlikely that tea would be consistently rated as either horrible (1) or perfect (7). We have what you might call <em>weak prior expectations</em> about the kinds of ratings we‚Äôll receive.</p>
<p>These kind of expectations are most useful when we have a very small amount of data. For example, if our very first participant in the experiment rated their tea as terrible, we wouldn‚Äôt want to jump to the conclusion that the tea was actually bad. Instead, we might speculate that the participant was having a bad day or just brushed their teeth. On the other hand, if all of our participants gave bad ratings to their tea, the data would be more persuasive; in that case, we might want to tell the cafe that they are serving substandard tea. With a little data, our prior expectations should moderate our conclusions; as we get more, we should put greater weight on the data.</p>
<p>How do we quantify this tradeoff between our prior expectations and our current observations? We can do this via <strong>Bayesian estimation</strong> of <span class="math inline">\(\theta_{milkfirst}\)</span>. Bayesian estimation provides a principled framework for integrating prior beliefs and data. These estimation techniques can be very helpful in cases where data are sparse or prior beliefs are strong.</p>
<p>In Bayesian estimation, we observe some data <span class="math inline">\(d\)</span>, consisting of the set of correct and incorrect responses in the experiment. Now we can use <strong>Bayes‚Äô rule</strong>, a tool from basic probability theory, to estimate this number. Bayes‚Äô rule says:</p>
<p><span class="math display">\[
\color{purple}{p(\theta | d)} = \frac{\color{red}{p(d | \theta )} \color{blue}{p(\theta )}}{\color{black}{p(d)}}.
\]</span></p>
<p>Each part of this equation has a name, and it‚Äôs worth becoming familiar with them. The thing we want to compute (<span class="math inline">\(p(\theta |d)\)</span>) is called the <strong>posterior probability</strong> ‚Äì it tell us what we should believe about the population parameter on tea quality, given the data we observed.<label for="tufte-sn-59" class="margin-toggle sidenote-number">59</label><input type="checkbox" id="tufte-sn-59" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">59</span> A confidence interval and <span class="math inline">\(p\)</span>-value for the random-effects estimate <span class="math inline">\(\widehat{\mu}\)</span> can be obtained using standard theory for maximum likelihood estimates with an additional adjustment that helps account for uncertainty in estimating <span class="math inline">\(\tau\)</span> <span class="citation">(<a href="#ref-knapp2003improved" role="doc-biblioref">Knapp &amp; Hartung, 2003</a>)</span>.</span></p>
<p>The first part of the numerator is <span class="math inline">\(p(d|h)\)</span>, the probability of the data we observed given our hypothesis about the participant‚Äôs ability. This part is called the <strong>likelihood</strong>.<label for="tufte-sn-60" class="margin-toggle sidenote-number">60</label><input type="checkbox" id="tufte-sn-60" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">60</span> The estimate of <span class="math inline">\(\widehat{\tau}^2\)</span> is a bit more complicated, but is essentially a weighted average of studies‚Äô residuals, <span class="math inline">\(\widehat{\theta_i} - \widehat{\mu}\)</span>, while subtracting away variation due to statistical error, <span class="math inline">\(\widehat{\sigma}^2_i\)</span> <span class="citation">(<a href="#ref-brockwell2001comparison" role="doc-biblioref">Brockwell &amp; Gordon, 2001</a>; <a href="#ref-dersimonian1986meta" role="doc-biblioref">DerSimonian &amp; Laird, 1986</a>)</span>.</span> This term tells us about the relationship between our hypothesis and the data we observed ‚Äì so if we think the tea is of high quality (say <span class="math inline">\(\theta = 6.5\)</span>) then the probability of a bunch of low accuracy observations will be fairly low.</p>
<p>The second term in the numerator, <span class="math inline">\(p(\theta )\)</span>, is called the <strong>prior</strong>. This term encodes our beliefs about the likely distribution of tea quality. Intuitively, if we think that the tea is likely of high quality, we should require more evidence to convince us that it‚Äôs bad. In contrast, if we think it‚Äôs probably bad, a few examples of low ratings might serve to convince us.</p>
<div class="figure"><span id="fig:inference-bayes-demo"></span>
<p class="caption marginnote shownote">
Figure 5.2: Examples of Bayesian inference about tea ratings under two different priors (facets) and just a little bit of data. Blue lines give the prior probability distribution, red lines give the likelihood of the data, and purple lines give the posterior distribution from combining likelihood and prior.
</p>
<img src="experimentology_files/figure-html/inference-bayes-demo-1.png" alt="Examples of Bayesian inference about tea ratings under two different priors (facets) and just a little bit of data. Blue lines give the prior probability distribution, red lines give the likelihood of the data, and purple lines give the posterior distribution from combining likelihood and prior." width="\linewidth"  />
</div>
<p>Figure <a href="5-estimation.html#fig:inference-bayes-demo">5.2</a> gives an example of the combination of prior and data. In this example, we look at what difference the prior makes after observing 3 ratings. If we go in assuming that the tea is likely to be bad, we are biased downward in our highest posterior probability estimate of 4.7; if we go in assuming good discrimination, we end up biased upwards to 5.2.</p>
<div class="figure"><span id="fig:inference-bayes-demo2"></span>
<p class="caption marginnote shownote">
Figure 5.3: Bayesian inference about tea ratings under two different priors with the full dataset.
</p>
<img src="experimentology_files/figure-html/inference-bayes-demo2-1.png" alt="Bayesian inference about tea ratings under two different priors with the full dataset." width="\linewidth"  />
</div>
<p>Contrast that figure with Figure <a href="5-estimation.html#fig:inference-bayes-demo2">5.3</a>, which runs the same Bayesian estimation but with the full dataset of 24 observations. Now the posterior distribution is much more peaked. The prior also makes much less difference to our highest-probability estimates. With the low prior, our estimate is 4.4; with the high prior it is 4.5 also!</p>
<p>Bayesian estimation is most important when you have strong beliefs and not a lot of data. That can be a case where you have just a few participants in your experiment, but it‚Äôs also good ‚Äì and perhaps more common ‚Äì to use Bayesian methods when you have a lot of data, but maybe not that much data about particular units that you care about. For example, you might have a large dataset about the effects of an educational intervention but not that much data about how it affects a particular subgroup. In general, though, Bayesian estimates and maximum likelihood estimates will exactly coincide either under a flat prior or as you get infinite data.</p>
</div>
</div>
<div id="estimating-and-comparing-effects" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Estimating and comparing effects</h2>
<p>We‚Äôve now covered estimating a single parameter (the mean in just the milk-first group) using both frequentist and Bayesian methods. But recall that what we really wanted to do was to estimate the causal effect we were interested in, namely the milk-first vs.¬†tea-first effect.<label for="tufte-sn-61" class="margin-toggle sidenote-number">61</label><input type="checkbox" id="tufte-sn-61" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">61</span> This method doesn‚Äôt have to be used only with a causal effect, it can be any between-group difference. Currently this effect just happens to be causal because our experiment uses random assignment.</span> In this section, we‚Äôll discuss how to estimate the effect, and then how to use <strong>effect size</strong> measures to compare effects across experiments (as well as some of the pros and cons of doing so).</p>
<div id="estimating-the-treatment-effect" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Estimating the treatment effect</h3>
<p>Let‚Äôs refer to the causal effect we care about as our <strong>treatment effect</strong>, called. In practice, estimating <span class="math inline">\(\Delta\)</span> is going to be a pretty straightforward extension to what we did before.</p>
<p>In the maximum likelihood framework, we could posit that ratings in each group (milk-first and tea-first) follow a normal distribution, but that these normal distributions might have different means and standard deviations. Extending the notation introduced above, let‚Äôs term the parameters for the tea-first group <span class="math inline">\(\theta_{teafirst}\)</span> and <span class="math inline">\(\sigma_{teafirst}\)</span>. To estimate the treatment effect, we are positing a <strong>model</strong> in which the milk-first ratings are normally distributed with mean <span class="math inline">\(\theta_{milkfirst} = \theta_{teafirst} + \Delta\)</span> and with standard deviation <span class="math inline">\(\sigma_{milkfirst}\)</span>.</p>
<p>As in the one-sample case (i.e., estimating the mean of just the milk-first group), maximum likelihood estimation would then proceed by finding the value of <span class="math inline">\(\Delta\)</span> that makes the data most likely under the assumed model. As you‚Äôd probably expect, this estimate <span class="math inline">\(\widehat{\Delta}\)</span> turns out to be simply the difference in sample means, <span class="math inline">\(\theta_{milkfirst} - \theta_{teafirst}\)</span>.</p>
<p>In the Bayesian framework, we would again specify a prior <span class="math inline">\(p(\Delta )\)</span> that encodes our prior beliefs about the size and direction of the treatment effect. If we have no prior beliefs at all, then we could specify a flat prior, <span class="math inline">\(p(\Delta ) \propto 1\)</span>. If we believe the treatment effect is likely to favor milk-first pouring (<span class="math inline">\(\Delta&gt;0\)</span>), we could specify a normal prior centered at some positive value (e.g., <span class="math inline">\(\Delta=0.5\)</span>); the standard deviation of this prior would encode how certain we are about our prior beliefs. And if we have no prior beliefs about the direction of the treatment effect, but we think it is unlikely to be very large, we could specify a normal prior centered at 0, which has the effect of ‚Äúshrinking‚Äù the estimates closer to 0.<label for="tufte-sn-62" class="margin-toggle sidenote-number">62</label><input type="checkbox" id="tufte-sn-62" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">62</span> The measures of variability that we discuss here account for statistical uncertainty reflecting the fact that we have only a finite sample size. If the sample size were infinite, there would be no uncertainty of this kind. Of course, this is only one kind of uncertainty! A more holistic view of the overall credibility of an estimate should also account for other things outside of the model, like study design issues and bias.</span></p>
<p>As in our example above, maximum likelihood estimates and Bayesian estimates are going to be pretty similar if we have a lot of data. They will only diverge when we have strong priors or relatively little data. The reason we are setting up these two different frameworks, however, is that they will provide very different inferential tools in the next chapter.</p>
</div>
<div id="measures-of-effect-size" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Measures of effect size</h3>
<p>Once we have measured something, we need to make a decision about how to describe this effect to the world. Sometimes we are working with fairly intuitive relationships that are easy to describe. A researcher might say, for example, that people who received milk-first tea drank the tea, on average, 5 minutes quicker than people who received tea-first tea (i.e., that <span class="math inline">\(\widehat{\Delta}_{time} = 5\)</span>). Time is measured in units like minutes and seconds and so we all have a shared understanding of what 5 minutes means.</p>
<p>But what about our participants‚Äô ratings of tea quality, which were provided on an arbitrary 7-point rating scale that we devised? What does it mean to that participants who drank milk-first tea rated it 1 point higher than participants who drank tea-first tea (i.e., that <span class="math inline">\(\widehat{\Delta}_{rating} = 1\)</span>)? And how is this difference comparable to, for instance, a 1-point change on a scale that has similar anchors (‚Äúterrible‚Äù and ‚Äúdelicious‚Äù) but uses a 100-point rating system?</p>
<p>To provide a common language for describing these relationships, some researchers use <em>standardized effect sizes.</em> A common standardized effect size is Cohen‚Äôs <em>d</em>, which provides a standardized estimate of the difference between two means. There are many different ways to calculate Cohen‚Äôs <em>d</em> <span class="citation">(<a href="#ref-lakens2013" role="doc-biblioref">Lakens, 2013</a>)</span>, but all approaches are usually some variant of the following formula:</p>
<p><span class="math display">\[d = \frac{\theta_1 - \theta_2}{\sigma_{pooled}}\]</span></p>
<p>where the difference between means (<span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span>) is divided by the pooled standard deviation <span class="math inline">\(\sigma_{pooled}\)</span>.<label for="tufte-sn-63" class="margin-toggle sidenote-number">63</label><input type="checkbox" id="tufte-sn-63" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">63</span> We‚Äôre dropping the hats here because we‚Äôre now working with a whole bunch of estimates, so everything would have a hat!</span> Intuitively, what you‚Äôre doing is taking the study effect (<span class="math inline">\(\Delta\)</span>) and dividing it ‚Äì scaling it ‚Äì by the variation we saw between individuals in the study.</p>
<p>Let‚Äôs compute this measure for our tea-drinking study. We can just plug in the estimates we made earlier in the chapter and compute the standard deviation of our observed data:</p>
<p><span class="math display">\[{d} = \frac{\theta_1 - \theta_2}{\sigma_{pooled}} = \frac{4.5- 3.5}{1.25} = \frac{1}{1.25} = 0.80\]</span>
In other words, the effect size of the difference between the two conditions is .8 standard deviations.</p>
<p>We previously said that people who drank milk-first tea had quality ratings that were, on average, 1 point higher on a 7-point scale (<span class="math inline">\(\widehat{\Delta} = 1\)</span>). Cohen‚Äôs <em>d</em> translates the arbitrary units of our rating scale into a <strong>unit-less</strong> effect size that is measured in terms of the variation in the data. You may find yourself wondering: ‚Äúwhy would I ever describe things in terms of standard deviations?‚Äù The key benefit is that it allows us to compare the size of the effect to studies that use different measures.</p>
<p>Let‚Äôs say that we ran a replication of our tea study with two changes: (1) we studied patrons in a US cafe instead of a UK cafe, and (2) we used a 100-point quality rating scale instead of a 7-point scale. Imagine that, just as we found that participants in the UK rated the milk-first tea 1-point higher on a 7-point quality scale, US participants rated the milk-first tea 1-point higher on a <em>100-point</em> quality scale. It seems clear that these effects are different because of the difference in scale. But how different?</p>
<p>It might at first seem reasonable just to normalize by the length of the scale. So maybe the UK experimental participants showed a 1/7 rating effect and the US participants showed a 1/100 rating effect. The trouble with this move is that it presupposes that participants from two different populations are using two different scales in exactly the same way! For example, maybe US participants made very clumpy judgments that were mostly centered around 50 (perhaps because of a lack of milk tea experience). Standardized effect sizes get around this kind of issue by scaling according to the variability of the data.</p>
<p>Let‚Äôs compute the effect size for the cross-cultural replication. We‚Äôll imagine that participants who drank milk-first tea gave an average rating of 50/100 and participants who drank tea-first tea rated it 49 on average. But if their variability was also relatively lower, perhaps the standard deviation of their ratings was only 5. Using the formula above, we find</p>
<p><span class="math display">\[{d_{US}} = \frac{\theta_1 - \theta_2}{\sigma_{pooled}} = \frac{50 - 49}{5} = \frac{1}{5}=  0.2\]</span></p>
<p>A Cohen‚Äôs <em>d</em> of .2 means that US cafe patrons rated their tea .2 standard deviations higher when it was milk-first, much smaller than the .8 standard deviation difference in the UK patrons.</p>
<p>There are no hard and fast rules for interpreting what makes a big effect or a small effect, but people often refer back to standard suggested by <span class="citation"><a href="#ref-cohen1992" role="doc-biblioref">Cohen</a> (<a href="#ref-cohen1992" role="doc-biblioref">1992</a>)</span>. On those standards, <span class="math inline">\(d = 0.8\)</span> is a ‚Äúlarge effect,‚Äù and <span class="math inline">\(d = 0.2\)</span> is a ‚Äúsmall effect.‚Äù But these effect size interpretation norms are somewhat arbitrary. More broadly, though US and UK patrons had the same raw score change in quality ratings (<span class="math inline">\(\widehat{\Delta} = 1\)</span>), standardizing the differences allowed us to communicate that the difference was much larger among the UK patrons.</p>
<p>Cohen‚Äôs <em>d</em> is one of many standardized effect sizes that researchers can use. Just as Cohen‚Äôs <em>d</em> standardizes differences in group means, there are also ways of standardizing relationships between categorical variables (e.g., odds ratio), how well a predictor variable explains an outcome variable (e.g., Pearson‚Äôs <em>r</em>, <span class="math inline">\(r^2\)</span>, or <span class="math inline">\(\eta^2\)</span>), and more. We‚Äôll be using effect sizes throughout the book, but in most cases ‚Äì for example, sample size planning in Chapter <a href="10-sampling.html#sampling">10</a> and meta-analysis in Chapter <a href="18-meta.html#meta">18</a> ‚Äì we‚Äôll be using Cohen‚Äôs <em>d</em> as our example.<label for="tufte-sn-64" class="margin-toggle sidenote-number">64</label><input type="checkbox" id="tufte-sn-64" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">64</span> If you‚Äôd like to learn more about other varieties of effect size, take a look at <span class="citation"><a href="#ref-fritz2012" role="doc-biblioref">Fritz et al.</a> (<a href="#ref-fritz2012" role="doc-biblioref">2012</a>)</span>.</span></p>
</div>
<div id="pros-and-cons-of-standardizing-effect-sizes" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Pros and cons of standardizing effect sizes</h3>
<p>By now, you‚Äôre probably realizing that there are some pros and cons of standardizing effect sizes. Sure, it helps communicate that a 1-point change on a 7-point scale is not the same as a 1-point change on a 100-point scale. But is it any better to say that the first change represents a 0.80 standard deviation difference and the second a 0.08 standard deviation difference?</p>
<p>Proponents of effect size standardization argue that effect sizes allow us to compare results across studies more easily. Across studies, researchers use different measures, different study designs, and different populations. Standardization allows us to use a common language to describe estimated relationships in these varied contexts. This is helpful when we want to aggregate and compare effects across studies via meta-analysis. And it is also helpful when planning new studies. When trying to figure out how many participants to run in a study, almost all techniques use standardized effect sizes to determine how much data would be needed to reliably detect an effect.</p>
<p>Standardizing effect sizes, though, has limitations. For example, if two interventions produce the same absolute change in the same outcome measure, but are studied in different populations in which the variability on the outcome differs substantially, the interventions would produce different standardized mean differences.</p>
<p>For example, imagine we conducted our tea experiment again, but this time with (decaf) tea, and focusing on children. Maybe milk-first tea tastes the same amount better than tea-first tea for kids and for adults. But it‚Äôs pretty well known that kids are more variable in their responding. This higher level of variability would lead us to observe a smaller effect size in kids vs.¬†adults. Recall that our UK adult SD was 1.25, and our effect size was <span class="math inline">\(d = .8\)</span>. Imagine that children‚Äôs SD is 2.5. In this scenario, even if tea led to the same 1-point absolute change in feelings of excitement among adults and children, the standardized effect size for kids would look half as big:</p>
<p><span class="math display">\[{d_{kids}} = \frac{\theta_1 - \theta_2}{\sigma_{pooled}} = \frac{5- 4}{2.5} = \frac{1}{2.5} =  .4\]</span></p>
<p>This example highlights some of the challenges with standardization. If we focused on the fact that both adults and children experienced a 1-point change in excitement levels (<span class="math inline">\(\widehat{\Delta} = 1\)</span>), we would conclude that milk-first tea is equally tasty for adults and kids If we focused on the standardized effect sizes, however, we would conclude that the effect of tea is twice as big for adults.</p>
<p>So which is better: describing raw measures or standardized effect sizes? In general our response is ‚ÄúWhy not both?‚Äù But if you wanted to pick one or the other, we recommend focusing on raw scores when working with measures that yield measurements that are likely to be comparable across studies already. If your study uses standard units such as milliseconds (e.g., for reaction times) or counts (e.g., for a study tracking an outcome like utterances), these measurements are already comparable across studies. Reporting raw measurements can allow you to check whether your measurements make sense ‚Äì for example, a reaction time of 70 milliseconds is inhumanly fast, while a reaction time of 10 seconds might be extremely slow (at least, for many speeded tasks).</p>
<p>In contrast, we recommend using standardized effect sizes for cases where the measurement is relatively unlikely to be comparable with other studies in its original form, or unlikely to be meaningful on its own. For example, reporting the effect of an intervention on raw math test scores is only meaningful if the reader knows how many items are on the test, how difficult it is, and so forth. In such a case where there it is hard to be ‚Äúcalibrated‚Äù to the measurement, standardization with respect to variability via effect sizes may be the best we can do.</p>
</div>
</div>
<div id="summary-estimation" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Summary: Estimation</h2>
<p>In this chapter, we introduced the idea of estimating both individual measurements and treatment effects from observed data. These ideas are simple but they lay the foundations for drawing inferences, where we move from estimates within a particular sample to inferences about the population. Further, we set up the distinction between Bayesian and frequentist approaches, which we will expand in the next chapter since these traditions provide different inferential tools.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-brockwell2001comparison" class="csl-entry">
Brockwell, S. E., &amp; Gordon, I. R. (2001). A comparison of statistical methods for meta-analysis. <em>Statistics in Medicine</em>, <em>20</em>(6), 825‚Äì840.
</div>
<div id="ref-cohen1992" class="csl-entry">
Cohen, J. (1992). A power primer. <em>Psychological Bulletin</em>, <em>112</em>(1), 155.
</div>
<div id="ref-dersimonian1986meta" class="csl-entry">
DerSimonian, R., &amp; Laird, N. (1986). Meta-analysis in clinical trials. <em>Controlled Clinical Trials</em>, <em>7</em>(3), 177‚Äì188.
</div>
<div id="ref-fritz2012" class="csl-entry">
Fritz, C. O., Morris, P. E., &amp; Richler, J. J. (2012). Effect size estimates: Current use, calculations, and interpretation. <em>Journal of Experimental Psychology: General</em>, <em>141</em>(1), 2.
</div>
<div id="ref-kennedy2003" class="csl-entry">
Kennedy, M. (2003). How to make a perfect cuppa: Put milk in first. <em>How to Make a Perfect Cuppa: Put Milk in First</em>. <a href="https://www.theguardian.com/uk/2003/jun/25/science.highereducation">https://www.theguardian.com/uk/2003/jun/25/science.highereducation</a>
</div>
<div id="ref-knapp2003improved" class="csl-entry">
Knapp, G., &amp; Hartung, J. (2003). Improved tests for a random effects meta-regression with a single covariate. <em>Statistics in Medicine</em>, <em>22</em>(17), 2693‚Äì2710.
</div>
<div id="ref-lakens2013" class="csl-entry">
Lakens, D. (2013). Calculating and reporting effect sizes to facilitate cumulative science: A practical primer for t-tests and ANOVAs. <em>Frontiers in Psychology</em>, <em>4</em>, 863.
</div>
</div>
<p style="text-align: center;">
<a href="4-ethics.html"><button class="btn btn-default">Previous</button></a>
<a href="6-inference.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>

<script src="toc/toc.js"></script>


</body>
</html>
