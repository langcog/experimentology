<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>15&nbsp; Visualization – Experimentology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./016-meta.html" rel="next">
<link href="./014-writing.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-659MTW4XZ4"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-659MTW4XZ4', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./014-writing.html">Reporting</a></li><li class="breadcrumb-item"><a href="./015-viz.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Visualization</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Experimentology</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/langcog/experimentology" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Experimentology.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./001-experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Experiments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./002-theories.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Theories</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./003-replication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Replication</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./004-ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ethics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./005-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./006-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./007-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Planning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./008-measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Measurement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./009-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./010-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Sampling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Execution</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./011-prereg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Preregistration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./012-collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data collection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./013-management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Project management</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Reporting</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./014-writing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./015-viz.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./016-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Meta-analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./017-conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./100-instructors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Instructor’s guide</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./101-github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Git and GitHub</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./102-rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">R Markdown and Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./103-tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Tidyverse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./104-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">ggplot</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p>© 2024. This work is openly licensed via <a href="https://creativecommons.org/licenses/by-nc/4.0">CC BY NC 4.0</a>.</p>
</div></div></nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#basic-principles-of-confirmatory-visualization" id="toc-basic-principles-of-confirmatory-visualization" class="nav-link active" data-scroll-target="#basic-principles-of-confirmatory-visualization"><span class="header-section-number">15.1</span> Basic principles of (confirmatory) visualization</a>
  <ul class="collapse">
  <li><a href="#principle-1-show-the-design" id="toc-principle-1-show-the-design" class="nav-link" data-scroll-target="#principle-1-show-the-design"><span class="header-section-number">15.1.1</span> Principle 1: Show the design</a></li>
  <li><a href="#principle-2-facilitate-comparison" id="toc-principle-2-facilitate-comparison" class="nav-link" data-scroll-target="#principle-2-facilitate-comparison"><span class="header-section-number">15.1.2</span> Principle 2: Facilitate comparison</a></li>
  <li><a href="#principle-3-show-the-data" id="toc-principle-3-show-the-data" class="nav-link" data-scroll-target="#principle-3-show-the-data"><span class="header-section-number">15.1.3</span> Principle 3: Show the data</a></li>
  <li><a href="#principle-4-maximize-information-minimize-ink" id="toc-principle-4-maximize-information-minimize-ink" class="nav-link" data-scroll-target="#principle-4-maximize-information-minimize-ink"><span class="header-section-number">15.1.4</span> Principle 4: Maximize information, minimize ink</a></li>
  </ul></li>
  <li><a href="#exploratory-visualization" id="toc-exploratory-visualization" class="nav-link" data-scroll-target="#exploratory-visualization"><span class="header-section-number">15.2</span> Exploratory visualization</a>
  <ul class="collapse">
  <li><a href="#examining-distributional-information" id="toc-examining-distributional-information" class="nav-link" data-scroll-target="#examining-distributional-information"><span class="header-section-number">15.2.1</span> Examining distributional information</a></li>
  <li><a href="#data-diagnostics" id="toc-data-diagnostics" class="nav-link" data-scroll-target="#data-diagnostics"><span class="header-section-number">15.2.2</span> Data diagnostics</a></li>
  <li><a href="#plot-data-collection-details" id="toc-plot-data-collection-details" class="nav-link" data-scroll-target="#plot-data-collection-details"><span class="header-section-number">15.2.3</span> Plot data collection details</a></li>
  <li><a href="#explorating-distributions" id="toc-explorating-distributions" class="nav-link" data-scroll-target="#explorating-distributions"><span class="header-section-number">15.2.4</span> Explorating distributions</a></li>
  <li><a href="#hypothesis-driven-exploration" id="toc-hypothesis-driven-exploration" class="nav-link" data-scroll-target="#hypothesis-driven-exploration"><span class="header-section-number">15.2.5</span> Hypothesis-driven exploration</a></li>
  <li><a href="#visualization-as-debugging" id="toc-visualization-as-debugging" class="nav-link" data-scroll-target="#visualization-as-debugging"><span class="header-section-number">15.2.6</span> Visualization as debugging</a></li>
  </ul></li>
  <li><a href="#chapter-summary-visualization" id="toc-chapter-summary-visualization" class="nav-link" data-scroll-target="#chapter-summary-visualization"><span class="header-section-number">15.3</span> Chapter summary: Visualization</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography"></a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/langcog/experimentology/blob/main/015-viz.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/langcog/experimentology/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./014-writing.html">Reporting</a></li><li class="breadcrumb-item"><a href="./015-viz.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Visualization</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-viz" class="quarto-section-identifier"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Visualization</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled" title="learning goals">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
learning goals
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li>Analyze the principles behind informative visualizations</li>
<li>Incorporate visualization into an analysis workflow</li>
<li>Learn to make “the design plot”: a standard visualization of experimental data</li>
<li>Select different visualizations of variability and distribution</li>
<li>Connect visualization concepts to measurement principles</li>
</ul>
</div>
</div>
</div>
<p>What makes visualizations so useful, and what role do they play in the experimenter’s toolkit? Simply put, data visualization is the act of “making the invisible visible.” Our visual systems are remarkably powerful pattern detectors, and relationships that aren’t at all clear when scanning through rows of raw data can immediately jump out at us when presented in an appropriate graphical form <span class="citation" data-cites="zacks2020designing">(<a href="#ref-zacks2020designing" role="doc-biblioref">Zacks and Franconeri 2020</a>)</span>. Good visualizations aim to deliberately harness this power and put it to work at every stage of the research process, from the quick sanity checks we run when first reading in our data to the publication-quality figures we design when we are ready to communicate our findings.</p>
<p>Yet, our powerful pattern detectors can also be a liability; if we’re not careful, we can easily be fooled into seeing patterns that are unreliable or even misleading. As psychology moves into an era of bigger data and more complex behaviors, we become increasingly reliant on <strong>data visualization literacy</strong> <span class="citation" data-cites="borner2019data">(<a href="#ref-borner2019data" role="doc-biblioref">Börner, Bueckle, and Ginda 2019</a>)</span> to make sense of what is going on. Further, as a researcher reporting about your data, creating appropriate visualizations that are aligned with your analyses (as well as your design and preregistration) is an important part of <span class="smallcaps">transparency</span> and <span class="smallcaps">bias reduction</span> in your reporting.</p>
<div class="callout callout-style-default callout-note callout-titled" title="case study">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
case study
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<section id="mapping-a-pandemic" class="level3 unnumbered callout-body-container callout-body">
<h3 class="unnumbered anchored" data-anchor-id="mapping-a-pandemic">Mapping a pandemic</h3>
<p>In 1854, a deadly outbreak of cholera was sweeping through London. The scientific consensus at the time was that diseases like cholera spread through breathing poisonous and foul-smelling vapors, an idea known as the “miasma theory” <span class="citation" data-cites="halliday2001death">(<a href="#ref-halliday2001death" role="doc-biblioref">Halliday 2001</a>)</span>. An obstetrician and anesthesiologist named John Snow proposed an alternative theory:</p>
<p>rather than spreading through foul air, he thought that cholera was spreading through a polluted water supply <span class="citation" data-cites="snow1855mode">(<a href="#ref-snow1855mode" role="doc-biblioref">Snow 1855</a>)</span>. To make a public case for this idea, he started counting cholera deaths. He marked each case on a map of the area and indicated the locations of the water pumps for reference. Furthermore, a line could be drawn representing the region that was closest to each water pump, a technique that is now known as a Voronoi diagram. The resulting illustration clearly reveals that cases clustered around an area called Golden Square, which received water from a pump on Broad Street (<a href="#fig-viz-cholera" class="quarto-xref">figure&nbsp;<span>15.1</span></a>). Although the precise causal role of these maps in Snow’s own thinking is disputed, and it is likely that he produced them well after the incident <span class="citation" data-cites="brody2000map">(<a href="#ref-brody2000map" role="doc-biblioref">Brody et al. 2000</a>)</span>, they nonetheless played a significant role in the history of data visualization <span class="citation" data-cites="friendly2021history">(<a href="#ref-friendly2021history" role="doc-biblioref">Friendly and Wainer 2021</a>)</span>.</p>
<div id="fig-viz-cholera" class="quarto-float quarto-figure quarto-figure-center anchored" alt="An old map of Broad Street, with bars for number of cases at each address and dotted line around the area of most bars.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-viz-cholera-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/viz/snow_cholera_voronoi.png" class="img-fluid figure-img" style="width:45.0%" alt="An old map of Broad Street, with bars for number of cases at each address and dotted line around the area of most bars.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-viz-cholera-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.1: Mapping out a cholera epidemic <span class="citation" data-cites="snow1854report">(<a href="#ref-snow1854report" role="doc-biblioref">Snow 1854</a>)</span>. The dotted line shows the region for which Broad Street pump is nearest.
</figcaption>
</figure>
</div>
<p>Nearly two centuries later, as the COVID-19 pandemic swept through the world, governmental agencies like the Centers for Disease Control and Prevention (CDC) produced maps of the outbreak that became much more familiar (<a href="#fig-viz-covid" class="quarto-xref">figure&nbsp;<span>15.2</span></a>).</p>
<div id="fig-viz-covid" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A map of the US with each state's color indicating number of COVID deaths. TX, FL, CA, NY have darkest colors.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-viz-covid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/viz/cdc-covid-map.png" class="img-fluid figure-img" style="width:70.0%" alt="A map of the US with each state's color indicating number of COVID deaths. TX, FL, CA, NY have darkest colors.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-viz-covid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.2: A map showing the counts of COVID deaths by state since March 2020 as of Novermber 2024 (from the CDC COVID Data Tracker, <a href="https://covid.cdc.gov/covid-data-tracker" class="uri">https://covid.cdc.gov/covid-data-tracker</a>). <em>Usage does not constitute endorsement or recommendation by the US Government, Department of Health and Human Services, or Centers for Disease Control and Prevention.</em>
</figcaption>
</figure>
</div>
<p>These maps make abstract statistics visible: By assigning higher cumulative deaths rates to darker colors, we can see at a glance which areas have been most affected. And we’re not limited by the spatial layout of a map. We’re now also used to seeing the horizontal axis correspond to <em>time</em> and the vertical axis correspond to some value at that time. Curves like the following, showing the weekly counts of new deaths, allow us to see other patterns, like the <em>rate of change</em>. Even though more and more cases accumulate every day, we can see at a glance the different “waves” of cases and when they peaked (<a href="#fig-viz-cases" class="quarto-xref">figure&nbsp;<span>15.3</span></a>).</p>
<div id="fig-viz-cases" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A plot of weekly COVID new deaths over time (8/2020 to 11/2024), with several waves where hospitalizations peak.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-viz-cases-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/viz/cdc-covid-trend.png" class="img-fluid figure-img" style="width:65.0%" alt="A plot of weekly COVID new deaths over time (8/2020 to 11/2024), with several waves where hospitalizations peak.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-viz-cases-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.3: Weekly counts of new reported COVID deaths in the US between March 2020 and November 2024 (from the CDC COVID Data Tracker, <a href="https://covid.cdc.gov/covid-data-tracker" class="uri">https://covid.cdc.gov/covid-data-tracker</a>). <em>Usage does not constitute endorsement or recommendation by the US Government, Department of Health and Human Services, or Centers for Disease Control and Prevention.</em>
</figcaption>
</figure>
</div>
<p>While these visualizations capture purely descriptive statistics, we often want our visualizations to answer more specific questions. For example, we may ask about the effectiveness of vaccinations: How do case rates differ across vaccinated and unvaccinated populations? In this case, we may talk about “breaking out” a curve by some other variable, like vaccination status (<a href="#fig-viz-cases2" class="quarto-xref">figure&nbsp;<span>15.4</span></a>).</p>
<div id="fig-viz-cases2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A plot of COVID cases over time: curve for vaccinated individuals stays low; for unvaccinated higher, rises rapidly 8/2021.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-viz-cases2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/viz/vaccination.png" class="img-fluid figure-img" style="width:55.0%" alt="A plot of COVID cases over time: curve for vaccinated individuals stays low; for unvaccinated higher, rises rapidly 8/2021.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-viz-cases2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.4: Rates of COVID cases by vaccination status (from the CDC COVID Data Tracker, <a href="https://covid.cdc.gov/covid-data-tracker" class="uri">https://covid.cdc.gov/covid-data-tracker</a>). <em>Usage does not constitute endorsement or recommendation by the US Government, Department of Health and Human Services, or Centers for Disease Control and Prevention.</em>
</figcaption>
</figure>
</div>
<p>From this visualization, we can see that unvaccinated individuals are about six times more likely to test positive. At the same time, these visualizations were produced using <em>observational</em> data, which makes it challenging to draw causal inferences. For example, people were not randomly assigned to vaccination conditions, and those who have avoided vaccinations may differ in other ways than those who sought out vaccinations. Additionally, you may have noticed that these visualizations typically do not give a sense of the raw data, the sample sizes of each group, or uncertainty about the estimates. In this chapter, we will explore how to use visualizations to communicate the results of carefully controlled psychology experiments, which license stronger causal inferences.</p>
</section>
</div>
</div>
<section id="basic-principles-of-confirmatory-visualization" class="level2 page-columns page-full" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="basic-principles-of-confirmatory-visualization"><span class="header-section-number">15.1</span> Basic principles of (confirmatory) visualization</h2>
<p>In this section, we begin by introducing a few simple guidelines to keep in mind when making informative visualizations in the context of experimental psychology.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Remember that our needs may be distinct from other fields, such as journalism or public policy. You may have seen beautiful and engaging full-page graphics with small print and a wealth of information. The art of designing and producing these graphics is typically known as <strong>infoviz</strong> and should be distinguished from what we call <strong>statistical visualization</strong> <span class="citation" data-cites="gelman2013">(<a href="#ref-gelman2013" role="doc-biblioref">Gelman and Unwin 2013</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;For the purposes of understanding the examples in this chapter, it should be sufficient to work through the tutorials on data manipulation and visualization in <a href="103-tidyverse.html" class="quarto-xref"><span>appendix D</span></a> and <a href="104-ggplot.html" class="quarto-xref"><span>appendix E</span></a>.</p></div></div><p>Roughly, infoviz aims to construct rich and immersive worlds to visually explore: a reader can spend hours pouring over the most intricate graphics and continue to find new and intriguing patterns. Statistical visualization, on the other hand, aims to crisply convey the logic of a specific inference at a glance. These visualizations are the production-ready figures that anchor the results section of a paper and accompany the key, preregistered analyses of interest. In this section, we review several basic principles of making statistical visualizations. We then return below to the role of visualization in more exploratory analyses.</p>
<section id="principle-1-show-the-design" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="principle-1-show-the-design"><span class="header-section-number">15.1.1</span> Principle 1: Show the design</h3>
<p>There are so many different kinds of graphs (bar graphs, line graphs, scatter plots, and pie charts) and so many different possible attributes of those graphs (colors, sizes, line types). How do we begin to decide how to navigate these decisions? The first principle guiding good statistical visualizations is to <em>show the design</em> of your experiment.</p>
<p>The first confirmatory plot you should have in mind for your experiment is the <strong>design plot</strong>. Analogous to the “default” or “saturated” model in <a href="007-models.html" class="quarto-xref"><span>chapter 7</span></a>, the design plot should show the key dependent variable of the experiment, broken down by all of the key manipulations. Critically, design plots should neither omit particular manipulations because they didn’t yield an effect or include extra covariates because they seemed interesting after looking at the data. Both of these steps are the visual analogue of <span class="math inline">\(p\)</span>-hacking! Instead, the design plot is the “preregistered analysis” of your visualization: it illustrates a first look at the estimated causal effects from your experimental manipulations. In the words of <span class="citation" data-cites="coppock2019">Coppock (<a href="#ref-coppock2019" role="doc-biblioref">2019</a>)</span>, “Visualize as You Randomize”!</p>
<p>It can sometimes be a challenge to represent the full pattern of manipulations from an experiment in a single plot. Below we give some tricks for maximizing the legible information in your plot. But if you have tried these and the design plot still looks crowded and messy, that could indicate that your experiment is manipulating too many things at once!</p>
<p>There are strong (unwritten) conventions about how your confirmatory analysis is expected to map onto graphical elements, and following these conventions can minimize confusion. Start with the variables you manipulate, and make sure they are clearly visible. Conventionally, the primary manipulation of interest (e.g., condition) goes on the x-axis, and the primary measurement of interest (e.g., responses) goes on the y-axis. Other critical variables of interest (e.g., secondary manipulations and demographics) are then assigned to other “visual variables” (e.g., color, shape, or size).</p>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The visualization library <code>ggplot</code> (see <a href="104-ggplot.html" class="quarto-xref"><span>appendix E</span></a>) makes the mapping of variables in the data to visual data. Part of a ggplot call is an <code>aes()</code> (short for aesthetics) mapping:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> ...,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> ...,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> ...,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">linetype =</span> ...,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The aesthetics argument serves as a statement of how data are mapped to “marks” on the plot. This transparent mapping makes it very easy to explore different plot types by changing that <code>aes()</code> statement, as we’ll see below.</p>
</div>
</div>
</div>
<p>As an example, we will consider the data from <span class="citation" data-cites="stiller2015">Stiller, Goodman, and Frank (<a href="#ref-stiller2015" role="doc-biblioref">2015</a>)</span> that we explored back in <a href="007-models.html" class="quarto-xref"><span>chapter 7</span></a>. Because this experiment was a developmental study, the primary independent variable of interest was the age group of participants (ages two, three, or four). So age gets assigned to the horizontal (x) axis. The dependent variable is accuracy: the proportion of trials that a participant made the correct response (out of four trials). So accuracy goes on the vertical (y) axis. Now, we have two other variables that we might want to show: the condition (experimental vs control) and the type of stimuli (houses, beds, and plates of pasta). When we think about it, though, only condition is central to exposing the design. While we might be interested in whether some types of stimuli are systematically easier or harder than others, condition is more central for understanding the <em>logic</em> of the study.</p>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As a reminder, here’s our code for loading the <span class="citation" data-cites="stiller2015">Stiller, Goodman, and Frank (<a href="#ref-stiller2015" role="doc-biblioref">2015</a>)</span> data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>repo <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/langcog/experimentology/main"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>sgf <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(repo, <span class="st">"data/tidyverse/stiller_scales_data.csv"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">cut</span>(age, <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">include.lowest =</span> <span class="cn">TRUE</span>), </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">condition =</span> condition <span class="sc">|&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">fct_recode</span>(<span class="st">"Experimental"</span> <span class="ot">=</span> <span class="st">"Label"</span>, <span class="st">"Control"</span> <span class="ot">=</span> <span class="st">"No Label"</span>))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>sgf_cond_means <span class="ot">&lt;-</span> sgf <span class="sc">|&gt;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition, age_group) <span class="sc">|&gt;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">rating =</span> <span class="fu">mean</span>(correct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="principle-2-facilitate-comparison" class="level3 page-columns page-full" data-number="15.1.2">
<h3 data-number="15.1.2" class="anchored" data-anchor-id="principle-2-facilitate-comparison"><span class="header-section-number">15.1.2</span> Principle 2: Facilitate comparison</h3>

<div class="no-row-height column-margin column-container"><div id="fig-viz-hierarchy" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A diagram of visual features listed from more to less accurate: position, length, angle/slope, area, volume, color/density.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-viz-hierarchy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/viz/viz_hierarchy.png" class="img-fluid figure-img" alt="A diagram of visual features listed from more to less accurate: position, length, angle/slope, area, volume, color/density.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-viz-hierarchy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.5: Principles of visual perception can guide visualization choices. Based on <span class="citation" data-cites="mackinlay1986 cleveland1984">Mackinlay (<a href="#ref-mackinlay1986" role="doc-biblioref">1986</a>; <a href="#ref-cleveland1984" role="doc-biblioref">Cleveland and McGill 1984</a>)</span>.
</figcaption>
</figure>
</div></div><p>Now that you’ve mapped elements of your design to the figure’s axes, how do you decide which graphical elements to display? You might think: well, in principle, these assignments are all arbitrary anyway. As long as we clearly label our choices, it shouldn’t matter whether we use lines, points, bars, colors, textures, or shapes. It’s true that there are many ways to show the same data. But being thoughtful about our choices can make it much easier for readers to interpret our findings. The second principle of statistical visualizations is to <em>facilitate comparison</em> along the dimensions relevant to our scientific questions. It is easier for our visual system to accurately compare the location of elements (e.g., noticing that one point is a certain distance away from another) than to compare their areas or colors (e.g., noticing that one point is bigger or brighter than another). <a href="#fig-viz-hierarchy" class="quarto-xref">Figure&nbsp;<span>15.5</span></a> shows an ordering of visual variables based on how accurate our visual system is in making comparisons.</p>
<p>For example, we <em>could</em> start by plotting the accuracy of each age group as colors (<a href="#fig-viz-prepost2" class="quarto-xref">figure&nbsp;<span>15.6</span></a>).</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-prepost2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A plot of condition (experimental/control) against age group (2-3, 3-4, 4-5); color of each cell corresponds to accuracy.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-prepost2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-prepost2-1.png" class="img-fluid figure-img" style="width:65.0%" alt="A plot of condition (experimental/control) against age group (2-3, 3-4, 4-5); color of each cell corresponds to accuracy.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-prepost2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.6: A first visualization of the <span class="citation" data-cites="stiller2015">Stiller, Goodman, and Frank (<a href="#ref-stiller2015" role="doc-biblioref">2015</a>)</span> data.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To make this (bad) visualization, we used a <code>ggplot</code> function called <code>geom_tile()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sgf_cond_means, <span class="fu">aes</span>(<span class="at">x =</span> age_group, <span class="at">y =</span> condition, <span class="at">fill =</span> rating)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age group"</span>, <span class="at">y =</span> <span class="st">"Condition"</span>, <span class="at">fill =</span> <span class="st">"Rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>geom_tile()</code> is commonly used to make heat maps (<a href="https://en.wikipedia.org/wiki/Heat_map" class="uri">https://en.wikipedia.org/wiki/Heat_map</a>): for each value of some pair of variables (x, y), it shows a color representing the magnitude of a third variable (z). While a heat map is a silly way to visualize the <span class="citation" data-cites="stiller2015">Stiller, Goodman, and Frank (<a href="#ref-stiller2015" role="doc-biblioref">2015</a>)</span> data, consider using <code>geom_tile()</code> when you have a pair of continuous variables, each taking a large range of values. In these cases, bar plots and line plots tend to get extremely cluttered, making it hard to see the relationship between the variables. Heat maps help these relationships to pop out as clear “hot” and “cold” regions. For example, in <span class="citation" data-cites="barnett2022">Barnett, Griffiths, and Hawkins (<a href="#ref-barnett2022" role="doc-biblioref">2022</a>)</span>, a heatmap was used to show a specific range of parameters where an effect of interest emerged (see <a href="#fig-viz-heatmap" class="quarto-xref">figure&nbsp;<span>15.7</span></a>).</p>
<div id="fig-viz-heatmap" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A heatmap of stick length against agent bias; there is a bright spot in the bottom right-hand corner.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-viz-heatmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/viz/viz_heatmap_example.png" class="img-fluid figure-img" style="width:35.0%" alt="A heatmap of stick length against agent bias; there is a bright spot in the bottom right-hand corner.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-viz-heatmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.7: A heatmap showing a specific range of continuous parameters where an effect emerged. <span class="citation" data-cites="barnett2022">Barnett, Griffiths, and Hawkins (<a href="#ref-barnett2022" role="doc-biblioref">2022</a>)</span>, Figure 3 (licensed under CC BY 4.0).
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Or we could plot the accuracies as sizes/areas (<a href="#fig-viz-prepost3" class="quarto-xref">figure&nbsp;<span>15.8</span></a>).</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-prepost3" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A plot the same as 15.6 but instead of 6 colored cells there are 6 dots of various sizes; it's difficult to compare values.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-prepost3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-prepost3-1.png" class="img-fluid figure-img" style="width:65.0%" alt="A plot the same as 15.6 but instead of 6 colored cells there are 6 dots of various sizes; it's difficult to compare values.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-prepost3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.8: Iterating on the Stiller data using size.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To make this (bad) visualization, we mapped the rating to the <code>size</code> aesthetic in our <code>aes()</code> call.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sgf_cond_means, <span class="fu">aes</span>(<span class="at">x =</span> age_group, <span class="at">y =</span> condition, <span class="at">size =</span> rating)) <span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age group"</span>, <span class="at">y =</span> <span class="st">"Condition"</span>, <span class="at">size =</span> <span class="st">"Rating"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>These plots allow us to see that one condition is (qualitatively) bigger than others, but it’s hard to tell how much bigger. Additionally, this way of plotting the data places equal emphasis on age and condition, but we may instead have in mind particular contrasts, like the <em>change</em> across ages and how that change differs across conditions. An alternative is to show six bars: three on the left showing the “experimental” phase and three on the right showing the “control” phase. Maybe the age groups then are represented as different colors, as in <a href="#fig-viz-prepost4" class="quarto-xref">figure&nbsp;<span>15.9</span></a>.</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-prepost4" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A plot of Mean accuracy against Condition; Age groups represented by bars of different colors.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-prepost4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-prepost4-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A plot of Mean accuracy against Condition; Age groups represented by bars of different colors.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-prepost4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.9: A bar graph of the Stiller data.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We make bar plots using the <code>ggplot</code> function <code>geom_col()</code>. By default, it creates “stacked” bar plots, where all values associated with the same x value (here, <code>condition</code>) get stacked up on top of one another. Stacked bar plots can be useful if, for example, you’re plotting proportions that sum up to 1, or want to show how some big count is broken down into subcategories. It’s also common to use <code>geom_area()</code> for this purpose, which connects adjacent regions. But the more common bar plot used in psychology puts the bars next to one another, or “dodges” them. To accomplish this, we use the <code>position = "dodge"</code> argument:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sgf_cond_means, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> rating, <span class="at">fill =</span> age_group)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> <span class="st">"Mean accuracy"</span>, <span class="at">fill =</span> <span class="st">"Age group"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>This plot is slightly better: it’s easier to compare the heights of bars than the “blueness” of squares, and mapping age to color draws our eye to those contrasts. However, we can do even better by noticing that our experiment was designed to test an <em>interaction</em>. That statistic of interest is a difference of differences. To what extent does the developmental change in performance on the experimental condition differ from developmental change in performance on the control condition? Some researchers have gotten proficient at reading off interactions from bar plots, but they also require a complex set of eye movements. We have to look at the pattern across the bars on the left, and then jump over to the bars on the right, and implicitly judge one difference against the other: the actual statistic isn’t explicitly shown anywhere! What could help facilitate this comparison? Consider the line plot in <a href="#fig-viz-prepost5" class="quarto-xref">figure&nbsp;<span>15.10</span></a>.</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-prepost5" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A plot of Mean Accuracy against Age group; there are two lines, corresponding to the two conditions.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-prepost5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-prepost5-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A plot of Mean Accuracy against Age group; there are two lines, corresponding to the two conditions.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-prepost5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.10: A line graph of the Stiller data promotes comparison.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Using a combination of <code>geom_point()</code> and <code>geom_line()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sgf_cond_means, <span class="fu">aes</span>(<span class="at">x =</span> age_group, <span class="at">y =</span> rating, <span class="at">color =</span> condition)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> condition)) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age group"</span>, <span class="at">y =</span> <span class="st">"Mean accuracy"</span>, <span class="at">color =</span> <span class="st">"Condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The interaction contrast we want to interpret is highlighted visually in this plot. It is much easier to compare slopes of lines than mentally compute a difference of differences between bars. Here are a few corollaries of this principle (adapted from <a href="https://biostat.wisc.edu/~kbroman/presentations/IowaState2013/graphs_combined.pdf">a presentation by Karl Broman</a>).</p>
<ul>
<li><p>It is easier to compare values that are <em>adjacent</em> to one another. This is especially important when there are many different conditions included on the same plot. If particular sets of conditions are of theoretical interest, place them close to one another. Otherwise, sort conditions by a meaningful value (rather than alphabetically, which is usually the default for plotting software).</p></li>
<li><p>When possible, color-code labels and place them directly next to data rather than in a separate legend. Legends force readers to glance back and forth to remember what different colors or lines mean.</p></li>
<li><p>When making histograms or density plots, it is challenging to compare distributions when they are placed side by side. Instead, facilitate comparison of distributions by vertically aligning them, or making them transparent and placed on the same axes.</p></li>
<li><p>If the scale makes it hard to see important differences, consider transforming the data (e.g., taking the logarithm).</p></li>
<li><p>When making bar plots, be very careful about the vertical y-axis. A classic “misleading visualization” mistake is to cut off the bottom of the bars by placing the endpoint of the y-axis at some arbitrary value near the smallest data point. This is misleading because people interpret bar plots in terms of the relative <em>area</em> of the bars (i.e., the amount of ink taken up by the bar), not just their absolute y-values.</p></li>
<li><p>If a key variable from your design is mapped to color, choose the color scale carefully. For example, if the variable is binary or categorical, choose visually distinct colors to maximize contrast (e.g., black, blue, and orange). If the variable is ordinal or continuous, use a color gradient. If there is a natural midpoint (e.g., if some values are negative and some are positive), consider using a diverging scale (e.g., different colors at each extreme). Remember also that a portion of your audience may be colorblind.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p></li>
</ul>
<!-- Finally, if the same manipulation or variable appears across multiple figures in your paper, keep the color mapping consistent: it is confusing if "red" means something different from figure to figure.  -->
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;Palettes like <code>viridis</code> have been designed to be colorblind-friendly and also perceptually uniform (i.e., the perceived difference between 0.1 and 0.2 is approximately the same as the difference between 0.8 and 0.9).</p></div></div></section>
<section id="principle-3-show-the-data" class="level3 page-columns page-full" data-number="15.1.3">
<h3 data-number="15.1.3" class="anchored" data-anchor-id="principle-3-show-the-data"><span class="header-section-number">15.1.3</span> Principle 3: Show the data</h3>
<p>Looking at older papers, you may be alarmed to notice how little information is contained in the graphs. The worst offenders might show just two bars, representing average values for two conditions. This kind of plot adds very little beyond a sentence in the text reporting the means, but it can also be seriously misleading. It hides real variation in the data, making a noisy effect based on a few data points look the same as a more systematic one based on a larger sample. Additionally, it collapses the <em>distribution</em> of the data, making a multimodal distribution look the same as a unimodal one. The third principle of modern statistical visualization is to <em>show the data</em> and visualize variability in some form.</p>
<p>The most minimal form of this principle is to <em>always include error bars</em>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> Error bars turn a purely descriptive visualization into an inferential one. They represent a minimal form of uncertainty about the possible statistics that might have been observed, not just the one that was actually observed. <a href="#fig-viz-show-data1" class="quarto-xref">Figure&nbsp;<span>15.11</span></a> shows the data with (bootstrapped) error bars. <!-- As such, they allow the viewer to interpret the means as *estimates*.  --></p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;And be sure to tell the reader what the error bars represent—a 95% confidence interval? A standard error of the mean?—without this information, error bars are hard to interpret (see the <span class="smallcaps">Depth</span> box below).</p></div></div><div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-show-data1" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A plot the same as 15.10 but with error bars at each point.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-show-data1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-show-data1-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A plot the same as 15.10 but with error bars at each point.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-show-data1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.11: Error bars (95% CIs) added to the Stiller data line graph.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A common problem arises when we want to add error bars to a dodged bar plot. Naively, we’d expect we could just dodge the error bars in the same way we dodged the bars themselves:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper), <span class="at">position =</span> <span class="st">"dodge"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>But this doesn’t work! The rationale is kind of technical, but the width of the error bars is much narrower than the width of the bars, so we need to manually specify how much to dodge the error bars with <code>position_dodge()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper), </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This does the trick!</p>
</div>
</div>
</div>
<p>But we can do even better. By overlaying the distribution of the actual data points on the same plot, we can give the reader information about not just the statistical inferences but also the underlying data supporting those inferences. In the case of the <span class="citation" data-cites="stiller2015">Stiller, Goodman, and Frank (<a href="#ref-stiller2015" role="doc-biblioref">2015</a>)</span> study, data points for individual trials are binary (correct or incorrect). It’s technically possible to show individual responses as dots at 0s and 1s, but this doesn’t tell us much (we’ll just get a big clump of 0s and a big clump of 1s). The question to ask yourself when “showing the data” is: What are the theoretically meaningful <em>units</em> of variation in the data? This question is closely related to our discussion of mixed-effects models in <a href="007-models.html" class="quarto-xref"><span>chapter 7</span></a>, when we considered which random effects we should include. Here, a reader is likely to wonder how much variance was found across <em>different children</em> in a given age group. To show such variation, we aggregate to calculate an accuracy score for each participant.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;While participant-level variation is a good default, the relevant level of aggregation may differ across designs. For example, collective behavior studies may choose to show the data point for each <em>group</em>. This choice of unit is also important when generating error bars: if you have a small number of participants but many observations per participant, you are faced with a choice. You may either bootstrap over the flat list of all individual observations (yielding very small error bars), or you may first aggregate within participants (yielding larger error bars that account for the fact that repeated observations from the same participant are not independent).</p></div></div><p>There are many ways of showing the resulting distribution of participant-level data. For example, a boxplot shows the median (a horizontal line) in the center of a box extending from the lower quartile (25%) to the upper quartile (75%). Lines then extend out to the biggest and smallest values (excluding outliers, which are shown as dots).</p>
<p><a href="#fig-viz-show-data2" class="quarto-xref">Figure&nbsp;<span>15.12</span></a> gives the boxplots for the Stiller data, which don’t look that informative—perhaps because of the coarseness of individual participant averages due to the small number of trials.</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-show-data2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A plot with same axes as 15.11 but instead of lines there are boxes with whiskers; color of boxes corresponds to condition.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-show-data2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-show-data2-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A plot with same axes as 15.11 but instead of lines there are boxes with whiskers; color of boxes corresponds to condition.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-show-data2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.12: A boxplot of the Stiller data.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In <code>ggplot</code>, we can make box plots using <code>geom_boxplot()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A common problem to run into is that <code>geom_boxplot()</code> requires the variable assigned to <code>x</code> to be discrete. If you have discrete levels of a numeric variable (e.g., age groups), make sure you’ve actually converted that variable to a <code>factor</code>. Otherwise, if it’s still coded as <code>numeric</code>, <code>ggplot</code> will collapse all of the levels together!</p>
</div>
</div>
</div>
<p>It is also common to show the raw data as jittered values with low transparency. In <a href="#fig-viz-show-data4" class="quarto-xref">figure&nbsp;<span>15.13</span></a>, we jitter the points because many participants have the same numbers (e.g., 50%), and if they overlap it is hard to see how many points there are.</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-show-data4" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A plot the same as 15.10 but with clouds of points; points cluster around possible accuracy values for an individual.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-show-data4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-show-data4-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A plot the same as 15.10 but with clouds of points; points cluster around possible accuracy values for an individual.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-show-data4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.13: Jittered points representing the data distribution of the Stiller data.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Adding the jittered points is simple using <code>geom_jitter()</code>, but we are starting to have a fairly complex plot, so maybe it’s worth taking stock of how we get there.</p>
<p>To plot both <em>condition</em> means and <em>participant</em> means, we need to create two different data frames. Here <code>sgf_subj_means</code> is a data frame of means for each participant; <code>sgf_subj_ci</code> is a data frame with means and confidence intervals <em>across</em> participants. For this purpose, we use the <code>tidyboot</code> package <span class="citation" data-cites="braginsky2018">(<a href="#ref-braginsky2018" role="doc-biblioref">Braginsky and Yurovsky 2018</a>)</span> and the <code>tidyboot_mean()</code> function, which gives us bootstrapped 95% confidence intervals for the means.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sgf_subj_means <span class="ot">&lt;-</span> sgf <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition, age_group, subid) <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">rating =</span> <span class="fu">mean</span>(correct)) </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>sgf_subj_ci <span class="ot">&lt;-</span> sgf_subj_means <span class="sc">|&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition, age_group) <span class="sc">|&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  tidyboot<span class="sc">::</span><span class="fu">tidyboot_mean</span>(rating) <span class="sc">|&gt;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">rating =</span> empirical_stat)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sgf_subj_ci, <span class="fu">aes</span>(<span class="at">x =</span> age_group, <span class="at">y =</span> rating, <span class="at">color =</span> condition)) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper)) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> condition)) <span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> sgf_subj_means, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">height =</span> .<span class="dv">03</span>) <span class="sc">+</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age group"</span>, <span class="at">y =</span> <span class="st">"Mean accuracy"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The most noteworthy aspect of this code is that <code>geom_jitter()</code> isn’t just using a different aesthetic; it also takes a different dataframe altogether! Mixing dataframes can be an important tool for creating complex plots.</p>
</div>
</div>
</div>
<p>Perhaps the format that takes this principle the furthest is the so-called raincloud plot <span class="citation" data-cites="allen2019raincloud">(<a href="#ref-allen2019raincloud" role="doc-biblioref">Allen et al. 2019</a>)</span> shown in <a href="#fig-viz-raincloud" class="quarto-xref">figure&nbsp;<span>15.14</span></a>. A raincloud plot combines the raw data (“rain”) with a smoothed density (“cloud”) and a boxplot giving the median and quartiles of the distribution.</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-raincloud" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A plot with axes flipped to show densities as horizontal ridges with small boxplots underneath and clouds of jittered points.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-raincloud-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-raincloud-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A plot with axes flipped to show densities as horizontal ridges with small boxplots underneath and clouds of jittered points.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-raincloud-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.14: A raincloud plot of the Stiller data.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This raincloud plot requires two additional plotting packages: <code>ggridges</code> <span class="citation" data-cites="wilke2023">(<a href="#ref-wilke2023" role="doc-biblioref">Wilke 2023</a>)</span> for the densities and <code>ggstance</code> <span class="citation" data-cites="henry2022">(<a href="#ref-henry2022" role="doc-biblioref">Henry, Wickham, and Chang 2022</a>)</span> for the horizontal boxplots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstance)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sgf_subj_means, <span class="fu">aes</span>(<span class="at">y =</span> age_group, <span class="at">x =</span> rating, <span class="at">color =</span> condition)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="fu">aes</span>(<span class="at">fill =</span> condition), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">scale =</span> <span class="fl">0.7</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">jittered_points =</span> <span class="cn">TRUE</span>, <span class="at">point_alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">position =</span> <span class="fu">position_raincloud</span>(<span class="at">width =</span> <span class="fl">0.05</span>, <span class="at">height =</span> <span class="fl">0.15</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">ygap =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxploth</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>))) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>, <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mean accuracy"</span>, <span class="at">y =</span> <span class="st">"Age group"</span>, <span class="at">color =</span> <span class="st">"Condition"</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="depth">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
depth
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<section id="visualizing-uncertainty-with-error-bars" class="level3 unnumbered callout-body-container callout-body">
<h3 class="unnumbered anchored" data-anchor-id="visualizing-uncertainty-with-error-bars">Visualizing uncertainty with error bars</h3>
<p>One common misconception is that error bars are a measure of variance <em>in the data</em>, like the standard deviation of the response variable. Instead, they typically represent a measure of precision extracted from the statistical model. In older papers, for example, it was common to use the standard error of the mean (SEM; see <a href="006-inference.html" class="quarto-xref"><span>chapter 6</span></a>). Remember that this is not the standard deviation of the data distribution but of the <em>sampling distribution</em> of the mean that is being estimated. Given the central limit theorem, which tells us that this sampling distribution is asymptotically normal, it was straightforward to estimate the standard error analytically using the empirical standard deviation of the data divided by the square root of the sample size: <code>sd(x) / sqrt(length(x))</code>. Error bars based on the SEM often looked misleadingly small, as they only represent a 68% interval of the sampling distribution and go to zero quickly as a function of sample size. As a result, it became more common to show the 95% confidence interval instead: [-1.96 <span class="math inline">\(\times\)</span> SEM, 1.96 <span class="math inline">\(\times\)</span> SEM].</p>
<p>While these analytic equations remain common, an increasingly popular alternative is to <em>bootstrap</em> confidence intervals (see the <span class="smallcaps">Depth</span> box in <a href="006-inference.html" class="quarto-xref"><span>chapter 6</span></a> for more on bootstrapping). <!-- A deep theoretical understanding of the bootstrap technique is outside the scope of this text, but you can think of it as a way of deriving a sampling distribution from your dataset using *simulations* instead of mathematical derivations about the properties of the sampling distribution. --> The bootstrap is a powerfully generic technique, especially when you want to show error bars for summary statistics that are more complex than means, where we do not have such convenient asymptotic guarantees and “closed-form” equations. An example would be if you’re working with a skewed response variable or a dataset with clear outliers and you want to estimate medians and quartiles.</p>
<p>Or, suppose you want to estimate proportions from categorical data, or a more ad hoc statistic like the AUC (area underneath the curve) in a hierarchical design where it is not clear how to aggregate across items or participants in a mixed-effects model. Analytic estimators of confidence intervals can in principle be derived for these statistics, subject to different assumptions, but it is often more transparent and reliable in practice to use the bootstrap. As long as you can write a code snippet to compute a value from a dataset, you can use the bootstrap.</p>
<div id="fig-viz-boot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-viz-boot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<p><img src="015-viz_files/figure-html/fig-viz-boot-1.png" class="img-fluid figure-img" style="width:80.0%" alt="3 plots same as 15.11 but with various error bars: larger for analytic/bootstrapped 95% CI than for standard error."></p>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-viz-boot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.15: Three different error bars for the Stiller data: bootstrapped 95% confidence intervals (left), standard error of the mean (middle), and analytically computed confidence intervals (right).
</figcaption>
</figure>
</div>
<p>As we can see, the bootstrapped 95% CI looks similar to the analytic 95% CI derived from the standard error, except the upper and lower limits are slightly asymmetric (reflecting outliers in one direction or another). Of course, the bootstrap is not a silver bullet and can be abused in particularly small samples. This is because the bootstrap is fundamentally limited to the sample we run it on. It can be expected to be reasonably accurate if the sample is reasonably representative of the population. But at the end of the day, as they say, “There’s no such thing as a free lunch.” In other words, we cannot magically pull more information out of a small sample without making additional assumptions about the data generating process.</p>
</section>
</div>
</div>
</section>
<section id="principle-4-maximize-information-minimize-ink" class="level3 page-columns page-full" data-number="15.1.4">
<h3 data-number="15.1.4" class="anchored" data-anchor-id="principle-4-maximize-information-minimize-ink"><span class="header-section-number">15.1.4</span> Principle 4: Maximize information, minimize ink</h3>

<div class="no-row-height column-margin column-container"><div id="fig-viz-bad" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A plot showing labeled 3D bars over 3 years; they have a Japanese flag pattern and are in front of a American flag backdrop.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-viz-bad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/viz/bad-viz1.png" class="img-fluid figure-img" style="width:90.0%" alt="A plot showing labeled 3D bars over 3 years; they have a Japanese flag pattern and are in front of a American flag backdrop.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-viz-bad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.16: This figure uses a lot to ink to show three numbers, for a “ddi” of 0.2 <span class="citation" data-cites="wainer1984display">(from the <em>Washington Post</em>, 1978, see <a href="#ref-wainer1984display" role="doc-biblioref">Wainer 1984</a>)</span>.
</figcaption>
</figure>
</div></div><p>Now that we have the basic graphical elements in place to show our design and data, it might seem like the rest is purely a matter of aesthetic preference, like choosing a pretty color scheme or font. Not so.</p>
<p>There are well-founded principles to make the difference between an effective visualization and a confusing or obfuscating one. Simply put, we should try to use the simplest possible presentation of the maximal amount of information: we should maximize the “data-ink ratio.” To calculate the amount of information shown, <span class="citation" data-cites="tufte2001visual">Tufte (<a href="#ref-tufte2001visual" role="doc-biblioref">2001</a>)</span> suggests a measure called the “data density index,” the “numbers plotted per square inch.” The worst offenders have a very low density while also using a lot of excess ink (e.g., <a href="#fig-viz-bad" class="quarto-xref">figure&nbsp;<span>15.16</span></a> and <a href="#fig-viz-bad2" class="quarto-xref">figure&nbsp;<span>15.17</span></a>)</p>
<div id="fig-viz-bad2" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" alt="2 plots showing binned frequency data for 4 countries in using 3D ribbons in slightly different shades of gray.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-bad2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/viz/roeder_badviz.png" class="img-fluid figure-img" alt="2 plots showing binned frequency data for 4 countries in using 3D ribbons in slightly different shades of gray.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-bad2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.17: This figure uses complicated 3D ribbons to compare distributions across four countries <span class="citation" data-cites="roeder1994dna">(from <a href="#ref-roeder1994dna" role="doc-biblioref">Roeder 1994</a>)</span>. How could the same data have been presented more legibly?
</figcaption>
</figure>
</div>
<p>The defaults in modern visualization libraries like <code>ggplot</code> prevent some of the worst offenses but are still often suboptimal. For example: consider whether the visual complexity introduced by the default grey background and grid lines in <a href="#fig-viz-themes0" class="quarto-xref">figure&nbsp;<span>15.18</span></a> is justified, or whether a more minimal theme would be sufficient.</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-themes0" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A plot same as 15.13 but with a grey background and vertical/horizontal guidelines; color legend on the right.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-themes0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-themes0-1.png" class="img-fluid figure-img" style="width:85.0%" alt="A plot same as 15.13 but with a grey background and vertical/horizontal guidelines; color legend on the right.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-themes0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.18: Standard “gray”-themed Stiller figure.
</figcaption>
</figure>
</div>
</div>
</div>
<!-- \clearpage -->
<p><a href="#fig-viz-themes" class="quarto-xref">Figure&nbsp;<span>15.19</span></a> shows a slightly more “styled” version of the same plot with labels directly on the plot and a lighter-weight theme.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;See the <code>ggthemes</code> package <span class="citation" data-cites="arnold2023">(<a href="#ref-arnold2023" role="doc-biblioref">Arnold 2023</a>)</span> for a good collection of themes.</p></div></div><div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-themes" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A plot same as 15.18 but with no background/guidelines; lines directly labeled with their condition in corresponding colors.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-themes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-themes-1.png" class="img-fluid figure-img" style="width:85.0%" alt="A plot same as 15.18 but with no background/guidelines; lines directly labeled with their condition in corresponding colors.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-themes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.19: Custom-themed Stiller figure with direct labels.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To produce the plot in <a href="#fig-viz-themes" class="quarto-xref">figure&nbsp;<span>15.19</span></a>, we’ve added a few styling elements including:</p>
<ul>
<li>The nice and minimal custom theme, with a larger font size.</li>
<li>A more accessible color palette (<code>scale_colour_ptol()</code>) from the <code>ggthemes</code> package <span class="citation" data-cites="arnold2023">(<a href="#ref-arnold2023" role="doc-biblioref">Arnold 2023</a>)</span>.</li>
<li>Direct labels using <code>geom_dl()</code> from the <code>directlabels</code> package <span class="citation" data-cites="hocking2023">(<a href="#ref-hocking2023" role="doc-biblioref">Hocking 2023</a>)</span>.</li>
</ul>
<!-- This last item is a bit trickier to implement. To do so, we select one set of points to label and feed these in as a filtered data frame. A few manual arguments customize the placement of the labels (you can spend hours tweaking this sort of thing by hand). -->
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_dl</span>(<span class="fu">aes</span>(<span class="at">label =</span> condition), <span class="at">method =</span> <span class="fu">list</span>(<span class="st">"last.points"</span>, <span class="fu">dl.trans</span>(<span class="at">x =</span> x <span class="sc">+</span> <span class="fl">0.5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Here are a few final tips for making good confirmatory visualizations:</p>
<ul>
<li><p>Make sure the font size of all text in your figures is legible and no smaller than other text in your paper (e.g., 10 pt). This change may require, for example, making the axis breaks sparser, rotating text, or changing the aspect ratio of the figure.</p></li>
<li><p>Another important tool to keep in your visualization arsenal is the <strong>facet plot</strong>. When your experimental design becomes more complex, consider breaking variables out into a <em>grid</em> of facets instead of packing more and more colors and line-styles onto the same axis. In other words, while higher information density is typically a good thing, you want to aim for the sweet spot before it becomes too dense and confusing. Remember principle 2. When there is too much going on in every square inch, it is difficult to guide your reader’s eye to the comparisons that actually matter, and spreading it out across facets gives you additional control over the salient patterns.</p></li>
<li><p>Sometimes these principles come into conflict, and you may need to prioritize legibility over, for example, showing all of the data. For example, suppose there is an outlier orders of magnitude away from the summary statistics. If the axis limits are zoomed out to show that point, then most of the plot will be blank space! It is reasonable to decide that it is not worth compressing the key statistical question of your visualization into the bottom centimeter just to show one point. It may suffice to truncate the axes and note in the caption that a single point was excluded.</p></li>
<li><p>Fix the axis labels! A common mistake is to keep the default shorthand you used to name variables in your plotting software instead of more descriptive labels (e.g., “RT” instead of “Reaction Time”). Use consistent terminology for different manipulations and measures in the main text and figures. If anything might be unclear in the figure, explain it in the caption.</p></li>
<li><p>Different audiences may require different levels of detail. Sometimes it is better to collapse over secondary variables (even if they are included in your statistical models) to control the density of the figure and draw attention to the key question of interest.</p></li>
</ul>
</section>
</section>
<section id="exploratory-visualization" class="level2 page-columns page-full" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="exploratory-visualization"><span class="header-section-number">15.2</span> Exploratory visualization</h2>
<p>So far in this chapter we have focused on principles of <em>confirmatory</em> data visualization: how to make production-quality figures that convey the key preregistered analyses without hiding sources of variability or misleading readers about the reliability of the results. Yet, this is only one role that data visualization plays when doing science. An equally important role is called <em>exploratory visualization</em>: the more routine practice of understanding one’s own data by visualizing it. This role is analogous to the sense of exploratory data analyses discussed in <a href="011-prereg.html" class="quarto-xref"><span>chapter 11</span></a>. We typically do not preregister exploratory visualizations, and when we decide to include them in a paper they are typically in the service of a secondary argument (e.g., checking the robustness of an effect or validating that some assumption is satisfied).</p>
<p>This kind of visualization plays a ubiquitous role in a researcher’s day-to-day activities. While confirmatory visualization is primarily audience-driven and concerned with visual communication, exploratory visualization is first and foremost a “cognitive tool” for the researcher. The first time we load in a new dataset, we start up a new feedback loop—we ask ourselves questions and answer them by making visualizations. These visualizations then raise further questions and are often our best tool for debugging our code. In this section, we consider some best practices for exploratory visualization.</p>
<section id="examining-distributional-information" class="level3 page-columns page-full" data-number="15.2.1">
<h3 data-number="15.2.1" class="anchored" data-anchor-id="examining-distributional-information"><span class="header-section-number">15.2.1</span> Examining distributional information</h3>
<p>The primary advantage of exploratory visualization—the reason it is uniquely important for data science—is that it gives us access to holistic information about the distribution of the data that cannot be captured in any single summary statistic. The most famous example is known as “Anscombe’s quartet,” a set of four datasets with identical statistics (<a href="#fig-viz-anscombe" class="quarto-xref">figure&nbsp;<span>15.20</span></a>). They have the same means, the same variances, the same correlation, the same regression line, and the same <span class="math inline">\(R^2\)</span> value. Yet, when they are plotted, they reveal striking structural differences. The first looks like a noisy linear relationship—the kind of idealized relationship we imagine when we imagine a regression line. But the second is a perfect quadratic arc, the third is a perfectly noiseless line with a single outlier, and the fourth is nearly categorical: every observation except one shares exactly the same x-value.</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-anscombe" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="4 plots with same line of best fit but different points: scattered; quadratic; linear with 1 outlier; all but 1 same value.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-anscombe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-anscombe-1.png" class="img-fluid figure-img" alt="4 plots with same line of best fit but different points: scattered; quadratic; linear with 1 outlier; all but 1 same value." width="2400">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-anscombe-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.20: Anscombe’s quartet <span class="citation" data-cites="anscombe1973graphs">(<a href="#ref-anscombe1973graphs" role="doc-biblioref">Anscombe 1973</a>)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>If our analyses are supposed to help us distinguish between different data-generating processes, corresponding to different psychological theories, it is clear that these four datasets would correspond to dramatically different theories even though they share the same statistics. Of course, there are arbitrarily many datasets with the same statistics, and most of these differences don’t matter (this is why they are called “summary” statistics, after all!). <a href="#fig-viz-datasaurus" class="quarto-xref">Figure&nbsp;<span>15.21</span></a> and <a href="#tbl-datasaurus" class="quarto-xref">table&nbsp;<span>15.1</span></a> show just how bad things can get when we rely on summary statistics. When we operationalize a theory’s predictions in terms of a single statistic (e.g., a difference between groups or a regression coefficient), we can lose track of everything else that may be going on. Good visualizations force us to zoom out and take in the bigger picture.</p>
<!-- # | fig-height: 6 -->
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-datasaurus" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A scatterplot that looks like a dinosaur; a grid of 12 plots looking like many different shapes including star and circle.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-datasaurus-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-datasaurus-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A scatterplot that looks like a dinosaur; a grid of 12 plots looking like many different shapes including star and circle.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-datasaurus-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.21: Originally inspired by the Datasaurus plot constructed by Alberto Cairo using DrawMyData (<a href="http://robertgrantstats.co.uk/drawmydata.html" class="uri">http://robertgrantstats.co.uk/drawmydata.html</a>), we can construct an arbitrary number of different graphs with exactly the same statistics, such as the Datasaurus Dozen <span class="citation" data-cites="matejka2017same murray2021generating">(<a href="#ref-matejka2017same" role="doc-biblioref">Matejka and Fitzmaurice 2017</a>; <a href="#ref-murray2021generating" role="doc-biblioref">Murray and Wilson 2021</a>)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<!-- ::: {.margin-caption} -->
<div class="cell">
<div id="tbl-datasaurus" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-datasaurus-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;15.1: Summary statistics for the Datasaurus Dozen datasets <span class="citation" data-cites="matejka2017same">(<a href="#ref-matejka2017same" role="doc-biblioref">Matejka and Fitzmaurice 2017</a>)</span>.
</figcaption>
<div aria-describedby="tbl-datasaurus-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="kable-table">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">dataset</th>
<th style="text-align: right;">mean_x</th>
<th style="text-align: right;">mean_y</th>
<th style="text-align: right;">sd_x</th>
<th style="text-align: right;">sd_y</th>
<th style="text-align: right;">cor_xy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">away</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">-0.064</td>
</tr>
<tr class="even">
<td style="text-align: left;">bullseye</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">-0.069</td>
</tr>
<tr class="odd">
<td style="text-align: left;">circle</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">-0.068</td>
</tr>
<tr class="even">
<td style="text-align: left;">dino</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">-0.064</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dots</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">-0.060</td>
</tr>
<tr class="even">
<td style="text-align: left;">h_lines</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">-0.062</td>
</tr>
<tr class="odd">
<td style="text-align: left;">high_lines</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">-0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">slant_down</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">-0.069</td>
</tr>
<tr class="odd">
<td style="text-align: left;">slant_up</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">-0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">star</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">-0.063</td>
</tr>
<tr class="odd">
<td style="text-align: left;">v_lines</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">-0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">wide_lines</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">-0.067</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x_shape</td>
<td style="text-align: right;">54.3</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">16.8</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">-0.066</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<!-- ::: -->
<div class="callout callout-style-default callout-note callout-titled" title="accident report">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
accident report
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<section id="distributional-gorillas-in-our-midst" class="level3 unnumbered callout-body-container callout-body">
<h3 class="unnumbered anchored" data-anchor-id="distributional-gorillas-in-our-midst">[Distributional] gorillas in our midst</h3>
<p>Many data scientists don’t bother checking what their data looks like before proceeding to test specific hypotheses. <span class="citation" data-cites="yanai2020">Yanai and Lercher (<a href="#ref-yanai2020" role="doc-biblioref">2020</a>)</span> cleverly designed an artificial dataset for their students to test for such oversight. Each row of the dataset contained an individual’s body mass index (BMI) and the number of steps they walked on a given day. While the spreadsheet looked innocuous, the data was constructed such that simply plotting the raw data revealed a picture of a gorilla. One group of 19 students was given an explicit set of hypotheses to test (e.g., about the relationship between BMI and steps). Fourteen of these students failed to notice a gorilla, suggesting that they evaluated these hypotheses without ever visualizing their data. Another group of 14 students were simply asked what, if anything, they could conclude (without being given explicit hypotheses). More of these students apparently made the visualization, but five of them still failed to notice the gorilla (<a href="#fig-viz-gorilla" class="quarto-xref">figure&nbsp;<span>15.22</span></a>)!</p>
<div id="fig-viz-gorilla" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-viz-gorilla-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<p><img src="015-viz_files/figure-html/fig-viz-gorilla-1.png" class="img-fluid figure-img" style="width:35.0%" alt="A scatterplot of Body Mass Index against Steps with different colors corresponding to Male and Female; looks like a gorilla."></p>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-viz-gorilla-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.22: A dataset constructed by <span class="citation" data-cites="yanai2020">Yanai and Lercher (<a href="#ref-yanai2020" role="doc-biblioref">2020</a>)</span> that revealed a picture of a gorilla when the raw data were plotted.
</figcaption>
</figure>
</div>
<p>While it may not be surprising that a group of students would take the shortest path to completing their assignment, similar concerns have been raised in much more serious cases concerning how experienced researchers could fail to notice obviously fraudulent data. For example, when the Datacolada bloggers <span class="citation" data-cites="datacolada">(<a href="#ref-datacolada" role="doc-biblioref">2021</a>)</span> made a simple histogram of the car mileage data reported in <span class="citation" data-cites="shu2012signing kristal2020signing">Shu et al. (<a href="#ref-shu2012signing" role="doc-biblioref">2012</a>; released publicly by <a href="#ref-kristal2020signing" role="doc-biblioref">Kristal et al. 2020</a>)</span>, they were immediately able to observe that it followed a perfectly uniform distribution, truncated at exactly 50,000 miles (<a href="#fig-viz-uniform" class="quarto-xref">figure&nbsp;<span>15.23</span></a>). Given a little thought, this pattern should be extremely puzzling. Over a given period of time, we would typically expect something more bell-shaped: a small number of people will drive very little (e.g., 1,000 miles), a small number of people will drive a lot (e.g., 50,000 miles), and most people will fall between these tails. So it is highly surprising to find exactly the same number of drivers in every mileage bin. While further specialized analyses revealed additional evidence of fraud (e.g., based on patterns of rounding and pairs of duplicated data points), this humble histogram was already enough to set off alarm bells. A recurring regret raised by the coauthors of this paper is that they never thought to make this visualization before reporting their statistical tests.</p>
<div id="fig-viz-uniform" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-viz-uniform-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<p><img src="015-viz_files/figure-html/fig-viz-uniform-1.png" class="img-fluid figure-img" style="width:50.0%" alt="A histogram showing counts of implied miles driven; there are no bars above 50000 implied miles&nbsp;driven."></p>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-viz-uniform-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.23: A suspiciously uniform distribution abruptly cutting off at 50K miles. Ring the alarm! Adapted from <span class="citation" data-cites="datacolada">Datacolada (<a href="#ref-datacolada" role="doc-biblioref">2021</a>)</span>.
</figcaption>
</figure>
</div>
<p>Our data are always messier than we expect. There might be a bug in our coding scheme, a column might be mislabeled, or it might contain a range of values that we didn’t expect. Maybe our design wasn’t perfectly balanced, or something went wrong with a particular participant’s keyboard presses. Most of the time, it’s not tractable to manually scroll through our raw data looking for such problems. Visualization is our first line of defense for the all-important process of running “data diagnostics.” If there is a weird artifact in our data, it will pop out if we just make the right visualizations.</p>
</section>
</div>
</div>
</section>
<section id="data-diagnostics" class="level3" data-number="15.2.2">
<h3 data-number="15.2.2" class="anchored" data-anchor-id="data-diagnostics"><span class="header-section-number">15.2.2</span> Data diagnostics</h3>
<p>So, which visualizations should we start with? The best practice is to always start by making histograms of the raw data. As an example, let’s consider the rich and interesting dataset shared by <span class="citation" data-cites="blake2015ontogeny">Blake et al. (<a href="#ref-blake2015ontogeny" role="doc-biblioref">2015</a>)</span> in their article “Ontogeny of Fairness in Seven Societies.” This study examines the emergence of children’s reasoning about fairness—both when it benefits them and when it harms them—across cultures.</p>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If you want to follow along with this example at home, you can load the data from our repository!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>repo <span class="ot">&lt;-</span> <span class="st">"https://github.com/langcog/experimentology/raw/main/"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fairness_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(repo, <span class="st">"data/viz/ontogeny_of_fairness.csv"</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>fairness <span class="ot">&lt;-</span> fairness_raw <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trial_num =</span> trial <span class="sc">|&gt;</span> <span class="fu">str_remove</span>(<span class="st">"t"</span>) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">trial_type =</span> eq.uneq <span class="sc">|&gt;</span> <span class="fu">fct_recode</span>(<span class="st">"Equal"</span> <span class="ot">=</span> <span class="st">"E"</span>, <span class="st">"Unequal"</span> <span class="ot">=</span> <span class="st">"U"</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">condition =</span> condition <span class="sc">|&gt;</span> <span class="fu">fct_recode</span>(<span class="st">"Advantageous"</span> <span class="ot">=</span> <span class="st">"AI"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Disadvantageous"</span> <span class="ot">=</span> <span class="st">"DI"</span>),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">age =</span> <span class="fu">floor</span>(actor.age.years),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">reject =</span> decision <span class="sc">==</span> <span class="st">"reject"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">subj_id =</span> actor.id, age, country, condition, trial_num, trial_type, reject) <span class="sc">|&gt;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(country, condition, subj_id, trial_num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>In this study, pairs of children played the “inequity game”: they sat across from one another and were given a particular allocation of snacks. On some trials, each participant was allocated the same amount (“equal” trials) and on some trials they were allocated different amounts (“unequal” trials). One participant was chosen to be the “actor” and got to choose whether to accept or reject the allocation: in the case of rejection, neither participant got anything. The critical manipulation was between two forms of inequity. Some pairs were assigned to the “disadvantageous” condition, where the actor was allocated less than their partner on unequal trials (e.g., one vs four). Others were assigned to the “advantageous” condition, where they were allocated more (e.g., four vs one).</p>
<p>The confirmatory <strong>design plot</strong> for this study would focus on contrasting developmental trajectories for advantageous vs disadvantageous inequality. However, this is a complex, multivariate dataset, including 866 pairs from different age groups and different testing sites across the world which used subtly different protocols. How might we go about the process of exploratory visualization for this dataset?</p>
</section>
<section id="plot-data-collection-details" class="level3 page-columns page-full" data-number="15.2.3">
<h3 data-number="15.2.3" class="anchored" data-anchor-id="plot-data-collection-details"><span class="header-section-number">15.2.3</span> Plot data collection details</h3>
<p>Let’s start by getting a handle on some of the basic sample characteristics. How many participants were in each age bin (<a href="#fig-viz-blake3" class="quarto-xref">figure&nbsp;<span>15.24</span></a>)?</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-blake3" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A histogram showing counts of participants in each age&nbsp;bin from 4 to 15; most participants around ages 8/9 and fewer older.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-blake3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-blake3-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A histogram showing counts of participants in each age&nbsp;bin from 4 to 15; most participants around ages 8/9 and fewer older.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-blake3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.24: Participants by age in the Blake data.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Exploratory histograms are often a combination of an aggregation step and a plotting step. In the aggregation step, we make use of the convenience <code>count()</code> function, which gives the number (<code>n</code>) of rows in a particular grouping. Here we <code>count()</code> twice in order to get first one row per participant and then count the number of participants within each age group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fairness_by_age <span class="ot">&lt;-</span> fairness <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age, subj_id) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And then we plot using <code>ggplot()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fairness_by_age, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age (years)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>An alternative (perhaps more elegant) workflow here would be to use a histogram:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fairness_by_age <span class="ot">&lt;-</span> fairness <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age, subj_id) </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fairness_by_age, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age (years)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>How many participants were from each country (<a href="#fig-viz-blake5" class="quarto-xref">figure&nbsp;<span>15.25</span></a>)?</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-blake5" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A histogram showing counts of participants in each country; largest count of participants in USA and smallest in Mexico.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-blake5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-blake5-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A histogram showing counts of participants in each country; largest count of participants in USA and smallest in Mexico.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-blake5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.25: Participants by country in the Blake data.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here we are going to make things even terser and use a pipe chain that <em>includes</em> the <code>ggplot()</code> call, just so we are writing only a single call to produce our plot. It’s up to you whether you think this enhances the readability of your code or decreases it. We find that it’s sometimes useful when you don’t plan on keeping the intermediate data frame for any other use than plotting.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fairness <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(country, subj_id) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(country) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">fct_reorder</span>(country, <span class="sc">-</span>n)) <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you use this technique, be careful to use pipe (<code>|&gt;</code> or <code>%&gt;%</code>) between function calls but use <code>+</code> between <code>ggplot</code> layers!</p>
<p>The only other trick to point out here is that we use the <code>fct_reorder()</code> call to order the levels of the <code>country</code> factor in descending order. This function is found in the very useful <code>forcats</code> package <span class="citation" data-cites="wickham2023">(<a href="#ref-wickham2023" role="doc-biblioref">Wickham 2023</a>)</span> of the <code>tidyverse</code>, which contains all sorts of functions for working with factors.</p>
</div>
</div>
</div>
<p>Are ages roughly similar across each country (<a href="#fig-viz-blake6" class="quarto-xref">figure&nbsp;<span>15.26</span></a>)?</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-blake6" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A grid of histograms like 15.24 but by country; USA distribution is fairly uniform; other countries have peak around 8/9.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-blake6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-blake6-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A grid of histograms like 15.24 but by country; USA distribution is fairly uniform; other countries have peak around 8/9.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-blake6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.26: Age distribution across countries in the Blake data.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This next plot simply combines the grouping factors of each of the last two plots, and uses <code>facet_wrap()</code> to show a separate histogram by country:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fairness <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(country, age, subj_id) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(country, age) <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">fct_reorder</span>(country, <span class="sc">-</span>n)) <span class="sc">|&gt;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(country), <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age (years)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>These exploratory visualizations help us read off some descriptive properties of the sample. For example, we can see that age ranges differ somewhat across sites: the maximum age is 11 in India but 15 in Mexico. We can also see that age groups are fairly imbalanced: in Canada, there are 18 eleven-year-olds but only 5 six-year-olds.</p>
<p>None of these properties are problematic, but seeing them gives us a degree of awareness that could shape our downstream analytic decisions. For example, if we did not appropriately model random effects, our estimates would be dominated by the countries with larger sample sizes. And if we were planning to compare specific groups of six-year-olds (for some reason), this analysis would be underpowered.</p>
</section>
<section id="explorating-distributions" class="level3 page-columns page-full" data-number="15.2.4">
<h3 data-number="15.2.4" class="anchored" data-anchor-id="explorating-distributions"><span class="header-section-number">15.2.4</span> Explorating distributions</h3>
<p>Now that we have a handle on the sample, let’s get a sense of the dependent variable: the participant’s decision to accept or reject the allocation. Before we start taking means, let’s look at how the “rejection rate” variable is distributed. We’ll aggregate at the participant level, and check the frequency of different rejection rates, overall (<a href="#fig-viz-blake7" class="quarto-xref">figure&nbsp;<span>15.27</span></a>).</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-blake7" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A histogram showing binned counts of proportion of offers rejected; most common proportion is 0%; few proportions above 50%.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-blake7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-blake7-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A histogram showing binned counts of proportion of offers rejected; most common proportion is 0%; few proportions above 50%.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-blake7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.27: Rejection rates in the Blake data.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Rejection rate is a continuous variable, so we switch to using a histogram in this case, choosing 0.05 as a reasonable bin width to see the distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fairness_by_subj <span class="ot">&lt;-</span> fairness <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(trial_type)) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subj_id) <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_reject =</span> <span class="fu">mean</span>(reject, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fairness_by_subj, <span class="fu">aes</span>(<span class="at">x =</span> mean_reject)) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> .<span class="dv">05</span>) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Proportion of offers rejected"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>We notice that many participants (27%) never reject in the entire experiment. This kind of “zero-inflated” distribution is not uncommon in psychology, and may warrant special consideration when designing the statistical model. We also notice that there is clumping around certain values. This clumping leads us to check how many trials each participant is completing (<a href="#fig-viz-blake8" class="quarto-xref">figure&nbsp;<span>15.28</span></a>).</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-blake8" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A histogram showing counts of participants by number of trials; most participants have 16, some have 12, a few have 14/15.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-blake8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-blake8-1.png" class="img-fluid figure-img" style="width:80.0%" alt="A histogram showing counts of participants by number of trials; most participants have 16, some have 12, a few have 14/15.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-blake8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.28: Trials per participant in the Blake data.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This histogram is very similar to the ones above; however, we now use <code>count()</code> twice, first getting the trial counts for each participant and then counting how many times each count occurs overall!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fairness <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(trial_type)) <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(subj_id) <span class="sc">|&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(n) <span class="sc">|&gt;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> nn)) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of trials"</span>, <span class="at">y =</span> <span class="st">"Count of participants"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>There’s some variation here: most participants completed 17 trials, but some participants completed 8 trials, and a small number of participants have 14 or 15. Given the logistical complexity of large multi-site studies, it is common to have some changes in experimental protocol across data collection. Indeed, looking at the supplement for the study, we see that while India and Peru had 12 trials, additional trials were added at the other sites. In a design where the number of trials was carefully controlled, seeing unexpected numbers here (like the 14 or 15 trial bins) are clues that something else may be going on in the data. In this case, it was a small number of trials with missing data. More generally, seeing this kind of signal in a visualization of our own data typically leads us to look up the participant IDs in these bins and manually inspect their data to see what might be going on.</p>
<!-- You can also learn a lot from looking at *pairwise* relationships in datasets with multiple continuous predictors. -->
<!-- By making scatter plots of the different variables, you may notice that some are strongly correlated with one another, and might start to worry about whether this could cause problems in regression models trying to tease them apart. -->
<!-- You may also notice more complicated relationships; for example, one cloud of points that is strongly correlated, and another cloud of points that is not. -->
<!-- Reporting a single correlation and claiming a relationship might therefore be misleading. -->
<!-- Instead, we would want to be careful to break this relationship out by other variables and try to understand why there are two separate clouds. -->
</section>
<section id="hypothesis-driven-exploration" class="level3 page-columns page-full" data-number="15.2.5">
<h3 data-number="15.2.5" class="anchored" data-anchor-id="hypothesis-driven-exploration"><span class="header-section-number">15.2.5</span> Hypothesis-driven exploration</h3>
<p>Finally, we can make a few versions of the design plot that are broken out by different variables. Let’s start by just looking at the data from the largest site (<a href="#fig-viz-blake9" class="quarto-xref">figure&nbsp;<span>15.29</span></a>).</p>
<div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-blake9" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="4 plots ([dis]advantageous x [un]equal) each showing points and best fit lines for proportion of offers rejected against age.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-blake9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-blake9-1.png" class="img-fluid figure-img" style="width:90.0%" alt="4 plots ([dis]advantageous x [un]equal) each showing points and best fit lines for proportion of offers rejected against age.">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-blake9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.29: Rejection rates in the US data from Blake, plotted by age.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-viz-blake9" class="quarto-xref">Figure&nbsp;<span>15.29</span></a> is not a figure we’d put in a paper, but it helps us get a sense of the pattern in the data. There appears to be an age trend that’s specific to the Unequal trials, with rejection rates rising over time (compared to roughly even or decreasing rates in the Equal trials). Meanwhile, rejection rates for the disadvantageous group also seem slightly higher than those in the advantageous group.</p>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here, we are using <code>geom_smooth()</code> to overlay regression trends over the raw data. <code>geom_smooth()</code> takes a number of different options corresponding to different smoothing techniques. Nonparametric smoothing can be a good choice for exploratory visualizations if you have a lot of data and want to make minimal assumptions about the form of the trend.</p>
<p>Here, however, we show the linear regression trend, <code>geom_smooth(method = "lm")</code>, which better corresponds to the predictions of the study and the statistical model being used (see <a href="007-models.html" class="quarto-xref"><span>chapter 7</span></a>). Other regression forms can be specified with the <code>formula</code> argument. For example, we could show quadratic smoothing with <code>geom_smooth(method = "lm", formula = y ~ poly(x, 2))</code>. The form of smoothing you use may differ across exploratory and confirmatory visualizations. In a confirmatory visualization—if you are going to include a smoothing curve—it is typically best to use the one specified by your statistical model, as the slopes will correspond to the inferences being testing.</p>
<p>We begin by making a summary dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fairness_by_age <span class="ot">&lt;-</span> fairness <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(reject)) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, trial_type, condition, age, subj_id) <span class="sc">|&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_reject_subj =</span> <span class="fu">mean</span>(reject, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, trial_type, condition, age) <span class="sc">|&gt;</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_reject_age =</span> <span class="fu">mean</span>(mean_reject_subj, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_subj =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we can create the visualization:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fairness_by_age <span class="sc">|&gt;</span> <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"US"</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> mean_reject_age, <span class="at">color =</span> condition)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="fu">vars</span>(trial_type), <span class="fu">vars</span>(condition)) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> n_subj), <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age (years)"</span>, <span class="at">y =</span> <span class="st">"Proportion of offers rejected"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"Condition"</span>, <span class="at">size =</span> <span class="st">"N subjects"</span>) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.box =</span> <span class="st">"vertical"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We often find it convenient to filter the summary dataset in the plotting call, so that we can reuse it again.</p>
</div>
</div>
</div>
<p>Now let’s rebin the data into two-year age groups so that individual point estimates are a bit more reliable, and add in the other countries.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>&nbsp;Binning data is a trick that we often use for reducing complexity in a plot when data are noisy. It should be used with care, however, since different binning decisions can sometimes lead to different conclusions. Here we tried several binning intervals and decided that two-year age bins showed the underlying trends pretty well.</p></div></div><div class="cell page-columns page-full" data-cap-location="margin">
<div class="cell-output-display page-columns page-full">
<div id="fig-viz-blake10" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-cap-location="margin" alt="A grid of scatterplots analogous to those in 15.29 but separated by country x [un]equal; color indicates [dis]advantageous.">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-viz-blake10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="015-viz_files/figure-html/fig-viz-blake10-1.png" class="img-fluid figure-img" alt="A grid of scatterplots analogous to those in 15.29 but separated by country x [un]equal; color indicates [dis]advantageous." width="2700">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-viz-blake10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.30: Rejection rates by age for all data in the Blake dataset.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-viz-blake10" class="quarto-xref">Figure&nbsp;<span>15.30</span></a> is now looking much closer to a quick-and-dirty version of a “design plot” we might include in a paper. The DV (rejection rate) is on the y-axis, and the primary variable of interest (age) is on the x-axis. Other elements of the design (country and trial type) are mapped to color and facets, respectively.</p>
<div class="callout callout-style-default callout-note callout-titled" title="code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Despite the difference between the plot above and this one, the code to produce them is actually very similar. The only difference is the creation of the binned variable and a slight shift of aesthetic and faceting variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fairness_by_age_binned <span class="ot">&lt;-</span> fairness <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(reject)) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_binned =</span> <span class="fu">floor</span>(age <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, trial_type, condition, age_binned, subj_id) <span class="sc">|&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_reject_subj =</span> <span class="fu">mean</span>(reject, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, trial_type, condition, age_binned) <span class="sc">|&gt;</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_reject_age =</span> <span class="fu">mean</span>(mean_reject_subj, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>())  <span class="sc">|&gt;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fairness_by_age_binned,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age_binned, <span class="at">y =</span> mean_reject_age, <span class="at">color =</span> condition)) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">vars</span>(trial_type), <span class="fu">vars</span>(country)) <span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">weight=</span>n)) <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">5</span>, <span class="fu">aes</span>(<span class="at">size =</span> n)) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">4</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">13</span>)) <span class="sc">+</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age (years)"</span>, <span class="at">y =</span> <span class="st">"Proportion of offers rejected"</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Condition"</span>, <span class="at">size =</span> <span class="st">"N subjects"</span>) <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="visualization-as-debugging" class="level3" data-number="15.2.6">
<h3 data-number="15.2.6" class="anchored" data-anchor-id="visualization-as-debugging"><span class="header-section-number">15.2.6</span> Visualization as debugging</h3>
<p>The point of exploratory visualization is to converge toward a better understanding of what’s going on in your data. As you iterate through different exploratory visualizations, <em>stay vigilant</em>! Think about what you expect to see before making the plot, then ask yourself whether you got what you expected. You can think of this workflow as a form of “visual debugging.” You might notice a data point with an impossible value, such as a proportion greater than one or a reaction time less than zero. Or you might notice weird clusters or striations, which might indicate heterogeneity in data entry (perhaps different coders used slightly different rubrics or rounded in different ways). You might notice that an attribute is missing for some values and trace it back to a bug reading in the data or merging data frames (maybe there was a missing comma in our <code>csv</code> file). If you see anything that looks weird, track it down until you understand why it’s happening. Bugs that are subtle and invisible in other parts of the analysis pipeline will often pop out as red flags in visualizations.</p>
</section>
</section>
<section id="chapter-summary-visualization" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="chapter-summary-visualization"><span class="header-section-number">15.3</span> Chapter summary: Visualization</h2>
<p>This chapter has given a short review of the principles of data visualization, especially focusing on the needs of experimental psychology, which are often quite different than those of other fields. We particularly focused on the need to make visualization part of the experimenter’s analytic workflow. Picking up the idea of a “default model” from <a href="007-models.html" class="quarto-xref"><span>chapter 7</span></a>, we discussed a default “design plot” that reflects the key choices made in the experimental design. Within this framework, we then discussed different visualizations of distribution and variability that better align our graphics with the principles of measurement and attention to raw data that we have been advocating throughout.</p>
<div class="callout callout-style-default callout-note callout-titled" title="discussion questions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
discussion questions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Choose a recent piece of research that you’ve heard about and try to sketch the “design plot” with pencil and paper. What does and doesn’t work? How does your sketch differ from the visualizations in the paper?</p></li>
<li><p>The “design plot” idea that we’ve discussed here can run into problems when an experimental design is too complex to show on a single plot. Imagine you had data from a trial of attention deficit hyperactivity disorder (ADHD) treatment that manipulated both whether a medication was given and whether patients received therapy in a crossed design. The researchers measured two different outcomes: parent report symptom severity and teacher report symptom severity in four different time-points (baseline, three months, six months, and nine months). How could you show the data from such an experiment in a transparent way?</p></li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="readings">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
readings
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are many good introductions to data visualization. Here are two social-science focused books whose advice we agree with and that also contain a lot of practical information and helpful R code for the same packages we use here.</p>
<ul>
<li><p>Healy, Kieran <span class="citation" data-cites="healy2018">(<a href="#ref-healy2018" role="doc-biblioref">2018</a>)</span>. <em>Data Visualization: A Practical Introduction</em>. Princeton University Press. Available free online at <a href="https://socviz.co" class="uri">https://socviz.co</a>.</p></li>
<li><p>Wilke, Claus O. <span class="citation" data-cites="wilke2019">(<a href="#ref-wilke2019" role="doc-biblioref">2019</a>)</span>. <em>Fundamentals of Data Visualization: A Primer on Making Informative and Compelling Figures</em>. O’Reilly Media. Available free online at <a href="https://clauswilke.com/dataviz" class="uri">https://clauswilke.com/dataviz</a>.</p></li>
</ul>
<p>For a more classical treatment, see:</p>
<ul>
<li><p>Tukey, John W. <span class="citation" data-cites="tukey1977">(<a href="#ref-tukey1977" role="doc-biblioref">1977</a>)</span>. <em>Exploratory Data Analysis</em>. Pearson.</p></li>
<li><p>Tufte, Edward R. <span class="citation" data-cites="tufte2001visual">(<a href="#ref-tufte2001visual" role="doc-biblioref">2001</a>)</span>. <em>The Visual Display of Quantitative Information</em>. 2nd ed.&nbsp;Graphics Press.</p></li>
</ul>
</div>
</div>
</div>


</section>
<section id="bibliography" class="level1 unnumbered">
<h1 class="unnumbered"></h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-allen2019raincloud" class="csl-entry" role="listitem">
Allen, Micah, Davide Poggiali, Kirstie Whitaker, Tom Rhys Marshall, and Rogier A Kievit. 2019. <span>“Raincloud Plots: A Multi-Platform Tool for Robust Data Visualization.”</span> <em>Wellcome Open Research</em> 4.
</div>
<div id="ref-anscombe1973graphs" class="csl-entry" role="listitem">
Anscombe, Francis J. 1973. <span>“Graphs in Statistical Analysis.”</span> <em>The American Statistician</em> 27 (1): 17–21.
</div>
<div id="ref-arnold2023" class="csl-entry" role="listitem">
Arnold, Jeffrey B. 2023. <em><span class="nocase">ggthemes</span>: Extra Themes, Scales and Geoms for <span class="nocase">ggplot2</span></em>. <a href="https://CRAN.R-project.org/package=ggthemes">https://CRAN.R-project.org/package=ggthemes</a>.
</div>
<div id="ref-barnett2022" class="csl-entry" role="listitem">
Barnett, Samuel A, Thomas L Griffiths, and Robert D Hawkins. 2022. <span>“A Pragmatic Account of the Weak Evidence Effect.”</span> <em>Open Mind</em> 6 (2022): 169–82. <a href="https://doi.org/10.1162/opmi_a_00061">https://doi.org/10.1162/opmi_a_00061</a>.
</div>
<div id="ref-blake2015ontogeny" class="csl-entry" role="listitem">
Blake, P R, K McAuliffe, J Corbit, T C Callaghan, O Barry, A Bowie, L Kleutsch, et al. 2015. <span>“The Ontogeny of Fairness in Seven Societies.”</span> <em>Nature</em> 528 (7581): 258–61.
</div>
<div id="ref-borner2019data" class="csl-entry" role="listitem">
Börner, Katy, Andreas Bueckle, and Michael Ginda. 2019. <span>“Data Visualization Literacy: Definitions, Conceptual Frameworks, Exercises, and Assessments.”</span> <em>Proceedings of the National Academy of Sciences</em> 116 (6): 1857–64.
</div>
<div id="ref-braginsky2018" class="csl-entry" role="listitem">
Braginsky, Mika, and Daniel Yurovsky. 2018. <em><span class="nocase">tidyboot</span>: Tidyverse-Compatible Bootstrapping</em>. <a href="https://CRAN.R-project.org/package=tidyboot">https://CRAN.R-project.org/package=tidyboot</a>.
</div>
<div id="ref-brody2000map" class="csl-entry" role="listitem">
Brody, Howard, Michael Russell Rip, Peter Vinten-Johansen, Nigel Paneth, and Stephen Rachman. 2000. <span>“Map-Making and Myth-Making in Broad Street: The London Cholera Epidemic, 1854.”</span> <em>The Lancet</em> 356 (9223): 64–68.
</div>
<div id="ref-cleveland1984" class="csl-entry" role="listitem">
Cleveland, William S, and Robert McGill. 1984. <span>“Graphical Perception: Theory, Experimentation, and Application to the Development of Graphical Methods.”</span> <em>Journal of the American Statistical Association</em> 79 (387): 531–54.
</div>
<div id="ref-coppock2019" class="csl-entry" role="listitem">
Coppock, Alexander. 2019. <span>“Visualize as You Randomize: Design-Based Statistical Graphs for Randomized Experiments.”</span> In <em>Advances in Experimental Political Science</em>, edited by James N. Druckman and Donald P. Green, 320–36. Cambridge University Press.
</div>
<div id="ref-datacolada" class="csl-entry" role="listitem">
Datacolada. 2021. <span>“Evidence of Fraud in an Influential Field Experiment about Dishonesty.”</span> <a href="https://datacolada.org/98">https://datacolada.org/98</a>.
</div>
<div id="ref-friendly2021history" class="csl-entry" role="listitem">
Friendly, Michael, and Howard Wainer. 2021. <em>A History of Data Visualization and Graphic Communication</em>. Harvard University Press.
</div>
<div id="ref-gelman2013" class="csl-entry" role="listitem">
Gelman, Andrew, and Antony Unwin. 2013. <span>“Infovis and Statistical Graphics: Different Goals, Different Looks.”</span> <em>Journal of Computational and Graphical Statistics</em> 22 (1): 2–28.
</div>
<div id="ref-halliday2001death" class="csl-entry" role="listitem">
Halliday, Stephen. 2001. <span>“Death and Miasma in Victorian London: An Obstinate Belief.”</span> <em>British Medical Journal</em> 323 (7327): 1469–71.
</div>
<div id="ref-healy2018" class="csl-entry" role="listitem">
Healy, Kieran. 2018. <em>Data Visualization: A Practical Introduction</em>. Princeton University Press.
</div>
<div id="ref-henry2022" class="csl-entry" role="listitem">
Henry, Lionel, Hadley Wickham, and Winston Chang. 2022. <em><span class="nocase">ggstance</span>: Horizontal <span class="nocase">ggplot2</span> Components</em>. <a href="https://CRAN.R-project.org/package=ggstance">https://CRAN.R-project.org/package=ggstance</a>.
</div>
<div id="ref-hocking2023" class="csl-entry" role="listitem">
Hocking, Toby Dylan. 2023. <em><span class="nocase">directlabels</span>: Direct Labels for Multicolor Plots</em>. <a href="https://CRAN.R-project.org/package=directlabels">https://CRAN.R-project.org/package=directlabels</a>.
</div>
<div id="ref-kristal2020signing" class="csl-entry" role="listitem">
Kristal, Ariella S, Ashley V Whillans, Max H Bazerman, Francesca Gino, Lisa L Shu, Nina Mazar, and Dan Ariely. 2020. <span>“Signing at the Beginning Versus at the End Does Not Decrease Dishonesty.”</span> <em>Proceedings of the National Academy of Sciences</em> 117 (13): 7103–7.
</div>
<div id="ref-mackinlay1986" class="csl-entry" role="listitem">
Mackinlay, Jock. 1986. <span>“Automating the Design of Graphical Presentations of Relational Information.”</span> <em><span>ACM</span> Transactions <span>on</span> Graphics</em> 5 (2): 110–41.
</div>
<div id="ref-matejka2017same" class="csl-entry" role="listitem">
Matejka, Justin, and George Fitzmaurice. 2017. <span>“Same Stats, Different Graphs: Generating Datasets with Varied Appearance and Identical Statistics <span class="nocase">through</span> Simulated Annealing.”</span> In <em>Proceedings of the 2017 CHI Conference on Human Factors in Computing Systems</em>, 1290–94.
</div>
<div id="ref-murray2021generating" class="csl-entry" role="listitem">
Murray, Lori L, and John G Wilson. 2021. <span>“Generating Data Sets for Teaching the Importance of Regression Analysis.”</span> <em>Decision Sciences Journal of Innovative Education</em> 19 (2): 157–66.
</div>
<div id="ref-roeder1994dna" class="csl-entry" role="listitem">
Roeder, Kathryn. 1994. <span>“DNA Fingerprinting: A Review of the Controversy.”</span> <em>Statistical Science</em> 9 (2): 222–47.
</div>
<div id="ref-shu2012signing" class="csl-entry" role="listitem">
Shu, Lisa L, Nina Mazar, Francesca Gino, Dan Ariely, and Max H Bazerman. 2012. <span>“Signing at the Beginning Makes Ethics Salient and Decreases Dishonest Self-Reports in Comparison to Signing at the End.”</span> <em>Proceedings of the National Academy of Sciences</em> 109 (38): 15197–200.
</div>
<div id="ref-snow1854report" class="csl-entry" role="listitem">
Snow, John. 1854. <span>“Dr. Snow’s Report.”</span> In <em>Report on the Cholera Outbreak in the Parish of St. James, Westminster, During the Autumn of 1854</em>. John Churchill. <a href="https://johnsnow.matrix.msu.edu/work.php?id=15-78-55">https://johnsnow.matrix.msu.edu/work.php?id=15-78-55</a>.
</div>
<div id="ref-snow1855mode" class="csl-entry" role="listitem">
———. 1855. <em>On the Mode of Communication of Cholera</em>. John Churchill.
</div>
<div id="ref-stiller2015" class="csl-entry" role="listitem">
Stiller, Alex J, Noah D Goodman, and Michael C Frank. 2015. <span>“Ad-Hoc Implicature in Preschool Children.”</span> <em>Language Learning and Development</em> 11 (2): 176–90.
</div>
<div id="ref-tufte2001visual" class="csl-entry" role="listitem">
Tufte, Edward R. 2001. <em>The Visual Display of Quantitative Information</em>. 2nd ed. Graphics Press.
</div>
<div id="ref-tukey1977" class="csl-entry" role="listitem">
Tukey, John W. 1977. <em>Exploratory Data Analysis</em>. Pearson.
</div>
<div id="ref-wainer1984display" class="csl-entry" role="listitem">
Wainer, Howard. 1984. <span>“How to Display Data Badly.”</span> <em>The American Statistician</em> 38 (2): 137–47.
</div>
<div id="ref-wickham2023" class="csl-entry" role="listitem">
Wickham, Hadley. 2023. <em><span class="nocase">forcats</span>: Tools for Working with Categorical Variables (Factors)</em>. <a href="https://CRAN.R-project.org/package=forcats">https://CRAN.R-project.org/package=forcats</a>.
</div>
<div id="ref-wilke2019" class="csl-entry" role="listitem">
Wilke, Claus O. 2019. <em>Fundamentals of Data Visualization: A Primer on Making Informative and Compelling Figures</em>. O’Reilly Media.
</div>
<div id="ref-wilke2023" class="csl-entry" role="listitem">
———. 2023. <em><span class="nocase">ggridges</span>: Ridgeline Plots in <span class="nocase">ggplot2</span></em>. <a href="https://CRAN.R-project.org/package=ggridges">https://CRAN.R-project.org/package=ggridges</a>.
</div>
<div id="ref-yanai2020" class="csl-entry" role="listitem">
Yanai, I, and M Lercher. 2020. <span>“A Hypothesis Is a Liability.”</span> <em>Genome Biology</em> <span>21, 231</span> (2020). <a href="https://doi.org/10.1186/s13059-020-02133-w">https://doi.org/10.1186/s13059-020-02133-w</a>.
</div>
<div id="ref-zacks2020designing" class="csl-entry" role="listitem">
Zacks, Jeffrey M, and Steven L Franconeri. 2020. <span>“Designing Graphs for Decision-Makers.”</span> <em>Policy Insights from the Behavioral and Brain Sciences</em> 7 (1): 52–63.
</div>
</div>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./014-writing.html" class="pagination-link" aria-label="Writing">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./016-meta.html" class="pagination-link" aria-label="Meta-analysis">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Meta-analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/langcog/experimentology/blob/main/015-viz.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/langcog/experimentology/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>