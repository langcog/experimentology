
<!DOCTYPE html>
<html>
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 7 Models | Experimentology" />
<meta property="og:type" content="book" />




<meta name="author" content="Michael C. Frank, Mika Braginsky, Julie Cachia, Nicholas Coles, Tom Hardwicke, Robert Hawkins, Maya Mathur, and Rondeline Williams" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Chapter 7 Models | Experimentology">

<title>Chapter 7 Models | Experimentology</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<link rel="stylesheet" type="text/css" href="/assets/src/index.page.client.jsx.ee68a00a.css"></head>
<body>



<div class="row">
<div class="col-sm-12">
<div id="island_0"><header class="_toc_1lnsy_1" id="toc"><a class="_book_title_1lnsy_24" href="/">Experimentology: An Open Science Approach to Experimental Psychology Methods</a><nav><div class="_part_1lnsy_16"><div class="_part_title_1lnsy_24"><div class="_part_title_first_1lnsy_59">Preliminaries</div><div class="_part_title_rest_1lnsy_32"></div></div><div class="_dropdown_1lnsy_16"><a class="_chapter_title_1lnsy_32" href="1-experiments">Experiments</a><a class="_chapter_title_1lnsy_32" href="2-theories">Theories</a><a class="_chapter_title_1lnsy_32" href="3-replication">Replication and reproducibility</a><a class="_chapter_title_1lnsy_32" href="4-ethics">Ethics</a></div></div><div class="_part_1lnsy_16"><div class="_part_title_1lnsy_24"><div class="_part_title_first_1lnsy_59">Statistics</div><div class="_part_title_rest_1lnsy_32"></div></div><div class="_dropdown_1lnsy_16"><a class="_chapter_title_1lnsy_32" href="5-estimation">Estimation</a><a class="_chapter_title_1lnsy_32" href="6-inference">Inference</a><a class="_chapter_title_1lnsy_32" href="7-models">Models</a></div></div><div class="_part_1lnsy_16"><div class="_part_title_1lnsy_24"><div class="_part_title_first_1lnsy_59">Design</div><div class="_part_title_rest_1lnsy_32"> and Planning</div></div><div class="_dropdown_1lnsy_16"><a class="_chapter_title_1lnsy_32" href="8-measurement">Measurement</a><a class="_chapter_title_1lnsy_32" href="9-design">Design of experiments</a><a class="_chapter_title_1lnsy_32" href="10-sampling">Sampling</a></div></div><div class="_part_1lnsy_16"><div class="_part_title_1lnsy_24"><div class="_part_title_first_1lnsy_59">Execution</div><div class="_part_title_rest_1lnsy_32"></div></div><div class="_dropdown_1lnsy_16"><a class="_chapter_title_1lnsy_32" href="11-prereg">Preregistration</a><a class="_chapter_title_1lnsy_32" href="12-collection">Data collection</a><a class="_chapter_title_1lnsy_32" href="13-management">Project management</a></div></div><div class="_part_1lnsy_16"><div class="_part_title_1lnsy_24"><div class="_part_title_first_1lnsy_59">Analysis</div><div class="_part_title_rest_1lnsy_32"> and Reporting</div></div><div class="_dropdown_1lnsy_16"><a class="_chapter_title_1lnsy_32" href="14-viz">Visualization</a><a class="_chapter_title_1lnsy_32" href="15-writing">Writing</a><a class="_chapter_title_1lnsy_32" href="16-meta">Meta-analysis</a><a class="_chapter_title_1lnsy_32" href="17-conclusions">Conclusions</a></div></div><div class="_part_1lnsy_16"><div class="_part_title_1lnsy_24"><div class="_part_title_first_1lnsy_59">Appendices</div><div class="_part_title_rest_1lnsy_32"></div></div><div class="_dropdown_1lnsy_16"><a class="_chapter_title_1lnsy_32" href="A-git">GitHub Tutorial</a><a class="_chapter_title_1lnsy_32" href="B-rmarkdown">R Markdown Tutorial</a><a class="_chapter_title_1lnsy_32" href="C-tidyverse">Tidyverse Tutorial</a><a class="_chapter_title_1lnsy_32" href="D-ggplot">ggplot Tutorial</a><a class="_chapter_title_1lnsy_32" href="E-instructors">Instructor’s guide</a></div></div></nav></header></div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="models" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Models</h1>
<div id="island_1"><div class="box learning_goals"><div class="Collapsible"><span id="collapsible-trigger-1655762497419" class="Collapsible__trigger is-closed" aria-expanded="false" aria-disabled="false" aria-controls="collapsible-content-1655762497419" role="button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="apple-whole" class="svg-inline--fa fa-apple-whole " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M336 128c-32 0-80.02 16.03-112 32.03c-32.01-16-79.1-32.02-111.1-32.03C32 128 .4134 210.5 .0033 288c-.5313 99.97 63.99 224 159.1 224c32 0 48-16 64-16c16 0 32 16 64 16c96 0 160.4-122.8 159.1-224C447.7 211.6 416 128 336 128zM320 32V0h-32C243.8 0 208 35.82 208 80v32h32C284.2 112 320 76.18 320 32z"></path></svg>Learning goals<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="angles-down" class="svg-inline--fa fa-angles-down " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M169.4 278.6C175.6 284.9 183.8 288 192 288s16.38-3.125 22.62-9.375l160-160c12.5-12.5 12.5-32.75 0-45.25s-32.75-12.5-45.25 0L192 210.8L54.63 73.38c-12.5-12.5-32.75-12.5-45.25 0s-12.5 32.75 0 45.25L169.4 278.6zM329.4 265.4L192 402.8L54.63 265.4c-12.5-12.5-32.75-12.5-45.25 0s-12.5 32.75 0 45.25l160 160C175.6 476.9 183.8 480 192 480s16.38-3.125 22.62-9.375l160-160c12.5-12.5 12.5-32.75 0-45.25S341.9 252.9 329.4 265.4z"></path></svg></span><div id="collapsible-content-1655762497419" class="Collapsible__contentOuter" style="height: 0px; -webkit-transition: height 300ms ease; ms-transition: height 300ms ease; transition: height 300ms ease; overflow: hidden;" role="region" aria-labelledby="collapsible-trigger-1655762497419"><div class="Collapsible__contentInner">
<ul>
<li>Re-conceptualize statistical “tests” as models of data</li>
<li>Build intuitions about how specific “tests” (e.g., t-tests) relate to more general frameworks (e.g., regression, mixed effects models)</li>
<li>Identify which models are best suited for which research questions</li>
<li>Describe what it means to ‘control for’ something</li>
<li>Explore what kinds of clustered variance are present in our designs</li>
<li>Select models appropriate for different kinds of dependent variables</li>
</ul>
</div></div></div></div></div>
<p>In the previous two chapters, we introduced concepts surrounding estimation of an experimental effect and inference about its relationship to the effect in the population. The tools we introduced are very general, but they are limited in their applicability. Once you get beyond the world of two-condition experiments in which each participant contributes one data point from a continuous measure, the simple <span class="math inline">\(t\)</span>-test is not sufficient.</p>
<p>In some statistics textbooks, the next step would be to present a whole host of other statistical tests that are designed for other special cases. We could even show a decision-tree: what if you have repeated measures? Or categorical data? Or three conditions? But this isn’t a statistics book, and even if it were, we don’t advocate that approach. The idea of finding a specific narrowly-tailored test for your situation is part and parcel of the dichotomous NHST approach that we tried to talk you out of in the last chapter. If all you want is your <span class="math inline">\(p&lt;.05\)</span>, then it makes sense to look up the test that can allow you to compute a <span class="math inline">\(p\)</span> value in your specific case. But we prefer an approach that is more focused on getting a good estimate of the magnitude of the causal effect – and the relation of that estimate to the population mean.</p>
<p>In this chapter, we begin to explore how to to go about making these estimates and making inference about them – and that brings us to the world of <strong>statistical models</strong>. A statistical model is a way of writing down a set of assumptions about how particular data are generated. Statistical models are the bread and butter tools for estimating particular <strong>parameters</strong> of interest – like the magnitude of a causal effect associated with an experimental manipulation – and making inferences about their relationship to the population parameter.</p>
<p>For example, a simple statistical model might assume that observed datapoints are generated via with the flip of a weighted coin. Then the process of estimation is to assess the most likely weight of the coin given the data. This model can then be used to make inferences about whether the coin’s weight differs from some null model (a fair coin, perhaps).</p>
<p>This example sounds a lot like the kinds of simple inferential tests we talked about in the previous chapter; not very “model-y.” But things get more interesting when there are multiple parameters to be estimated, as in many real-world experiments. In the tea-tasting scenario we’ve belabored over the past two chapters, a real experiment might involve multiple people tasting different types of tea in different orders, all with some cups randomly assigned to be milk-first or tea-first. What we’ll learn to do in this chapter is to make a model of this situation that allows us to reason about the magnitude of the milk-order effect while also estimating variation due to different people, orders, and tea types.</p>
<p>We’ll begin by discussing the ubiquitous framework for building statistical models, <strong>linear regression</strong>, building up connections between regression and the <span class="math inline">\(t\)</span>-test. This section will discuss how to add covariates to regression models, and when linear regression does and doesn’t work. In the next section, we’ll discuss the <strong>generalized linear model</strong>, an innovation that allows us to make models of a broader range of data types. We’ll then briefly introduce <strong>mixed models</strong>, which allow us to model clustering in our datasets (such as clusters of observations from a single individual or single stimulus item). We’ll end with some opinionated practical advice on model building.</p>
<div id="island_2"><div class="box case_study"><div class="Collapsible"><span id="collapsible-trigger-1655762497420" class="Collapsible__trigger is-closed" aria-expanded="false" aria-disabled="false" aria-controls="collapsible-content-1655762497420" role="button"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="microscope" class="svg-inline--fa fa-microscope " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M160 320h12v16c0 8.875 7.125 16 16 16h40c8.875 0 16-7.125 16-16V320H256c17.62 0 32-14.38 32-32V64c0-17.62-14.38-32-32-32V16C256 7.125 248.9 0 240 0h-64C167.1 0 160 7.125 160 16V32C142.4 32 128 46.38 128 64v224C128 305.6 142.4 320 160 320zM464 448h-1.25C493.2 414 512 369.2 512 320c0-105.9-86.13-192-192-192v64c70.63 0 128 57.38 128 128s-57.38 128-128 128H48C21.5 448 0 469.5 0 496C0 504.9 7.125 512 16 512h480c8.875 0 16-7.125 16-16C512 469.5 490.5 448 464 448zM104 416h208c4.375 0 8-3.625 8-8v-16c0-4.375-3.625-8-8-8h-208C99.63 384 96 387.6 96 392v16C96 412.4 99.63 416 104 416z"></path></svg>Case study<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="angles-down" class="svg-inline--fa fa-angles-down " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M169.4 278.6C175.6 284.9 183.8 288 192 288s16.38-3.125 22.62-9.375l160-160c12.5-12.5 12.5-32.75 0-45.25s-32.75-12.5-45.25 0L192 210.8L54.63 73.38c-12.5-12.5-32.75-12.5-45.25 0s-12.5 32.75 0 45.25L169.4 278.6zM329.4 265.4L192 402.8L54.63 265.4c-12.5-12.5-32.75-12.5-45.25 0s-12.5 32.75 0 45.25l160 160C175.6 476.9 183.8 480 192 480s16.38-3.125 22.62-9.375l160-160c12.5-12.5 12.5-32.75 0-45.25S341.9 252.9 329.4 265.4z"></path></svg></span><div id="collapsible-content-1655762497420" class="Collapsible__contentOuter" style="height: 0px; -webkit-transition: height 300ms ease; ms-transition: height 300ms ease; transition: height 300ms ease; overflow: hidden;" role="region" aria-labelledby="collapsible-trigger-1655762497420"><div class="Collapsible__contentInner"><p class="title">Stimulus-specific effects</p>

<p>Imagine you’re a psycholinguist who has the hypothesis that nouns are processed faster than verbs. You run an experiment where you pick out ten verbs and ten nouns, then measure a large sample of participants’ reading time for each of these. You find strong evidence for the predicted effect and publish a paper on your claim. The only problem is that, at the same time, someone else has done exactly the same study – with different nouns and verbs – and published a paper making the opposite claim. The problem in this example is that each effect is driven by the specific experimental items that were chosen <span class="citation">(<a href="#ref-clark1973" role="doc-biblioref">Clark, 1973</a>)</span>. Out of hundreds of thousands of possible words, why these in particular?</p>
<p>The problem of generalization from sample to population is not new – as we discussed in Chapter <a href="6-inference.html#inference">6</a>, we are constantly doing this kind of inference with the samples of people that participate in our experiments. Our classic statistical techniques are designed to generalize from sample to population and we are typically sensitive to the weakness of generalizations made from very small samples of experimental participants. Not so with stimuli.<label for="tufte-sn-92" class="margin-toggle sidenote-number">92</label><input type="checkbox" id="tufte-sn-92" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">92</span> <span class="citation">Clark (<a href="#ref-clark1973" role="doc-biblioref">1973</a>)</span>, from whom this example is adapted, calls this the “language-as-fixed-effect” fallacy. This is a great label for folks who already know about fixed vs. random effects, but it doesn’t highlight how it connects to the broader set of issues of generalizability that we highlight here and in Chapter <a href="10-sampling.html#sampling">10</a>, so we’ll mostly use the label “stimulus generalizability.”</span></p>
<p>Stimulus generalizability problems have reared their head across a surprising range of different areas of psychology. In one example, hundreds of papers were written about a phenomenon called the “risky shift” – in which groups deliberating about a decision would produce riskier decisions than individuals. Unfortunately, this phenomenon appeared to be completely driven by the specific choice of vignettes that groups deliberated about, with some producing a risky shift and others producing a more conservative shift <span class="citation">(<a href="#ref-westfall2015" role="doc-biblioref">Westfall et al., 2015</a>)</span>.</p>
<p>Another example comes from the memory literature, where a classic paper by <span class="citation">Baddeley et al. (<a href="#ref-baddeley1975" role="doc-biblioref">1975</a>)</span> suggested that words that take longer to pronounce (“tycoon” or “morphine”) would be remembered worse than words that took a shorter amount of time (“ember” or “wicket”) even when they had the same number of syllables. This effect also appears to be driven by the specific sets of words chosen in the original paper; the effect is robustly replicable with that set but not generalizable across other sets <span class="citation">(<a href="#ref-lovatt2000" role="doc-biblioref">Lovatt et al., 2000</a>)</span>.</p>
<p>The implication of these examples is clear: experimenters need to take care in both their experimental design and analysis to avoid overgeneralizing from their stimuli to a broader construct. Three primary steps can help experimenters avoid this pitfall:</p>
<ol style="list-style-type: decimal;">
<li>To maximize generality, use samples of experimental items – words, pictures, or vignettes – that are comparable in size to your samples of participants.</li>
<li>When replicating an experiment, consider taking a new sample of items as well as a new sample of participants.</li>
<li>When experimental items are sampled random from a broader population, use a statistical model – such as the ones described below – that includes this sampling process.</li>
</ol>
</div></div></div></div></div>
<div id="regression-models" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Regression models</h2>
<p>There are many types of statistical models, but this chapter will focus primarily on regression, a broad and extremely powerful class of models. A regression model relates a dependent variable to one or more independent variables. Dependent variables are sometimes called <strong>outcome variables</strong>, and independent variables are sometimes called <strong>predictor variables</strong>, <strong>covariates</strong>, or <strong>features</strong>. We will see that many common statistical estimators (like the sample mean) and methods of inference (like the <span class="math inline">\(t\)</span>-test) are actually simple regression models. Understanding this point will help you see many statistical methods as special cases of the same underlying framework, rather than as unrelated, ad hoc methods.</p>
<div id="regression-for-estimating-a-simple-treatment-effect" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Regression for estimating a simple treatment effect</h3>


<p>Let’s start with one of these special cases, namely estimating a treatment effect, <span class="math inline">\(\beta\)</span>, in a two-group design. In Chapter <a href="5-estimation.html#estimation">5</a>, we solved this exact challenge for the tea-tasting experiment. We posited a model in which the milk-first ratings were normally distributed with mean <span class="math inline">\(\theta_{\text{milk-first}} = \theta_{\text{tea-first}} + \beta\)</span> and with standard deviation <span class="math inline">\(\sigma_{\text{milk-first}}\)</span>.<label for="tufte-sn-93" class="margin-toggle sidenote-number">93</label><input type="checkbox" id="tufte-sn-93" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">93</span> Here’s a quick reminder that “model” here is a way of saying “set of assumptions about the data generating procedure.” So saying that some equation is a “model” is the same as saying, we think this is where the data came from. We can “turn the crank” – generate data through the process that’s specified in those equations, e.g., pulling numbers from a normal distribution with mean <span class="math inline">\(\theta_{\text{milk-first}}\)</span> and standard deviation <span class="math inline">\(\sigma_{\text{milk-first}}\)</span>. In essence, we’re committing to the idea that this process will give us data that are substantively similar to the ones we have already.</span></p>
<p>Let’s now write that model as a regression model, that is, as a model relating each participant’s tea rating, <span class="math inline">\(Y_i\)</span>, given that participant’s treatment assignment, <span class="math inline">\(X_i\)</span>. <span class="math inline">\(X_i=0\)</span> represents the control (milk-first) group and <span class="math inline">\(X_i=1\)</span> represents the treatment (tea-first) group. Here, <span class="math inline">\(Y_i\)</span> is the dependent variable, and <span class="math inline">\(X_i\)</span> is the independent variable. <span class="math inline">\(i\)</span>s are an index variable for each of the participants. To make this concrete, you can see some sample tea-tasting data (N=24 for simplicity) below, with the index <span class="math inline">\(i\)</span>, the condition and its predictor <span class="math inline">\(X_i\)</span>, and the rating <span class="math inline">\(Y\)</span>.</p>
<p><span class="marginnote shownote"><span id="tab:models-datatable">Table 7.1: </span>Example tea tasting data in a regression format.</span></p>
<table class="table" style="width: auto !important;"><thead><tr><th style="text-align: right;">
i
</th><th style="text-align: left;">
condition
</th><th style="text-align: right;">
X
</th><th style="text-align: right;">
rating (Y)
</th></tr></thead><tbody><tr><td style="text-align: right;">
1
</td><td style="text-align: left;">
milk first
</td><td style="text-align: right;">
0
</td><td style="text-align: right;">
6
</td></tr><tr><td style="text-align: right;">
2
</td><td style="text-align: left;">
milk first
</td><td style="text-align: right;">
0
</td><td style="text-align: right;">
4
</td></tr><tr><td style="text-align: right;">
3
</td><td style="text-align: left;">
milk first
</td><td style="text-align: right;">
0
</td><td style="text-align: right;">
5
</td></tr><tr><td style="text-align: right;">
4
</td><td style="text-align: left;">
milk first
</td><td style="text-align: right;">
0
</td><td style="text-align: right;">
5
</td></tr><tr><td style="text-align: right;">
5
</td><td style="text-align: left;">
milk first
</td><td style="text-align: right;">
0
</td><td style="text-align: right;">
5
</td></tr><tr><td style="text-align: right;">
6
</td><td style="text-align: left;">
milk first
</td><td style="text-align: right;">
0
</td><td style="text-align: right;">
4
</td></tr><tr><td style="text-align: right;">
7
</td><td style="text-align: left;">
milk first
</td><td style="text-align: right;">
0
</td><td style="text-align: right;">
6
</td></tr><tr><td style="text-align: right;">
8
</td><td style="text-align: left;">
milk first
</td><td style="text-align: right;">
0
</td><td style="text-align: right;">
4
</td></tr><tr><td style="text-align: right;">
9
</td><td style="text-align: left;">
milk first
</td><td style="text-align: right;">
0
</td><td style="text-align: right;">
7
</td></tr><tr><td style="text-align: right;">
10
</td><td style="text-align: left;">
milk first
</td><td style="text-align: right;">
0
</td><td style="text-align: right;">
4
</td></tr><tr><td style="text-align: right;">
11
</td><td style="text-align: left;">
milk first
</td><td style="text-align: right;">
0
</td><td style="text-align: right;">
6
</td></tr><tr><td style="text-align: right;">
12
</td><td style="text-align: left;">
milk first
</td><td style="text-align: right;">
0
</td><td style="text-align: right;">
7
</td></tr><tr><td style="text-align: right;">
13
</td><td style="text-align: left;">
tea first
</td><td style="text-align: right;">
1
</td><td style="text-align: right;">
2
</td></tr><tr><td style="text-align: right;">
14
</td><td style="text-align: left;">
tea first
</td><td style="text-align: right;">
1
</td><td style="text-align: right;">
3
</td></tr><tr><td style="text-align: right;">
15
</td><td style="text-align: left;">
tea first
</td><td style="text-align: right;">
1
</td><td style="text-align: right;">
3
</td></tr><tr><td style="text-align: right;">
16
</td><td style="text-align: left;">
tea first
</td><td style="text-align: right;">
1
</td><td style="text-align: right;">
4
</td></tr><tr><td style="text-align: right;">
17
</td><td style="text-align: left;">
tea first
</td><td style="text-align: right;">
1
</td><td style="text-align: right;">
3
</td></tr><tr><td style="text-align: right;">
18
</td><td style="text-align: left;">
tea first
</td><td style="text-align: right;">
1
</td><td style="text-align: right;">
1
</td></tr><tr><td style="text-align: right;">
19
</td><td style="text-align: left;">
tea first
</td><td style="text-align: right;">
1
</td><td style="text-align: right;">
1
</td></tr><tr><td style="text-align: right;">
20
</td><td style="text-align: left;">
tea first
</td><td style="text-align: right;">
1
</td><td style="text-align: right;">
5
</td></tr><tr><td style="text-align: right;">
21
</td><td style="text-align: left;">
tea first
</td><td style="text-align: right;">
1
</td><td style="text-align: right;">
3
</td></tr><tr><td style="text-align: right;">
22
</td><td style="text-align: left;">
tea first
</td><td style="text-align: right;">
1
</td><td style="text-align: right;">
1
</td></tr><tr><td style="text-align: right;">
23
</td><td style="text-align: left;">
tea first
</td><td style="text-align: right;">
1
</td><td style="text-align: right;">
3
</td></tr><tr><td style="text-align: right;">
24
</td><td style="text-align: left;">
tea first
</td><td style="text-align: right;">
1
</td><td style="text-align: right;">
5
</td></tr></tbody></table>
<p>Here’s the model:</p>


<p><span class="math display">\[\begin{align}
\label{eq:ols_ttest}
Y_i &amp;= \theta_{\text{milk-first}} + \beta_{\text{tea-first}} X_i + \epsilon_i \\
\end{align}\]</span></p>
<p>A model like this is called a <strong>linear regression of Y on X</strong>. <span class="math inline">\(\theta_{\text{milk-first}} + \beta X_i\)</span> is called the <strong>linear predictor</strong>, and it describes the expected value of an individual’s tea rating, <span class="math inline">\(Y_i\)</span>, given that participant’s treatment group <span class="math inline">\(X_i\)</span> (the single independent variable in this model). That is, for a participant in the control group (<span class="math inline">\(X_i=0\)</span>), the linear predictor is just equal to <span class="math inline">\(\theta_{\text{milk-first}}\)</span>, which is indeed the mean for the control group that we specified above. On the other hand, for a participant in the treatment group, the linear predictor is equal to <span class="math inline">\(\theta_{\text{milk-first}} + \beta\)</span>, which is the mean for the treatment group that we specified. In regression jargon, <span class="math inline">\(\beta\)</span> is a <strong>regression coefficient</strong>, representing the association of the independent variable <span class="math inline">\(X_i\)</span> with the outcome <span class="math inline">\(Y_i\)</span>.</p>
<p>The term <span class="math inline">\(\epsilon_i\)</span> is the <strong>error term</strong>, referring to random variation of participants’ ratings around the group mean.<label for="tufte-sn-94" class="margin-toggle sidenote-number">94</label><input type="checkbox" id="tufte-sn-94" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">94</span> Formally, we’d write <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span>. The tilde means “is distributed as”, and what follows is a normal distribution with mean 0 and variance <span class="math inline">\(\sigma^2\)</span>.</span> Note that this is a very specific kind of “error”; it not to “error” due to bias, for example. Instead, you can think of the error terms as capturing the “error” that would be associated with predicting any given participant’s rating based on just the linear predictor. If you predicted a control group participant’s rating as <span class="math inline">\(\theta_{\text{milk-first}}\)</span>, that would be a good guess – but you still expect the participant’s rating to deviate somewhat from <span class="math inline">\(\theta_{\text{milk-first}}\)</span> due to “error”. In our regression model, the linear predictor and error terms together say that participants’ ratings scatter randomly (in fact, normally) around their group means with standard deviation <span class="math inline">\(\sigma\)</span>. And that is exactly the model we posited in Chapter <a href="5-estimation.html#estimation">5</a>.
</p>
<div class="figure"><span style="display: block;" id="fig:models-ols-plot"></span>
<p class="caption marginnote shownote">
Figure 7.1: (left) Best-fitting regression coefficients for the tea-tasting experiment. (right) Much worse coefficients for the same data.
</p>
<img src="experimentology_files/figure-html/models-ols-plot-1.png" alt="(left) Best-fitting regression coefficients for the tea-tasting experiment. (right) Much worse coefficients for the same data." width="\linewidth" />
</div>
<p>Now we have the model. How do we estimate the regression coefficients <span class="math inline">\(\theta_{\text{milk-first}}\)</span> and <span class="math inline">\(\beta\)</span>? The usual method is called <strong>ordinary least squares (OLS)</strong>. Here’s the basic idea. For any given regression coefficient estimates <span class="math inline">\(\widehat{\theta}_{\text{milk-first}}\)</span> and <span class="math inline">\(\widehat{\beta}\)</span>, we would obtain different <strong>predicted values</strong>, <span class="math inline">\(\widehat{Y}_i = \theta_{\text{milk-first}} + \beta X_i\)</span> for each participant. Some regression coefficient estimates will yield better predictions than others. OLS estimation is designed to find the values of the regression coefficients that optimize these predictions, meaning that the predictions are as close as possible to participants’ true outcomes, <span class="math inline">\(Y_i\)</span>.<label for="tufte-sn-95" class="margin-toggle sidenote-number">95</label><input type="checkbox" id="tufte-sn-95" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">95</span> Specifically, OLS minimizes squared error loss, in the sense that it will choose the regression coefficient estimates whose predictions minimize <span class="math inline">\(\sum_{i=1}^n \left( Y_i - \widehat{Y}_i\right)^2\)</span>, where <span class="math inline">\(n\)</span> is the sample size. A wonderful thing about OLS is that those optimal regression coefficients (generically termed <span class="math inline">\(\widehat{\mathbf{\beta}}\)</span>) turn out to have a very simple closed form: <span class="math inline">\(\widehat{\mathbf{\beta}} = \left( \mathbf{X}'\mathbf{X} \right)^{-1} \mathbf{X}'\mathbf{y}\)</span>. We are using more general notation here because there could be multiple independent variables. Therefore, <span class="math inline">\(\widehat{\mathbf{\beta}}\)</span> is a vector, <span class="math inline">\(\mathbf{X}\)</span> is a matrix of independent variables for each subject, and <span class="math inline">\(\mathbf{y}\)</span> is a vector of participants’ outcomes. As more good news, the standard error for <span class="math inline">\(\widehat{\mathbf{\beta}}\)</span> has a similarly simple closed form.</span></p>
<p>Figure <a href="7-models.html#fig:models-ols-plot">7.1</a> gives a graphical illustration of the tea tasting data for each condition (the dots) along with the model predictions for each condition <span class="math inline">\(\theta_{\text{milk-first}}\)</span> and <span class="math inline">\(\theta_{\text{milk-first}} + \beta\)</span> (blue lines). The distance of each point to the predictions (the thing that OLS wants to minimize) is shown by the dotted lines. Another name for these errors is <strong>residuals</strong>: they are the “residual variation” that is not predicted by the model.</p>
<p>The left-hand plot shows the best coefficient values – the ones that move the model as close as possible to each point, minimizing the total squared length of the dashed lines. The right-hand plot shows a substantially worse solution. The amazing thing about OLS is that it is a simple way to find the best solution for a wide range of useful models.</p>
<p>You’ll notice that we aren’t talking much about <span class="math inline">\(p\)</span>-values in this chapter. Regression models can be used to produce <span class="math inline">\(p\)</span>-values on specific coefficients, representing inferences about the likelihood of a particular coefficient magnitude relative to some null hypothesis. You can also compute Bayes Factors on specific regression coefficients, or use Bayesian inference to fit these coefficients under some prior expectation about their distribution. We won’t talk much about this, or more generally how to fit the models we describe. As we said, we’re not going to give a full treatment of all the relevant statistical topics. Instead we want to help you begin thinking about making models of your data.</p>
</div>
<div id="adding-predictors" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Adding predictors</h3>
<p>The regression model we just wrote down is the same thing as the <span class="math inline">\(t\)</span>-test from Chapter <a href="6-inference.html#inference">6</a>. But the beauty of regression modeling is that much more complex estimation problems can also be written as regression models, essentially by extending the model we made above. For example, we might want to add another predictor variable, such as the age of the participant.<label for="tufte-sn-96" class="margin-toggle sidenote-number">96</label><input type="checkbox" id="tufte-sn-96" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">96</span> The ability to estimate multiple coefficients at once is a huge strength of regression modeling, so much so that sometimes people use the label <strong>multiple regression</strong> to denote that there is more than one predictor + coefficient pair.</span></p>
<p>Let’s add this new independent variable and a corresponding regression coefficient to our model:</p>
<p><span class="math display">\[\begin{align}
\label{eq:ols_one_covariate}
Y_i &amp;= \theta_{\text{milk-first}} + \beta_{\text{tea-first}} X_{i1} + \theta_{\text{age}} X_{i2}  + \epsilon_i \\
\end{align}\]</span>

</p>
<p>Now that we have multiple independent variables, we’ve labeled them <span class="math inline">\(X_{group}\)</span> (treatment group) and <span class="math inline">\(X_{age}\)</span> for clarity.</p>
<p>To illustrate how to interpret the regression coefficients in this model, let’s use the linear predictor to compare the model’s predicted tea ratings for two hypothetical participants who are both in the treatment group: 20-year-old Alice and 21-year old Bob. Alice’s linear predictor tells us that her expected rating is <span class="math inline">\(\theta_{\text{milk-first}} + \beta_{\text{tea-first}} + \theta_{\text{age}} \cdot 20\)</span>. In contrast, Bob’s linear predictor is <span class="math inline">\(\theta_{\text{milk-first}} + \beta_{\text{tea-first}} + \theta_{\text{age}} \cdot 21\)</span>. We could therefore calculate the expected difference in ratings for 21-year-olds versus 20-year olds by subtracting Alice’s linear predictor from Bob’s, yielding just <span class="math inline">\(\theta_{\text{age}}\)</span>. How simple!</p>
<p>We would get the same result if Alice and Bob were instead 50 and 51 years old, respectively. This equivalence illustrates a key point about linear regression models in general: <em>the regression coefficient represents the expected difference in outcome when comparing participants who differ by 1 unit of the independent variable</em> (here, comparing participants who differ by 1 year of age). In “Practical modeling considerations” below, we discuss whether and when to “control for” additional variables (i.e., when to add them to your model).</p>
</div>
<div id="when-does-linear-regression-work" class="section level3" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> When does linear regression work?</h3>
<p>Linear regression modeling with OLS is an incredibly powerful technique for creating models to estimate the influence of multiple predictors on a single dependent variable. In fact, OLS is in a mathematical sense the <em>best</em> way to fit a linear model!<label for="tufte-sn-97" class="margin-toggle sidenote-number">97</label><input type="checkbox" id="tufte-sn-97" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">97</span> There is a precise sense in which OLS gives the <em>very best</em> predictions we could ever get from any model that posits linear relationships between the independent variables and the outcome. That is, you can come up with any other linear model you want, and yet if the assumptions of OLS are fulfilled, predictions from OLS will always be less noisy than those of your model. This is because of an elegant mathematical result called the Gauss-Markov Theorem.</span> But OLS only “works” – in the sense of yielding good estimates – if three big conditions are met.</p>
<ol style="list-style-type: decimal;">
<li><strong>The predictor relationships being modeled must be linear.</strong> In our comparison of Alice’s and Bob’s expected outcomes based on their 1-year age difference, we were able to interpret the coefficient <span class="math inline">\(\theta_{\text{age}}\)</span> as the average difference in <span class="math inline">\(Y_i\)</span> when comparing participants who differ by 1 year of age, <em>regardless</em> of whether those ages are 20 vs. 21 or 50 vs. 51. But that’s not always true: plenty of things vary <strong>non-linearly</strong> with age – for example, imagine growth in height over age! Linear regression will give bad answers in such cases.<label for="tufte-sn-98" class="margin-toggle sidenote-number">98</label><input type="checkbox" id="tufte-sn-98" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">98</span> One way to accommodate <strong>non-linearities</strong> is to modify the linear predictor to include polynomial terms, such as <span class="math inline">\(\text{age}^2\)</span>, which then allow us to fit a curve rather than just a straight line. It is always a good idea to use visualizations like scatter plots to look for possible problems with linearity.</span></li>
</ol>

<ol start="2" style="list-style-type: decimal;">
<li><strong>Errors must be independent.</strong> In our example, observations in the regression model (i.e., rows in the dataset) were sampled independently: each participant was recruited independently to the study and each performed a single trial. On the other hand, suppose we have repeated-measures data in which we sample participants, and then obtained multiple measurements for each participant. Within each participant, measurements would likely be correlated (perhaps due to their general level of tea enjoyment). This correlation invalidates inferences from a model that does not include it. We’ll discuss this problem in detail below.</li>
</ol>



<ol start="3" style="list-style-type: decimal;">
<li><strong>Errors must be normal and unrelated to the predictor.</strong> Imagine older people have very strong tea-ordering preferences while younger people do not. In that case, the models’ error term would be more variable for older participants than younger ones. This issue is called <strong>heteroskedasticity</strong>. It is a good idea to plot each independent variable versus the residuals to see if the residuals are more variable for certain values of the independent variable than for others.</li>
</ol>
<p></p>

<p>If any of these three conditions are violated, estimates and inferences from your model may be suspect.</p>
</div>
</div>
<div id="generalized-linear-models" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Generalized linear models</h2>
<p>So far we have considered continuous outcome measures, like tea ratings. What if we instead had a binary outcome, such as whether a participant liked or didn’t like the tea, or a count outcome, such as the number of cups a participant chose to drink? These and other non-continuous outcomes often violate the assumptions of OLS, in particular because they often induce heteroskedastic errors.</p>
<p>Binary outcomes inherently violate heteroskedasticity because the variance of a binary variable depends directly on the success probability. Errors will be more variable when the expected success probability closer to 0.50, and much less variable for when the expected success is probability is closer to 0 or 1.<label for="tufte-sn-99" class="margin-toggle sidenote-number">99</label><input type="checkbox" id="tufte-sn-99" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">99</span> Specifically, the variance of a binary variable with success probability <span class="math inline">\(p\)</span> is simply <span class="math inline">\(p(1-p)\)</span>, which is maximized at <span class="math inline">\(p=0.50\)</span>.</span> This heteroskedasticity in turn means that inferences from the model (e.g., <span class="math inline">\(p\)</span>-values) can be incorrect; sometimes just a little bit off but sometimes dramatically incorrect.<label for="tufte-sn-100" class="margin-toggle sidenote-number">100</label><input type="checkbox" id="tufte-sn-100" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">100</span> There’s a whole school of thought in economics that claims that it’s OK to use linear regression for binary outcomes. One commentator described this as “wrong but super useful” because the coefficients are simple to interpret as probabilities. Our position is that the linear probability model is an approximation that can be useful but should only be deployed with care by researchers who have given some thought to its weaknesses.</span></p>
<p>Happily, <strong>generalized linear models</strong> (GLM) are regression models closely related to OLS that can handle non-continuous outcomes. These models are called “generalized” because OLS is one of many members of this large class of models. To see the connection, let’s first write an OLS model more generally in terms of what it says about the expected value of the outcome, which we notate as <span class="math inline">\(E[Y_i]\)</span>:</p>
<p><span class="math display">\[\begin{align}
\label{eq:ols_general_form}
E[Y_i] &amp;= \beta_0 + \sum_{j=1}^p \beta_j X_j
\end{align}\]</span>
where <span class="math inline">\(p\)</span> is the number of independent variables, <span class="math inline">\(\beta_0\)</span> is the intercept, and <span class="math inline">\(\beta_j\)</span> is the regression coefficient for the <span class="math inline">\(j^{th}\)</span> independent variable. This equation is just a math-y way of saying that you predict from a regression model by adding up each of the predictors independently.</p>
<p>The linear predictor of a GLM (i.e., <span class="math inline">\(\beta_0 + \sum_{j=1}^p \beta_j X_j\)</span>) looks exactly the same as for OLS, but instead of modeling <span class="math inline">\(E[Y_i]\)</span>, a GLM models some <strong>transformation</strong>, <span class="math inline">\(g(.)\)</span>, of the expectation:</p>
<p><span class="math display">\[\begin{align}
\label{eq:glm_general_form}
g( E[Y_i] ) &amp;= \beta_0 + \sum_{j=1}^p \beta_j X_j 
\end{align}\]</span></p>
<p>GLMs involve transforming the <em>expectation</em> of the outcome, not the outcome itself! That is, we are not just taking the outcome variable in our dataset and transforming it before fitting an OLS model, but rather we are fitting a different model entirely, one that posits a fundamentally different relationship between the predictors and the expected outcomes. This transformation is called the <strong>link function</strong>. In other words, to fit different kinds of outcomes, all we need to do is construct a standard linear model and then just transform its output via the appropriate link function.</p>
<p>Perhaps the most common link function is the <strong>logit</strong> link, which is suitable for binary data. This link function looks like this:</p>
<p><span class="math display">\[g(x) = \log \left( \frac{x}{1 - x} \right)\]</span></p>
<p>The resulting model is called <strong>logistic regression</strong>. The term <span class="math inline">\(\frac{x}{1 - x}\)</span> is called an <strong>odds</strong> and represents the probability of an event occurring divided by the probability of its not occurring. Exponentiating the coefficients would yield <strong>odds ratios</strong>, which are the <em>multiplicative</em> increase in the odds of <span class="math inline">\(Y_i=1\)</span> that is associated with a one-unit increase in the relevant predictor variable.</p>
<p>
<span class="marginnote shownote">
<span style="display: block;" id="fig:models-logistic-ex"></span>
<img src="experimentology_files/figure-html/models-logistic-ex-1.png" alt="An example of how logistic regression transforms a change in the predictor x into a change in the outcome y. The same change results in a large difference in outcome in the middle of the logistic curve (blue) vs. a small outcome at the top (red) or bottom." width="\linewidth" />
Figure 7.2: An example of how logistic regression transforms a change in the predictor x into a change in the outcome y. The same change results in a large difference in outcome in the middle of the logistic curve (blue) vs. a small outcome at the top (red) or bottom.
</span>
</p>
<p>Figure <a href="7-models.html#fig:models-logistic-ex">7.2</a> shows the way that a logistic regression model transforms a predictor (<span class="math inline">\(x\)</span>) into an outcome probability that is bounded at 0 and 1. Critically, although the predictor is still linear, the logit link means that the same change in <span class="math inline">\(x\)</span> can result in a different change in <span class="math inline">\(y\)</span> depending on where you are on the <span class="math inline">\(x\)</span> scale. In this example, if you are in the middle of the predictor range, a one unit change in <span class="math inline">\(x\)</span> results in a 0.24 change in probability (blue). At a higher value, the change is much smaller (0.02). Notice how this is different from the linear regression model above, where the same change in age always resulted in the same change in preference!</p>
<p>We have only scratched the surface of GLMs here. First, there are many different link functions that are suitable for different outcome types. And second, GLMs differ from OLS not only in their link functions, but also in how they handle the error terms. Our broader goal in this chapter is to show you how regression models are <em>models of data</em>. In that context, GLMs use link functions as a way to make models that generate many different times types of outcome data.<label for="tufte-sn-101" class="margin-toggle sidenote-number">101</label><input type="checkbox" id="tufte-sn-101" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">101</span> We sometimes think of linear models as a set of tinker toys you can snap together to stack up a set of predictors. In that context, link functions are an extra “attachment” that you can snap onto your linear model to make it generate a different response type.</span></p>
</div>
<div id="accommodating-clustering-in-our-models" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Accommodating clustering in our models</h2>
<p><span class="marginnote shownote"><span id="tab:models-crossed-rm">Table 7.2: </span>Outcome data <span class="math inline">\(y\)</span> with indices indicating both participant and stimulus.</span></p>
<table><thead><tr><th style="text-align: left;">
</th><th style="text-align: left;">
Stimulus1
</th><th style="text-align: left;">
Stimulus2
</th><th style="text-align: left;">
Stimulus3
</th></tr></thead><tbody><tr><td style="text-align: left;">
Participant1
</td><td style="text-align: left;">
y<sub>1,1</sub>
</td><td style="text-align: left;">
y<sub>1,2</sub>
</td><td style="text-align: left;">
y<sub>1,3</sub>
</td></tr><tr><td style="text-align: left;">
Participant2
</td><td style="text-align: left;">
y<sub>2,1</sub>
</td><td style="text-align: left;">
y<sub>2,2</sub>
</td><td style="text-align: left;">
y<sub>2,3</sub>
</td></tr><tr><td style="text-align: left;">
Participant3
</td><td style="text-align: left;">
y<sub>3,1</sub>
</td><td style="text-align: left;">
y<sub>3,2</sub>
</td><td style="text-align: left;">
y<sub>3,3</sub>
</td></tr></tbody></table>
<p>Experimental data often contain multiple measurements for each participant (so-called <strong>repeated measures</strong>). In addition, as we discussed in our case study, these measurements are often based on a sample of stimulus items (which then each have multiple measures as well). Table <a href="7-models.html#tab:models-crossed-rm">7.2</a> gives an example of what the outcome data <span class="math inline">\(y\)</span> might look like in this case. This clustering is problematic for OLS models, because the error terms for each datapoint are not independent.</p>
<p>Non-independence of datapoints may seem at first glance like a small issue, but it present a deep problem for making inferences. Take the tea-tasting data we looked at above, where we had 24 observations in each condition. If we fit an OLS model, we observe a highly significant tea-first effect. Here are the inferential statistics for that coefficient: <span class="math inline">\(t(22) = -4.63\)</span>, <span class="math inline">\(p &lt; .001\)</span>. Based on what we talked about in the previous chapter, it seems like we’d be licensed in rejecting the null hypothesis that this effect is due to sampling variation and interpret this instead as evidence for a generalizable difference in tea preference in our sampled population.</p>
<p>But suppose we told you that all of those 48 total observations (24 in each condition) were from one individual named George. That would change the picture considerably. Now we’d have no idea whether the big effect we observed reflected a difference in the population, but we would have a very good sense of what George’s preference is!<label for="tufte-sn-102" class="margin-toggle sidenote-number">102</label><input type="checkbox" id="tufte-sn-102" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">102</span> We discuss the strengths and weaknesses of repeated-measures designs like this in Chapter <a href="9-design.html#design">9</a> and the statistical tradeoffs of having many people with a small number of observations vs. a small number of people with many observations in Chapter <a href="10-sampling.html#sampling">10</a>.</span> Our OLS model would be wrong now because all of the error terms would be highly correlated – they would all reflect George’s preferences.</p>
</div>
<div id="linear-mixed-effects-models" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Linear mixed effects models</h2>
<p>How can we make models that deal with clustered data? There are a number of widely-used approaches for solving this problem including <strong>linear mixed effects models</strong>, <strong>generalized estimating equations</strong>, and <strong>clustered standard errors</strong> (often used in economics). Here we will illustrate how the problem gets solved in linear mixed models, which are an extension of OLS models that are fast becoming a standard in many areas of psychology <span class="citation">(<a href="#ref-bates2014" role="doc-biblioref">Bates et al., 2014</a>)</span>.</p>
</div>
<div id="modeling-random-variation-in-clusters" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Modeling random variation in clusters</h2>
<p>In linear mixed effects models, we modify the linear predictor itself to model differences across clusters. Instead of just measuring George’s preferences, suppose we modified the original tea-tasting experiment (without the age covariate) to collect ten ratings from each participant: five milk-first and five tea-first. We define the model the same way as we did before, with some minor differences:</p>
<p><span class="math display">\[
Y_{it} = \theta_{milkfirst} + \beta_{teafirst} X_{it} + \gamma_i + \epsilon_{it} 
\]</span></p>
<p>where <span class="math inline">\(Y_{it}\)</span> is participant <span class="math inline">\(i\)</span>’s rating in trial <span class="math inline">\(t\)</span> and <span class="math inline">\(X_{it}\)</span> is the participant’s assigned treatment in trial <span class="math inline">\(t\)</span> (i.e., milk-first or tea-first).</p>
<p>If you compare this equation to the OLS equation above, you will notice that we added two things. First, we’ve added subscripts for trials that distinguish trials from participants. But the big one is that we added <span class="math inline">\(\gamma_i\)</span>, a separate intercept value for each participant. We call this a <strong>random intercept</strong> because it varies across participants (who are randomly selected from the population).<label for="tufte-sn-103" class="margin-toggle sidenote-number">103</label><input type="checkbox" id="tufte-sn-103" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">103</span> Formally, we’d notate this random variation by saying that <span class="math display">\[\gamma_i \sim N(0, \tau^2)\]</span>, in other words, that participants’ random intercepts are sampled with a normal distribution with standard deviation <span class="math inline">\(\tau\)</span>.</span></p>
<p>The random intercept means that we have assumed that each participant has their own typical “baseline” tea rating – some participants generally like tea more than others – and these baseline ratings are normally distributed across participants. Thus, ratings are correlated within participants because ratings cluster around each participant’s <em>unique</em> baseline tea rating.</p>
<p>Following the same logic, we could fit random intercepts for different stimulus items. The addition of these <strong>crossed</strong> random intercepts of participants and items would begin to address the challenge posed by <span class="citation">Clark (<a href="#ref-clark1973" role="doc-biblioref">1973</a>)</span> in our case study above. We model participants as having normally distributed variation; we can model stimulus variation the same way, with each stimulus item assumed to produce a particular average level of performance sampled from a normally distributed population.</p>
<div id="random-slopes-and-the-challenges-of-mixed-effects-modelss" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Random slopes and the challenges of mixed effects modelss</h3>
<p>Linear mixed effects models can be further extended to model clustering of the independent variables’ effects across subjects. To do so, we can introduce <strong>random slopes</strong> (<span class="math inline">\(\delta_i\)</span>) to the model, which are multiplied by the condition variable <span class="math inline">\(X\)</span> and represent differences across participants in the effect of tea-tasting:</p>
<p><span class="math display">\[Y_i = \theta_{milkfirst} + \beta_{teafirst} X_{it} + \gamma_i + \delta_{i} X_{it} + \epsilon_{it}\]</span>
Just like the random intercepts, these random slopes will be assumed to vary as a normal distribution.<label for="tufte-sn-104" class="margin-toggle sidenote-number">104</label><input type="checkbox" id="tufte-sn-104" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">104</span> These random slopes and intercepts can be fit independently, or assumed to be correlated with one another.</span></p>
<p>This model now describes random variation in both overall how much someone likes tea <em>and</em> how strong their preference is. Both of these likely do vary in the population and so it seems like a good thing to put these in your model. Indeed under some circumstances, adding random slopes is argued to be very important for making appropriate inferences <span class="citation">(<a href="#ref-barr2013" role="doc-biblioref">Barr et al., 2013</a>)</span>. On the other hand, the model is much more complicated. When we had a simple OLS model above, we had only two parameters to fit (<span class="math inline">\(\theta_{milkfirst}\)</span> and <span class="math inline">\(\beta_teafirst\)</span>) but now we have those two plus 48: 24 different individual participant intercepts and 24 participant slopes. This complexity can lead to problems in fitting the models, especially with very small datasets (where these parameters are not very well-constrained by the data) or very large datasets (where computing all these parameters can be tricky).<label for="tufte-sn-105" class="margin-toggle sidenote-number">105</label><input type="checkbox" id="tufte-sn-105" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">105</span> Many R users may be familiar with the widely-used <code>lme4</code> package for fitting mixed effects models using frequentist tools related to maximum likelihood. Such models can also be fit using Bayesian inference with the <code>brms</code> package, which provides many powerful methods for specifying complex models.</span></p>
<p>More generally, linear mixed effects models are very powerful and they have become quite common in psychology. But they do have significant limitations. As we discussed, they can be tricky to fit in standard software packages. Further, the inferences we make using these models relies on our ability to specify the structure of the random effects correctly.<label for="tufte-sn-106" class="margin-toggle sidenote-number">106</label><input type="checkbox" id="tufte-sn-106" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">106</span> One particularly problematic situation is when the correlation structure of the errors is mis-specified, for example if observations within a participant are more correlated for participants in the treatment group than in the control group; in such cases, mixed model estimates can be substantially biased <span class="citation">(<a href="#ref-bie2021fitting" role="doc-biblioref">Bie et al., 2021</a>)</span>.</span> If we write an incorrect model our inferences are wrong, but it is sometimes difficult to know how to check whether your model is reasonable, especially with a small number of clusters or observations.</p>






</div>
</div>
<div id="how-do-you-use-models-to-analyze-data" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> How do you use models to analyze data?</h2>
<p>In the first part of this chapter, we’ve described a suite of regression-based techniques – standard OLS, the generalized linear model, and linear mixed effects models – that can be used to model the data resulting from randomized experiments (as well as many other kinds of data). Further, when used appropriately, the regression-based estimates give an unbiased estimate of a causal effect of interest, the estimation of which is our main goal in doing an experiment. The advantage of regression models over the simpler estimation and inference methods we described in the prior two chapters is that these models can more effectively take into account a range of different kinds of variation including covariates, multiple manipulations, and clustered structure.</p>
<p>But – practically speaking – how should go you about building a model for your experiment? What should you put in and what should you leave out? There are many ways to use models to explore datasets, but in this section we will try to sketch a default approach for the use of models to estimate causal effects in experiments in the most straightforward way. Think of this as a starting point or default. We’ll begin this section by giving a set of rules of thumb, then discuss a worked example. Our final subsection will deal with the complex issue of covariate adjustment and when you should include covariates in your model.</p>
<div id="modeling-rules-of-thumb" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Modeling rules of thumb</h3>
<p>Our approach to building statistical modeling is to start with what we call the “default model.”</p>
<p>The “default” model of an experiment should include the full design of the experiment, and nothing else. If you are manipulating a variable, include it in your model. If you are manipulating two, include them both and their interaction. If your design includes repeated measurements for participants, include a random effect of participant; if it includes experimental items for which repeated measurements are made, include a random effect of stimulus. But
don’t include lots of other stuff in the default model. You are doing a randomized experiment, and the strength of randomized experiments is that you don’t have to worry about confounding based on the population (see Chapter <a href="1-experiments.html#experiments">1</a>). So don’t put a lot of covariates in your default model – usually don’t put in any!<label for="tufte-sn-107" class="margin-toggle sidenote-number">107</label><input type="checkbox" id="tufte-sn-107" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">107</span> One corollary to having this kind of default perspective on data analysis: When you see an analysis that deviates substantially from the default, these deviations should provoke some questions. If someone drops a manipulation from their analysis, adds a covariate or two, or fails to control for some clustering in the data, did they deviate because of different norms in their sub-field, or was there some other rationale? This line of reasoning sometimes leads to questions about the extent to which particular analytic decisions are post-hoc and driven by the data (in other words, <span class="math inline">\(p\)</span>-hacked).</span></p>
<p>This default model then represents a simple summary of your experimental results. Its coefficients can be interpreted as estimates of the effects of interest, and it can be used as the basis for inferences about the relation of the experimental effect to the population using either frequentist or Bayesian tools. Here’s a bit more guidance about this default modeling strategy.</p>
<ol style="list-style-type: decimal;">
<li><strong>Preregister your model</strong>. If you adjust your analysis after you see your data, you risk <span class="math inline">\(p\)</span>-hacking – choosing an analysis that inflates the estimate of your effect of interest. As we discussed in Chapter <a href="3-replication.html#replication">3</a> and as we will discuss in more detail in Chapter <a href="11-prereg.html#prereg">11</a>, one important strategy for avoiding this problem is to <strong>preregister</strong> your analysis.<label for="tufte-sn-108" class="margin-toggle sidenote-number">108</label><input type="checkbox" id="tufte-sn-108" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">108</span> A side benefit of preregistration is it makes you think through whether your experimental design is appropriate – that is, is there an analysis that estimates the effect you want from the data you intend to collect?</span></li>
</ol>
<p>
<span class="marginnote shownote">
<span style="display: block;" id="fig:models-ex-viz"></span>
<img src="experimentology_files/figure-html/models-ex-viz-1.png" alt="Raw data, means, and confidence intervals for the tea-tasting experiment." width="\linewidth" />
Figure 7.3: Raw data, means, and confidence intervals for the tea-tasting experiment.
</span>
</p>
<ol start="2" style="list-style-type: decimal;">
<li><p><strong>Visualize the model against the data</strong>. As we’ll discuss in Chapter <a href="14-viz.html#viz">14</a>, the “default model” for an experiment should go alongside a “default visualization” that similarly reflects the full design structure of the experiment and the primary clusters. In visualizing data like those from our tea-tasting experiment, show individual participants’ average ratings (as in Figure <a href="7-models.html#fig:models-ex-viz">7.3</a>). The best way to check whether a model fits your data is then to plot it on top of those data. Sometimes this combination of model and data can be as simple as a scatter plot with a regression line. But seeing the model plotted alongside the data can often reveal a mismatch between the two. A model that does not describe the data very well is not a good source of generalizable inferences!</p></li>
<li><p><strong>Interpret the predictions of the model</strong>. Once you have a model, don’t just read off the <span class="math inline">\(p\)</span>-values for your coefficients of interest. Walk through the each coefficient, considering how it relates to your outcome variable. For a simple two group design like we’ve been considering, the condition coefficient is the estimate of the causal effect that you intended to measure! Consider its sign, its magnitude, and its precision (standard error).</p></li>
</ol>
</div>
<div id="a-worked-example" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> A worked example</h3>
<p>
<span class="marginnote shownote">
<span style="display: block;" id="fig:models-sgf-stim"></span>
<img src="images/models/sgf.png" alt="Example stimulus materials from @stiller2015." width="\linewidth" />
Figure 7.4: Example stimulus materials from <span class="citation">Stiller et al. (<a href="#ref-stiller2015" role="doc-biblioref">2015</a>)</span>.
</span>
</p>
<p>All this advice may seem abstract, so let’s put it into practice on a simple example. For a change, let’s look at an experiment that’s not about tea tasting. Here we’ll consider data from an experiment testing preschool children’s language comprehension [<span class="citation">Stiller et al. (<a href="#ref-stiller2015" role="doc-biblioref">2015</a>)</span>; we also use these data in Appendix <a href="C-tidyverse.html#tidyverse">C</a>]. In this experiment, 2–5 year old children saw displays like the one in Figure <a href="7-models.html#fig:models-sgf-stim">7.4</a>. In the experimental condition, a puppet said “My friend has glasses! Which one is my friend?” The goal was to measure how many children made the inference that the puppets friend was the face with glasses and <em>no</em> hat. To estimate this effect, participants were randomly assigned to either the experimental condition or to a control condition in which the puppet had eaten too much peanut butter and couldn’t talk, but they still had to guess which face was his friend. Data from this experiment consisted of 588 total observations from 147 children, with four different experimental items – faces, houses, beds, and plates of pasta – each presented to each child. The primary hypothesis of this experiment was that an inference effect would provide support for the idea that preschool children could make pragmatic inferences.</p>
<p>This experimental design looks a lot like some versions of our tea-tasting experiment. We have one primary condition manipulation, presented between-participants so that some participants are in the experimental condition and others are in the control condition. Our measurements are repeated within participants across different experimental items. Finally, we have one important, pre-planned covariate: children’s age.<label for="tufte-sn-109" class="margin-toggle sidenote-number">109</label><input type="checkbox" id="tufte-sn-109" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">109</span> Our sampling plan for this experiment was actually <strong>stratified</strong> across age, meaning that we intentionally recruited the same number of participants for each one-year age group – because we anticipated that age was highly correlated with children’s ability to succeed in this experiment. We’ll present this kind of sampling in more detail in Chapter <a href="10-sampling.html#sampling">10</a>.</span> Experimental data are plotted in Figure <a href="7-models.html#fig:models-sgf-plot">7.5</a>.</p>
<div class="figure"><span style="display: block;" id="fig:models-sgf-plot"></span>
<p class="caption marginnote shownote">
Figure 7.5: Data for <span class="citation">Stiller et al. (<a href="#ref-stiller2015" role="doc-biblioref">2015</a>)</span>. Each point shows a single participant’s proportion correct trials plotted by age group, jittered slightly to avoid overplotting. Larger points and associated confidence intervals show mean and 95% confidence intervals for each condition.
</p>
<img src="experimentology_files/figure-html/models-sgf-plot-1.png" alt="Data for @stiller2015. Each point shows a single participant's proportion correct trials plotted by age group, jittered slightly to avoid overplotting. Larger points and associated confidence intervals show mean and 95\% confidence intervals for each condition." width="\linewidth" />
</div>
<p>How should we go about making our default model for this dataset?<label for="tufte-sn-110" class="margin-toggle sidenote-number">110</label><input type="checkbox" id="tufte-sn-110" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">110</span> This experiment was not preregistered, but the paper includes a separate replication dataset with the same analysis.</span> We simply include each of these design factors in a mixed effects model; we use a logistic variant of the linear mixed effects model (a <strong>generalized linear mixed effects model</strong>) because we would like to predict correct performance on each trial, which is a binary variable. So that gives us an effect of condition and age as a covariate. We further add an interaction between condition and age in case the condition effect varies meaningfully across groups. Finally, we add random effects of participant and experimental item.<label for="tufte-sn-111" class="margin-toggle sidenote-number">111</label><input type="checkbox" id="tufte-sn-111" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">111</span> There’s lots of debate in the literature about the best random effect structure for mixed effects models. This is a very tricky and technical subject. In brief, some folks argue for so-called <strong>maximal</strong> models, in which you include every random effect that is justified by the design <span class="citation">(<a href="#ref-barr2013" role="doc-biblioref">Barr et al., 2013</a>)</span>. In our case, that would mean including random slopes of condition for each experimental item. The problem is that these models can get very complex, and can be very hard to fit using standard software. We won’t weigh in on this topic, but as you start to use these models on more complex experimental designs, it might be worth reading up.</span></p>
<p>The resulting model looks like this:</p>
<p><span class="math display">\[
logit(Y_{it}) = \beta_{cntl} + \beta_{age} * age_y + \beta_{exp} * X_i + \beta_{age*exp} * age_i * X_i + \gamma_i + \delta_t + \epsilon_{it}
\]</span></p>
<p>Let’s break this down left to right:</p>
<ul>
<li><span class="math inline">\(logit(Y_{it})\)</span> says that we are predicting a logistic function of <span class="math inline">\(Y_it\)</span>, whether child <span class="math inline">\(i\)</span> was correct on trial <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(\beta_{cntl}\)</span> is the <strong>intercept</strong>, our estimate of the average log odds of correct responses for participants in the control condition.</li>
<li><span class="math inline">\(\beta_{age} * age_y\)</span> is the age predictor. <span class="math inline">\(\beta_{age}\)</span> represents change in log odds associated with a year more or less of age, and <span class="math inline">\(age_i\)</span> is the age for each participant.<label for="tufte-sn-112" class="margin-toggle sidenote-number">112</label><input type="checkbox" id="tufte-sn-112" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">112</span> We have <strong>centered</strong> our age predictor in this example so that all estimates from our model are for the average age of our participants. Centering is a good practice for modeling continuous predictors because it increases the interpretability of other parts of the model. For example, because age is centered in this model, the intercept <span class="math inline">\(\beta_{cntl}\)</span> can be interpreted as the predicted odds of a correct trial for a participant at the average age.</span></li>
<li><span class="math inline">\(\beta_{exp} * X_i\)</span> is the condition predictor. <span class="math inline">\(\beta_{exp}\)</span> represents the change in log odds associated with being in the experimental condition (the causal effect of interest!), and <span class="math inline">\(X_i\)</span> an indicator variable that is 1 if child <span class="math inline">\(i\)</span> is in the experimental condition and 0 for the control conditions. Multiplying <span class="math inline">\(\beta_{exp}\)</span> by this indicator means that the predictor has the value 0 for participants in the control condition and <span class="math inline">\(\beta_{exp}\)</span> for those in the experimental condition.</li>
<li><span class="math inline">\(\beta_{age*exp} * age_i * X_i\)</span> is the interaction between age and experimental condition. <span class="math inline">\(\beta_{age*exp}\)</span> represents the change in log odds associated with being one year older <em>and</em> in the experimental condition. This term is multiplied by both each child’s age <em>and</em> the condition indicator <span class="math inline">\(X_i\)</span>.</li>
<li><span class="math inline">\(\gamma_i\)</span> is the random intercept for individual participants, capturing individual variation in the odds of success across trials.</li>
<li><span class="math inline">\(\delta_t\)</span> is the random intercept for individual experimental items, capturing variation in the odds of success across the four different items.</li>
</ul>
<caption>
<span id="tab:models-sgf-model-print">Table 7.3: </span>
</caption>
<div custom-style="Table Caption">
<em>Estimated effects for our generalized linear mixed effects model on data from Stiller et al. (2015).</em>
</div>
<table><thead><tr class="header"><th align="left">Term</th><th align="left"><span class="math inline">\(\hat{\beta}\)</span></th><th align="left">95% CI</th><th align="left"><span class="math inline">\(z\)</span></th><th align="left"><span class="math inline">\(p\)</span></th></tr></thead><tbody><tr class="odd"><td align="left">Control condition</td><td align="left">-1.46</td><td align="left">[-1.88, -1.04]</td><td align="left">-6.76</td><td align="left">&lt; .001</td></tr><tr class="even"><td align="left">Age (years)</td><td align="left">-0.38</td><td align="left">[-0.75, -0.01]</td><td align="left">-1.99</td><td align="left">.046</td></tr><tr class="odd"><td align="left">Experimental condition</td><td align="left">2.26</td><td align="left">[1.82, 2.70]</td><td align="left">10.07</td><td align="left">&lt; .001</td></tr><tr class="even"><td align="left">Age (years) * Experimental condition</td><td align="left">0.92</td><td align="left">[0.42, 1.43]</td><td align="left">3.60</td><td align="left">&lt; .001</td></tr></tbody></table>
<p>Let’s estimate this model and see how it looks. We’ll focus here on interpretation of the so-called <strong>fixed effects</strong> (the main predictors), as opposed to the participant and item random effects.<label for="tufte-sn-113" class="margin-toggle sidenote-number">113</label><input type="checkbox" id="tufte-sn-113" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">113</span> Participant means are estimated to have a standard deviation of 0.23 (in log odds) while items have a standard deviation of <code>r</code>round(as.data.frame(lme4::VarCorr(mod))$sdcor[2],2)`. These indicate that both of our random effects capture meaningful variation.</span> Table <a href="7-models.html#tab:models-sgf-model-print">7.3</a> shows the coefficients. Again, let’s walk through each.</p>
<ul>
<li><p>The control condition estimate (intercept) is <span class="math inline">\(\hat{\beta} = -1.46\)</span>, 95% CI <span class="math inline">\([-1.88, -1.04]\)</span>, <span class="math inline">\(z = -6.76\)</span>, <span class="math inline">\(p &lt; .001\)</span>. This estimate reflects that the log odds of a correct response for an average-age participant in the control condition is -1.46, which corresponds to a probability of 0.19. If we look at Figure <a href="7-models.html#fig:models-sgf-plot">7.5</a>, that estimate makes sense: 0.19 seems close to the average for the control condition.</p></li>
<li><p>The age effect estimate is <span class="math inline">\(\hat{\beta} = -0.38\)</span>, 95% CI <span class="math inline">\([-0.75, -0.01]\)</span>, <span class="math inline">\(z = -1.99\)</span>, <span class="math inline">\(p = .046\)</span>. There is a slight decrease in the probability of a correct response for older children in the control condition. Again, looking at Figure <a href="7-models.html#fig:models-sgf-plot">7.5</a>, this estimate is interpretable: we see a small decline in the probability of a correct response for the oldest age group.</p></li>
<li><p>The key experimental condition estimate then is <span class="math inline">\(\hat{\beta} = 2.26\)</span>, 95% CI <span class="math inline">\([1.82, 2.70]\)</span>, <span class="math inline">\(z = 10.07\)</span>, <span class="math inline">\(p &lt; .001\)</span>. This estimate means that the log odds of a correct response for an average-age participant in the experimental condition is the sum of the estimates for the control (intercept) and the experimental conditions: -1.46 + 2.26, which corresponds to a probability of 0.69. Again, grounding our interpretation in Figure <a href="7-models.html#fig:models-sgf-plot">7.5</a>, this estimate corresponds to the average value for the experimental condition.</p></li>
<li><p>Finally, the interaction of age and condition is <span class="math inline">\(\hat{\beta} = 0.92\)</span>, 95% CI <span class="math inline">\([0.42, 1.43]\)</span>, <span class="math inline">\(z = 3.60\)</span>, <span class="math inline">\(p &lt; .001\)</span>. This positive coefficient reflects that with every year of age, the difference between control and experimental conditions grows.</p></li>
</ul>
<p>In sum, this model suggests that there was a substantial difference in performance between experimental and control conditions, in turn supporting the hypothesis that children in the sampled age group can perform pragmatic inferences. This example illustrates the “default model” framework that we recommend – the idea that a single regression model corresponding to the design of the experiment can yield an interpretable estimate of the causal effect of interest, even in the presence of several other sources of variation.</p>
</div>
<div id="when-does-it-makes-sense-to-include-covariates-in-a-model" class="section level3" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> When does it makes sense to include covariates in a model?</h3>
<p>Let’s come back to one piece of advice that we gave above about making a “default” model of an experiment: not including covariates. This advice can seem surprising. Many demographic factors are of interest to psychologists and other behavioral scientists, and in observational studies these factors will almost always be related to important life outcomes. So why not put them into our experimental models? After all, we did include age in our worked example above!</p>
<p>Well, if you have one or at most a small handful of covariates that you believe are meaningfully related to the outcome, you <em>can</em> plan in advance to put them in your model. If you think that your effect is likely to be <strong>moderated</strong> a specific demographic characteristic – as we did with age and pragmatic inference in our example above – then this inclusion can be quite useful.</p>
<p>Further, including covariates can increase the precision of your estimates by reducing “noise” in your outcome, and if you hypothesize that they interact. What’s surprising though is how <em>little</em> this adjustment does to increase your overall precision unless the correlation between covariate and outcome is very big. Figure <a href="7-models.html#fig:models-precision">7.6</a> shows this relationship in a simple simulation. Only when the correlation between covariate and outcome (e.g., age and tea rating) is greater than .6 – .8 does this adjustment really help.<label for="tufte-sn-114" class="margin-toggle sidenote-number">114</label><input type="checkbox" id="tufte-sn-114" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">114</span> A relationship that strong is very unusual for most experiments in psychology, not least because our outcome measures are very unlikely to even be reliable enough to correlate with <em>themselves</em> at <span class="math inline">\(r &gt; .8\)</span> let alone with another variable; see Chapter <a href="8-measurement.html#measurement">8</a> for more details on this point.</span></p>
<div class="figure"><span style="display: block;" id="fig:models-precision"></span>
<p class="caption marginnote shownote">
Figure 7.6: Decreases in estimation error (root mean squared error) due to adjusting for covariates, plotted by the N participants in each group and the correlation between the covariate and the outcome.
</p>
<img src="experimentology_files/figure-html/models-precision-1.png" alt="Decreases in estimation error (root mean squared error) due to adjusting for covariates, plotted by the N participants in each group and the correlation between the covariate and the outcome." width="\linewidth" />
</div>
<p>That said, there are quite a few reasons not to include covariates – motivating our recommendation to skip them in your default model unless you have very strong expectations for either A) a correlation with the outcome or B) a strong moderation relationship.</p>
<p>The first reason is simply because we don’t need to. Because randomization cuts causal links, our experimental estimate is an unbiased estimate of the causal effect of interest. We are guaranteed that, in the limit of many different experiments, even though people with different ages will be in the different tea tasting conditions, this source of variation will be averaged out.</p>
<p>The second reason is that, on average, including more covariates into models actually (slightly) decreases the probability that the model can detect a true effect. Just by chance covariates can “soak up” variation in the outcome, leaving less to be accounted for by the true effect!</p>
<p>The third reason is that you can actually compromise your causal inference by including some covariates, particularly those that are collected <em>after</em> randomization. The logic of randomization is that you cut all causal links between features of the sample and the condition manipulation. But you can “uncut” these links by accident by adding variables into your model that are related to group status. This problem is generically called <strong>conditioning on post-treatment variables</strong> and a full discussion of is out of the scope of this book, but it’s something to avoid [and read up on if you’re worried about it; <span class="citation">Montgomery et al. (<a href="#ref-montgomery2018" role="doc-biblioref">2018</a>)</span>].</p>
<p>Finally, one of the standard justifications for controlling is actually ill-founded as well: adding covariates because your groups are unbalanced. People often talk about “unhappy randomization”: you randomize to the different tea-tasting groups, for example, but then it turns out the mean age is a bit different between groups. Then you do a t-test or some other statistical test and find out that you actually have a significant age difference.<label for="tufte-sn-115" class="margin-toggle sidenote-number">115</label><input type="checkbox" id="tufte-sn-115" class="margin-toggle" /><span class="sidenote"><span class="sidenote-number">115</span> Incidentally, this practice makes no sense: because you randomized, you know that the difference in ages occurred by chance, so why are you using a t-test to test if the variation is due to chance?</span> But incidental demographic differences between groups are unlikely to be important unless that characteristic is highly correlated with the outcome (see above).</p>
<p>So these are are options: if a covariate is known to be very strongly related to our outcome, we can include it in our default model. Otherwise, we avoid a lot of trouble by leaving covariates out.</p>
</div>
</div>
<div id="chapter-summary-models" class="section level2" number="7.7">
<h2><span class="header-section-number">7.7</span> Chapter summary: Models</h2>
<p>In the last three chapters, we have spelled out a framework for data analysis that focuses on the key experimental goal: a measurement of a particular causal effect. We began with basic techniques for estimating effects and making inferences about how these effects estimated from a sample can be generalized to a population. This chapter showed how these ideas naturally give rise to the idea of making models of data, which allow estimation of effects in more complex designs. Simple regression models, which are formally identical to other inference methods in the most basic case, can be extended with the generalized linear model as well as with mixed effects models. Finally, we ended with some guidance on how to build a “default model” – an (often pre-registered) regression model that maps onto your experimental design and provides the primary estimate of your key causal effect.</p>












































































</div>
</div>



<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-baddeley1975" class="csl-entry">
Baddeley, A. D., Thomson, N., &amp; Buchanan, M. (1975). Word length and the structure of short-term memory. <em>Journal of Verbal Learning and Verbal Behavior</em>, <em>14</em>(6), 575–589.
</div>
<div id="ref-barr2013" class="csl-entry">
Barr, D. J., Levy, R., Scheepers, C., &amp; Tily, H. J. (2013). Random effects structure for confirmatory hypothesis testing: Keep it maximal. <em>Journal of Memory and Language</em>, <em>68</em>(3), 255–278.
</div>
<div id="ref-bates2014" class="csl-entry">
Bates, D., Mächler, M., Bolker, B., &amp; Walker, S. (2014). Fitting linear mixed-effects models using lme4. <em>arXiv Preprint arXiv:1406.5823</em>.
</div>
<div id="ref-bie2021fitting" class="csl-entry">
Bie, R., Haneuse, S., Huey, N., Schildcrout, J., &amp; McGee, G. (2021). Fitting marginal models in small samples: A simulation study of marginalized multilevel models and generalized estimating equations. <em>Statistics in Medicine</em>, <em>40</em>(24), 5298–5312.
</div>
<div id="ref-clark1973" class="csl-entry">
Clark, H. H. (1973). The language-as-fixed-effect fallacy: A critique of language statistics in psychological research. <em>Journal of Verbal Learning and Verbal Behavior</em>, <em>12</em>(4), 335–359.
</div>
<div id="ref-lovatt2000" class="csl-entry">
Lovatt, P., Avons, S. E., &amp; Masterson, J. (2000). The word-length effect and disyllabic words. <em>The Quarterly Journal of Experimental Psychology: Section A</em>, <em>53</em>(1), 1–22.
</div>
<div id="ref-montgomery2018" class="csl-entry">
Montgomery, J. M., Nyhan, B., &amp; Torres, M. (2018). How conditioning on posttreatment variables can ruin your experiment and what to do about it. <em>Am. J. Pol. Sci.</em>, <em>62</em>(3), 760–775.
</div>
<div id="ref-stiller2015" class="csl-entry">
Stiller, A. J., Goodman, N. D., &amp; Frank, M. C. (2015). Ad-hoc implicature in preschool children. <em>Language Learning and Development</em>, <em>11</em>(2), 176–190.
</div>
<div id="ref-westfall2015" class="csl-entry">
Westfall, J., Judd, C. M., &amp; Kenny, D. A. (2015). Replicating studies in which samples of participants respond to samples of stimuli. <em>Perspectives on Psychological Science</em>, <em>10</em>(3), 390–399.
</div>
</div>

</div>
</div>



<script type="module" src="/assets/src/index.page.client.jsx.b42a3afa.js"></script><script id="vite-plugin-ssr_pageContext" type="application/json">{"pageContext":{"_pageId":"/src/index","islands":[{"id":"island_0","name":"TOC","props":{}},{"id":"island_1","name":"Box","props":{"title":"!undefined","type":"learning_goals","content":"\n\u003cul>\n\u003cli>Re-conceptualize statistical “tests” as models of data\u003c/li>\n\u003cli>Build intuitions about how specific “tests” (e.g., t-tests) relate to more general frameworks (e.g., regression, mixed effects models)\u003c/li>\n\u003cli>Identify which models are best suited for which research questions\u003c/li>\n\u003cli>Describe what it means to ‘control for’ something\u003c/li>\n\u003cli>Explore what kinds of clustered variance are present in our designs\u003c/li>\n\u003cli>Select models appropriate for different kinds of dependent variables\u003c/li>\n\u003c/ul>\n"}},{"id":"island_2","name":"Box","props":{"title":"Stimulus-specific effects","type":"case_study","content":"\n\n\u003cp>Imagine you’re a psycholinguist who has the hypothesis that nouns are processed faster than verbs. You run an experiment where you pick out ten verbs and ten nouns, then measure a large sample of participants’ reading time for each of these. You find strong evidence for the predicted effect and publish a paper on your claim. The only problem is that, at the same time, someone else has done exactly the same study – with different nouns and verbs – and published a paper making the opposite claim. The problem in this example is that each effect is driven by the specific experimental items that were chosen \u003cspan class=\"citation\">(\u003ca href=\"#ref-clark1973\" role=\"doc-biblioref\">Clark, 1973\u003c/a>)\u003c/span>. Out of hundreds of thousands of possible words, why these in particular?\u003c/p>\n\u003cp>The problem of generalization from sample to population is not new – as we discussed in Chapter \u003ca href=\"6-inference.html#inference\">6\u003c/a>, we are constantly doing this kind of inference with the samples of people that participate in our experiments. Our classic statistical techniques are designed to generalize from sample to population and we are typically sensitive to the weakness of generalizations made from very small samples of experimental participants. Not so with stimuli.\u003clabel for=\"tufte-sn-92\" class=\"margin-toggle sidenote-number\">92\u003c/label>\u003cinput type=\"checkbox\" id=\"tufte-sn-92\" class=\"margin-toggle\" />\u003cspan class=\"sidenote\">\u003cspan class=\"sidenote-number\">92\u003c/span> \u003cspan class=\"citation\">Clark (\u003ca href=\"#ref-clark1973\" role=\"doc-biblioref\">1973\u003c/a>)\u003c/span>, from whom this example is adapted, calls this the “language-as-fixed-effect” fallacy. This is a great label for folks who already know about fixed vs. random effects, but it doesn’t highlight how it connects to the broader set of issues of generalizability that we highlight here and in Chapter \u003ca href=\"10-sampling.html#sampling\">10\u003c/a>, so we’ll mostly use the label “stimulus generalizability.”\u003c/span>\u003c/p>\n\u003cp>Stimulus generalizability problems have reared their head across a surprising range of different areas of psychology. In one example, hundreds of papers were written about a phenomenon called the “risky shift” – in which groups deliberating about a decision would produce riskier decisions than individuals. Unfortunately, this phenomenon appeared to be completely driven by the specific choice of vignettes that groups deliberated about, with some producing a risky shift and others producing a more conservative shift \u003cspan class=\"citation\">(\u003ca href=\"#ref-westfall2015\" role=\"doc-biblioref\">Westfall et al., 2015\u003c/a>)\u003c/span>.\u003c/p>\n\u003cp>Another example comes from the memory literature, where a classic paper by \u003cspan class=\"citation\">Baddeley et al. (\u003ca href=\"#ref-baddeley1975\" role=\"doc-biblioref\">1975\u003c/a>)\u003c/span> suggested that words that take longer to pronounce (“tycoon” or “morphine”) would be remembered worse than words that took a shorter amount of time (“ember” or “wicket”) even when they had the same number of syllables. This effect also appears to be driven by the specific sets of words chosen in the original paper; the effect is robustly replicable with that set but not generalizable across other sets \u003cspan class=\"citation\">(\u003ca href=\"#ref-lovatt2000\" role=\"doc-biblioref\">Lovatt et al., 2000\u003c/a>)\u003c/span>.\u003c/p>\n\u003cp>The implication of these examples is clear: experimenters need to take care in both their experimental design and analysis to avoid overgeneralizing from their stimuli to a broader construct. Three primary steps can help experimenters avoid this pitfall:\u003c/p>\n\u003col style=\"list-style-type: decimal;\">\n\u003cli>To maximize generality, use samples of experimental items – words, pictures, or vignettes – that are comparable in size to your samples of participants.\u003c/li>\n\u003cli>When replicating an experiment, consider taking a new sample of items as well as a new sample of participants.\u003c/li>\n\u003cli>When experimental items are sampled random from a broader population, use a statistical model – such as the ones described below – that includes this sampling process.\u003c/li>\n\u003c/ol>\n"}}]}}</script></body>
</html>
