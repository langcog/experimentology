function ve(){return!(typeof process>"u"||!process.cwd||!process.versions||typeof process.versions.node>"u"||!process.release||process.release.name!=="node")}function V(e,t){let n;{var i=Error.stackTraceLimit;Error.stackTraceLimit=1/0,n=new Error(e),Error.stackTraceLimit=i}return ve()&&(n.stack=be(n.stack,t)),n}function be(e,t){if(!e)return e;const n=_e(e);let i=0;return n.filter(o=>o.includes(" (internal/")||o.includes(" (node:internal")?!1:i<t&&we(o)?(i++,!1):!0).join(`
`)}function we(e){return e.startsWith("    at ")}function _e(e){return e.split(/\r?\n/)}function P(e,t){const n=globalThis.__vite_plugin_ssr=globalThis.__vite_plugin_ssr||{};return n[e]=n[e]||t}function w(e){return typeof e=="object"&&e!==null}function z(e){return Array.from(new Set(e))}const b=P("assertPackageInstances.ts",{instances:[],alreadyLogged:new Set}),se="Make sure your client-side code doesn't include(/bundle)",re=`The client runtime of Server Routing and the client runtime of Client Routing are both being loaded. ${se} both for a given page.`,B=`Two vite-plugin-ssr client runtime instances are being loaded. ${se} vite-plugin-ssr twice. (In order to reduce the size of your client-side JavaScript bundles.)`;function U(){{const e=z(b.instances);if(e.length>1){const t=`Both vite-plugin-ssr@${e[0]} and vite-plugin-ssr@${e[1]} loaded. Only one version should be loaded.`;$e(!1,t)}}b.checkSingleInstance&&b.instances.length>1&&I(!1,B,{onlyOnce:!0,showStackTrace:!0})}function Vt(e){I(b.isClientRouting!==!0,re,{onlyOnce:!0,showStackTrace:!0}),I(b.isClientRouting===void 0,B,{onlyOnce:!0,showStackTrace:!0}),b.isClientRouting=!1,e&&(b.checkSingleInstance=!0),U()}function zt(e){I(b.isClientRouting!==!1,re,{onlyOnce:!0,showStackTrace:!0}),I(b.isClientRouting===void 0,B,{onlyOnce:!0,showStackTrace:!0}),b.isClientRouting=!0,e&&(b.checkSingleInstance=!0),U()}function Re(e){b.instances.push(e),U()}function $e(e,t){if(e)return;const n=`[vite-plugin-ssr][Wrong Usage] ${t}`;throw new Error(n)}function I(e,t,{onlyOnce:n,showStackTrace:i}){if(e)return;const s=`[vite-plugin-ssr][Warning] ${t}`;if(n){const{alreadyLogged:o}=b,l=n===!0?s:n;if(o.has(l))return;o.add(l)}console.warn(i?new Error(s):s)}const Se="0.4.132",$={projectName:"vite-plugin-ssr",projectVersion:Se,npmPackageName:"vite-plugin-ssr",githubRepository:"https://github.com/brillout/vite-plugin-ssr"};Re($.projectVersion);const E=P("utils/assert.ts",{alreadyLogged:new Set,logger(e,t){t==="info"?console.log(e):console.warn(e)},colorer:e=>e,showStackTraceList:new WeakSet}),Te=`[${$.npmPackageName}]`,Pe=`[${$.npmPackageName}@${$.projectVersion}]`,H=2;function r(e,t){var n;if(e)return;const i=(()=>{if(!t)return null;const l=typeof t=="string"?t:"`"+JSON.stringify(t)+"`";return`Debug info (this is for the ${$.projectName} maintainers; you can ignore this): ${l}`})();let s=[`You stumbled upon a bug in ${$.projectName}'s source code.`,`Go to ${$.githubRepository}/issues/new and copy-paste this error; a maintainer will fix the bug (usually under 24 hours).`,i].filter(Boolean).join(" ");s=j(s,"Bug"),s=L(s,!0);const o=V(s,H);throw(n=E.onBeforeLog)===null||n===void 0||n.call(E),o}function y(e,t,{showStackTrace:n}={}){var i;if(e)return;t=j(t,"Wrong Usage"),t=L(t);const s=V(t,H);throw n&&E.showStackTraceList.add(s),(i=E.onBeforeLog)===null||i===void 0||i.call(E),s}function Ie(e){return e=j(e,"Error"),e=L(e),V(e,H)}function S(e,t,{onlyOnce:n=!0,showStackTrace:i}={}){var s;if(!e){if(t=j(t,"Warning"),t=L(t),n){const{alreadyLogged:o}=E,l=n===!0?t:n;if(o.has(l))return;o.add(l)}if((s=E.onBeforeLog)===null||s===void 0||s.call(E),i){const o=new Error(t);E.showStackTraceList.add(o),E.logger(o,"warn")}else E.logger(t,"warn")}}function Bt(e,t,{onlyOnce:n}){var i;if(!e){if(t=j(t,"Info"),t=L(t),n){const{alreadyLogged:s}=E,o=t;if(s.has(o))return;s.add(o)}(i=E.onBeforeLog)===null||i===void 0||i.call(E),E.logger(t,"info")}}function j(e,t){let n=`[${t}]`;const i=t==="Info"?"blue":t==="Warning"?"yellow":"red";n=E.colorer(n,i);const s=e.startsWith("[")?"":" ";return`${n}${s}${e}`}function L(e,t=!1){return`${t?Pe:Te}${e}`}function G(){return typeof window<"u"&&typeof window.scrollY=="number"}const O=P("utils/assertRouterType.ts",{});function Ut(){oe(je()),O.isClientRouting=!0}function je(){return O.isClientRouting!==!1}function Ht(){oe(O.isClientRouting!==!0),O.isClientRouting=!1}function oe(e){y(G(),"`import { something } from 'vite-plugin-ssr/client/router'` is forbidden on the server-side",{showStackTrace:!0}),S(e,"You shouldn't `import { something } from 'vite-plugin-ssr/client/router'` when using Server Routing. The 'vite-plugin-ssr/client/router' utilities work only with Client Routing. In particular, don't `import { navigate }` nor `import { prefetch }` when using Server Routing as these will unnecessarily bloat your client-side bundle.",{showStackTrace:!0,onlyOnce:!0})}const Le=["js","ts","cjs","cts","mjs","mts","jsx","tsx","cjsx","ctsx","mjsx","mtsx"],le=["vue","svelte","marko","md","mdx"],Fe=[...Le,...le];function ae(e){const t=Fe.some(n=>e.endsWith("."+n));return r(!Oe(e)||t),t}function Oe(e){return/\.(c|m)?(j|t)sx?$/.test(e)}function ke(e){return le.some(t=>e.endsWith("."+t))}function k(e,t,n){return typeof e=="string"?q(e.split(""),t,n).join(""):q(e,t,n)}function q(e,t,n){const i=[];let s=t>=0?t:e.length+t;r(s>=0&&s<=e.length);let o=n>=0?n:e.length+n;for(r(o>=0&&o<=e.length);!(s===o||(s===e.length&&(s=0),s===o));){const l=e[s];r(l!==void 0),i.push(l),s++}return i}function ce(e){return e.startsWith("/")||e.startsWith("http")||e.startsWith("tauri://")||e.startsWith(".")||e.startsWith("?")||e.startsWith("#")||e===""}function Gt(e,t){r(t.includes(" but ")),y(typeof e=="string",`${t} should be a string`),!ce(e)&&(!e.startsWith("/")&&!e.includes(":")?y(!1,`${t} is '${e}' and it should be '/${e}' instead (URL pathnames should start with a leading slash)`):y(!1,`${t} isn't a valid URL`))}function We(e,t){r(ce(e),{url:e}),r(t.startsWith("/"),{url:e,baseServer:t});const[n,...i]=e.split("#");r(n!==void 0);const s=["",...i].join("#")||null;r(s===null||s.startsWith("#"));const o=s===null?"":A(s.slice(1)),[l,...a]=n.split("?");r(l!==void 0);const c=["",...a].join("?")||null;r(c===null||c.startsWith("?"),{url:e,searchOriginal:c});const u={},g={};Array.from(new URLSearchParams(c||"")).forEach(([v,Y])=>{u[v]=Y,g[v]=[...g[v]||[],Y]});const{origin:f,pathnameResolved:p}=xe(l,t);r(f===null||f===A(f),{origin:f}),r(p.startsWith("/"),{url:e,pathnameResolved:p}),r(f===null||e.startsWith(f),{url:e,origin:f});const h=l.slice((f||"").length);{const v=`${f||""}${h}${c||""}${s||""}`;r(e===v,{url:e,urlRecreated:v})}let{pathname:m,hasBaseServer:_}=De(p,t);return m=Ce(m),r(m.startsWith("/")),{origin:f,pathname:m,pathnameOriginal:h,hasBaseServer:_,search:u,searchAll:g,searchOriginal:c,hash:o,hashOriginal:s}}function A(e){try{return decodeURIComponent(e)}catch{}try{return decodeURI(e)}catch{}return e}function Ce(e){return e.split("/").map(t=>A(t).split("/").join("%2F")).join("/")}function xe(e,t){var n;if(e.startsWith("//"))return{origin:null,pathnameResolved:e};let i=!1;const s="tauri://",o="http://";e.startsWith(s)&&(i=!0,e=o+e.slice(s.length));let l,a;try{const c=new URL(e);l=c.origin,a=c.pathname}catch{l=null;let u=typeof window<"u"&&((n=window==null?void 0:window.document)===null||n===void 0?void 0:n.baseURI);u=u||"http://fake.example.org"+t,a=new URL(e,u).pathname}return a||(a="/"),i&&(r(l),r(l.startsWith(o)),l=s+l.slice(o.length)),r(a.startsWith("/"),{urlWithoutSearch:e,pathnameResolved:a}),r(a===a.split("?")[0].split("#")[0]),{origin:l,pathnameResolved:a}}function Ae(e){r(e.startsWith("/")),r(!e.includes("?")),r(!e.includes("#"))}function De(e,t){Ae(e),r(Ne(t));let n=e;if(r(n.startsWith("/")),r(t.startsWith("/")),t==="/")return{pathname:e,hasBaseServer:!0};let i=t;return t.endsWith("/")&&n===k(t,0,-1)&&(i=k(t,0,-1),r(n===i)),n.startsWith(i)?(r(n.startsWith("/")||n.startsWith("http")),r(n.startsWith(i)),n=n.slice(i.length),n.startsWith("/")||(n="/"+n),r(n.startsWith("/")),{pathname:n,hasBaseServer:!0}):{pathname:e,hasBaseServer:!1}}function Ne(e){return e.startsWith("/")}function M(e,t){Object.assign(e,t)}function W(e){return e instanceof Function||typeof e=="function"}function Mt(e){return(t,n)=>{const i=e(t),s=e(n);return i===s?0:i>s?-1:1}}function Ve(e){return(t,n)=>{const i=e(t),s=e(n);if(r([!0,!1,null].includes(i)),r([!0,!1,null].includes(s)),i===s)return 0;if(i===!0||s===!1)return-1;if(s===!0||i===!1)return 1;r(!1)}}function ze(e){return Ve(t=>{const n=e(t);return n===null?null:!n})}function d(e,t,n="unknown"){if(!w(e))return!1;if(!(t in e))return n==="undefined";if(n==="unknown")return!0;const i=e[t];return n==="array"?Array.isArray(i):n==="object"?w(i):n==="string[]"?Array.isArray(i)&&i.every(s=>typeof s=="string"):n==="function"?W(i):Array.isArray(n)?typeof i=="string"&&n.includes(i):n==="null"?i===null:n==="undefined"?i===void 0:n==="true"?i===!0:n==="false"?i===!1:typeof i===n}function Be(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}const Ue=e=>e!=null,He="\\";function ue(e){const t=n=>`Not a posix path: ${n}`;r(e!==null,t("null")),r(typeof e=="string",t(`typeof path === '${typeof e}'`)),r(e!=="",t("(empty string)")),r(e),r(!e.includes(He),t(e))}const K=/[^a-zA-Z-_]/;function fe(e){return Ge(e)!==null}function Ge(e){if(e===void 0||e.includes("\\")||e.startsWith("/"))return null;let t=null;if(e.startsWith("@")){if(!e.includes("/"))return null;const[a,...c]=e.split("/");t=a,e=c.join("/"),r(t&&t.startsWith("@"))}if(e==="")return null;const[n,...i]=e.split("/"),s=n,o=i.length===0?null:i.join("/");return r(s),r(o===null||!o.startsWith("/")),K.test(s)||t&&K.test(t.slice(1))?null:(r(!s.startsWith("/")),{npmPackageName:t?`${t}/${s}`:s,importPath:o})}const Me=["$$registrations","_rerender_only"],Je=[".md",".mdx"];function Ye(e,t){qe(e,t,!0)}function qe(e,t,n){const s=Object.keys(e).filter(a=>!Me.includes(a)),o=s.filter(a=>a!=="default"),l=s.includes("default");if(o.length===0){if(l)return;r(s.length===0),y(!1,`${t} doesn't export any value, but it should have a \`export default\` instead`)}else if(!Je.some(a=>t.endsWith(a))){const a=o.join(", ");n?S(o.length===0,`${t} should only have a default export: remove \`export { ${a} }\``,{onlyOnce:!0}):S(o.length===0,`${t} replace \`export { ${a} }\` with \`export default { ${a} }\``,{onlyOnce:!0})}}function Ke(e){return Object.entries(e)}const Qe=["clientRouting"];function Xe(e){Qe.forEach(t=>{if(r(e.fileExports),!(t in e.fileExports))return;const n=`The value of \`${t}\` is only allowed to be \`true\`.`;y(e.fileExports[t]!==!1,`${e.filePath} has \`export { ${t} }\` with the value \`false\` which is prohibited: remove \`export { ${t} }\` instead. (${n})`),y(e.fileExports[t]===!0,`${e.filePath} has \`export { ${t} }\` with a forbidden value. ${n}`)})}const de=["render","clientRouting","prerender","doNotPrerender"];function Ze(e,t){y(!de.includes(e),`${t} has \`export default { ${e} }\` which is prohibited, use \`export { ${e} }\` instead.`)}function et(e,t){const n={},i={},s={};if(e.forEach(a=>{tt(a).forEach(({exportName:u,exportValue:g,isFromDefaultExport:f})=>{var p;r(u!=="default"),s[u]=(p=s[u])!==null&&p!==void 0?p:[],s[u].push({exportValue:g,exportSource:`${a.filePath} > ${f?`\`export default { ${u} }\``:`\`export { ${u} }\``}`,filePath:a.filePath,_filePath:a.filePath,_fileType:a.fileType,_isFromDefaultExport:f})})}),t){const{configValues:a}=t;Ke(a).forEach(([c,u])=>{var g,f,p;const h=t.configElements[c];r(h);const{configDefinedByFile:m,configDefinedAt:_}=h;r(m),i[c]=(g=i[c])!==null&&g!==void 0?g:u,n[c]=(f=n[c])!==null&&f!==void 0?f:[],r(n[c].length===0),n[c].push({configValue:u,configDefinedAt:_,configDefinedByFile:m});const v=c;s[v]=(p=s[v])!==null&&p!==void 0?p:[],s[v].push({exportValue:u,exportSource:_,filePath:m,_filePath:m,_fileType:null,_isFromDefaultExport:null})})}const o=nt(),l={};return Object.entries(s).forEach(([a,c])=>{c.forEach(({exportValue:u,_fileType:g,_isFromDefaultExport:f})=>{var p;l[a]=(p=l[a])!==null&&p!==void 0?p:u,g===".page"&&!f&&(a in o||(o[a]=u))})}),r(!("default"in l)),r(!("default"in s)),{config:i,configEntries:n,exports:l,exportsAll:s,pageExports:o}}function tt(e){const{filePath:t,fileExports:n}=e;r(n),r(ae(t));const i=[];return Object.entries(n).sort(ze(([s])=>s==="default")).forEach(([s,o])=>{let l=s==="default";if(l)if(ke(t))s="Page";else{y(w(o),`The \`export default\` of ${t} should be an object.`),Object.entries(o).forEach(([a,c])=>{Ze(a,t),i.push({exportName:a,exportValue:c,isFromDefaultExport:l})});return}i.push({exportName:s,exportValue:o,isFromDefaultExport:l})}),i.forEach(({exportName:s,isFromDefaultExport:o})=>{r(!(o&&de.includes(s)))}),i}function nt(){return new Proxy({},{get(...e){return G()||S(!1,"`pageContext.pageExports` is outdated. Use `pageContext.exports` instead, see https://vite-plugin-ssr.com/exports",{onlyOnce:!0,showStackTrace:!0}),Reflect.get(...e)}})}function it(e){const t=".page.",n=k(e.split(t),0,-1).join(t);return r(!n.includes("\\")),n}function T(e){ue(e),r(e.startsWith("/")||fe(e),{filePath:e})}function Jt(e,t){if(t.length>0){const i=t.filter(s=>s.isErrorPage);return i.length===0?null:(y(i.length===1,"Only one error page can be defined"),i[0].pageId)}const n=z(e.map(({pageId:i})=>i).filter(i=>C(i)));if(y(n.length<=1,`Only one _error.page.js is allowed, but found several: ${n.join(" ")}`),n.length>0){const i=n[0];return r(i),i}return null}function C(e,t){return r(!e.includes("\\")),e.includes("/_error")}function st(e,t){if(t.length>0){const n=t.find(i=>i.pageId===e);return r(n),n.isErrorPage}else return C(e)}const rt=[".page",".page.server",".page.route",".page.client",".css"];function ot(e){if(ue(e),e.endsWith(".css"))return r(fe(e),e),".css";r(ae(e),e);const n=e.split("/").slice(-1)[0].split("."),i=n.slice(-3)[0],s=n.slice(-2)[0];if(s==="page")return".page";if(r(i==="page",e),s==="server")return".page.server";if(s==="client")return".page.client";if(s==="route")return".page.route";r(!1,e)}function ge(e){const t=o=>s.pageId===o||s.isDefaultPageFile&&(Q(s.filePath)||lt(o,s.filePath)),n=ot(e),s={filePath:e,fileType:n,isEnv:o=>{if(r(n!==".page.route"),o==="CLIENT_ONLY")return n===".page.client"||n===".css";if(o==="SERVER_ONLY")return n===".page.server";if(o==="CLIENT_AND_SERVER")return n===".page";r(!1)},isRelevant:t,isDefaultPageFile:D(e),isRendererPageFile:n!==".css"&&D(e)&&Q(e),isErrorPageFile:C(e),pageId:it(e)};return s}function D(e){return T(e),C(e)?!1:e.includes("/_default")}function Q(e){return T(e),e.includes("/renderer/")}function lt(e,t){T(e),T(t),r(!e.endsWith("/")),r(!t.endsWith("/")),r(D(t));const n=k(t.split("/"),0,-1).filter(i=>i!=="_default").join("/");return e.startsWith(n)}function at(e){r(Array.isArray(e)||e===null),r(e!==null),e.forEach(t=>{r(w(t)),r(d(t,"pageId","string")),r(d(t,"routeFilesystem","string")||d(t,"routeFilesystem","null")),r(d(t,"routeFilesystemDefinedBy","string")||d(t,"routeFilesystemDefinedBy","null")),r(d(t,"loadCodeFiles","function")),r(d(t,"isErrorPage","boolean")),r(d(t,"configElements","object")),he(t.configElements,!1)})}function ct(e){he(e,!0)}function he(e,t){r(w(e)),Object.entries(e).forEach(([n,i])=>{if(r(w(i)||i===null),i===null){r(t);return}r(d(i,"configDefinedAt","string")),r(d(i,"plusConfigFilePath","string")||d(i,"plusConfigFilePath","null")),r(d(i,"configEnv","string")),r(d(i,"codeFilePath","string")||d(i,"codeFilePath","null")),r(d(i,"codeFileExport","string")||d(i,"codeFileExport","null")),r(d(i,"configValueSerialized","string")||d(i,"configValueSerialized","undefined")),(t||n==="route")&&r(d(i,"configValue")||d(i,"configValueSerialized"))})}const ut=[{is:e=>e===void 0,match:e=>e==="!undefined",serialize:()=>"!undefined",deserialize:()=>{}},{is:e=>e===1/0,match:e=>e==="!Infinity",serialize:()=>"!Infinity",deserialize:()=>1/0},{is:e=>e===-1/0,match:e=>e==="!-Infinity",serialize:()=>"!-Infinity",deserialize:()=>-1/0},{is:e=>typeof e=="number"&&isNaN(e),match:e=>e==="!NaN",serialize:()=>"!NaN",deserialize:()=>NaN},{is:e=>e instanceof Date,match:e=>e.startsWith("!Date:"),serialize:e=>"!Date:"+e.toISOString(),deserialize:e=>new Date(e.slice(6))},{is:e=>typeof e=="bigint",match:e=>e.startsWith("!BigInt:"),serialize:e=>"!BigInt:"+e.toString(),deserialize:e=>{if(typeof BigInt>"u")throw new Error("Your JavaScript environement does not support BigInt. Consider adding a polyfill.");return BigInt(e.slice(8))}},{is:e=>e instanceof RegExp,match:e=>e.startsWith("!RegExp:"),serialize:e=>"!RegExp:"+e.toString(),deserialize:e=>{e=e.slice(8);const t=e.match(/\/(.*)\/(.*)?/),n=t[1],i=t[2];return new RegExp(n,i)}},{is:e=>e instanceof Map,match:e=>e.startsWith("!Map:"),serialize:(e,t)=>"!Map:"+t(Array.from(e.entries())),deserialize:(e,t)=>new Map(t(e.slice(5)))},{is:e=>e instanceof Set,match:e=>e.startsWith("!Set:"),serialize:(e,t)=>"!Set:"+t(Array.from(e.values())),deserialize:(e,t)=>new Set(t(e.slice(5)))},{is:e=>typeof e=="string"&&e.startsWith("!"),match:e=>e.startsWith("!"),serialize:e=>"!"+e,deserialize:e=>e.slice(1)}];function J(e){const t=JSON.parse(e);return pe(t)}function pe(e){return typeof e=="string"?ft(e):(typeof e=="object"&&e!==null&&Object.entries(e).forEach(([t,n])=>{e[t]=pe(n)}),e)}function ft(e){for(const{match:t,deserialize:n}of ut)if(t(e))return n(e,J);return e}function dt(e){e.forEach(t=>{Object.entries(t.configElements).forEach(([n,i])=>{gt(i),n==="route"&&ht(i)})})}function gt(e){const{configValueSerialized:t}=e;t!==void 0&&(e.configValue=J(t))}function ht(e){r(d(e,"configValue"));const{configValue:t}=e,n=typeof t;y(n==="string"||W(t),`${e.configDefinedAt} has an invalid type '${n}': it should be a string or a function instead, see https://vite-plugin-ssr.com/route`)}function pt(e){r(d(e,"isGeneratedFile")),r(e.isGeneratedFile!==!1,"vite-plugin-ssr was re-installed(/re-built). Restart your app."),r(e.isGeneratedFile===!0,`\`isGeneratedFile === ${e.isGeneratedFile}\``),r(d(e,"pageFilesLazy","object")),r(d(e,"pageFilesEager","object")),r(d(e,"pageFilesExportNamesLazy","object")),r(d(e,"pageFilesExportNamesEager","object")),r(d(e.pageFilesLazy,".page")),r(d(e.pageFilesLazy,".page.client")||d(e.pageFilesLazy,".page.server")),r(d(e,"pageFilesList","string[]")),r(d(e,"pageConfigs")),r(d(e,"pageConfigGlobal"));const{pageConfigs:t,pageConfigGlobal:n}=e;at(t),dt(t),ct(n);const i={};F(e.pageFilesLazy).forEach(({filePath:o,pageFile:l,globValue:a})=>{var c;l=i[o]=(c=i[o])!==null&&c!==void 0?c:l;const u=a;X(u),l.loadFile=async()=>{"fileExports"in l||(l.fileExports=await u(),Xe(l))}}),F(e.pageFilesExportNamesLazy).forEach(({filePath:o,pageFile:l,globValue:a})=>{var c;l=i[o]=(c=i[o])!==null&&c!==void 0?c:l;const u=a;X(u),l.loadExportNames=async()=>{if(!("exportNames"in l)){const g=await u();y("exportNames"in g,"You seem to be using Vite 2 but the latest vite-plugin-ssr versions only work with Vite 3"),r(d(g,"exportNames","string[]"),l.filePath),l.exportNames=g.exportNames}}}),F(e.pageFilesEager).forEach(({filePath:o,pageFile:l,globValue:a})=>{var c;l=i[o]=(c=i[o])!==null&&c!==void 0?c:l;const u=a;r(w(u)),l.fileExports=u}),F(e.pageFilesExportNamesEager).forEach(({filePath:o,pageFile:l,globValue:a})=>{var c;l=i[o]=(c=i[o])!==null&&c!==void 0?c:l;const u=a;r(w(u)),r(d(u,"exportNames","string[]"),l.filePath),l.exportNames=u.exportNames}),e.pageFilesList.forEach(o=>{var l;i[o]=(l=i[o])!==null&&l!==void 0?l:ge(o)});const s=Object.values(i);return s.forEach(({filePath:o})=>{r(!o.includes("\\"))}),{pageFiles:s,pageConfigs:t,pageConfigGlobal:n}}function F(e){const t=[];return Object.entries(e).forEach(([n,i])=>{r(rt.includes(n)),r(w(i)),Object.entries(i).forEach(([s,o])=>{const l=ge(s);r(l.fileType===n),t.push({filePath:s,pageFile:l,globValue:o})})}),t}function X(e){r(W(e))}const R=P("setPageFiles.ts",{});function Yt(e){const{pageFiles:t,pageConfigs:n,pageConfigGlobal:i}=pt(e);R.pageFilesAll=t,R.pageConfigs=n,R.pageConfigGlobal=i}async function qt(e,t){e?(r(!R.pageFilesGetter),r(t===void 0)):(r(R.pageFilesGetter),r(typeof t=="boolean"),(!R.pageFilesAll||!t)&&await R.pageFilesGetter());const{pageFilesAll:n,pageConfigs:i,pageConfigGlobal:s}=R;r(n&&i&&s);const o=mt(n,i);return{pageFilesAll:n,allPageIds:o,pageConfigs:i,pageConfigGlobal:s}}function mt(e,t){const n=e.filter(({isDefaultPageFile:o})=>!o).map(({pageId:o})=>o),i=z(n),s=t.map(o=>o.pageId);return[...i,...s]}function yt(e,t){return me(e,t,!0)}function Kt(e,t){return me(e,t,!1)}function me(e,t,n){const i=n?"CLIENT_ONLY":"SERVER_ONLY",s=e.filter(h=>h.isRelevant(t)&&h.fileType!==".page.route").sort(Et(n,t)),o=h=>{const m=s.filter(v=>v.pageId===t&&v.isEnv(h?"CLIENT_AND_SERVER":i));y(m.length<=1,`Merge the following files into a single file: ${m.map(v=>v.filePath).join(" ")}`);const _=m[0];return r(_===void 0||!_.isDefaultPageFile),_},l=o(!1),a=o(!0),c=h=>s.filter(m=>m.isRendererPageFile&&m.isEnv(h?"CLIENT_AND_SERVER":i))[0],u=c(!1),g=c(!0),f=s.filter(h=>h.isDefaultPageFile&&!h.isRendererPageFile&&(h.isEnv(i)||h.isEnv("CLIENT_AND_SERVER")));return[l,a,...f,u,g].filter(Ue)}function Et(e,t){const n=e?"CLIENT_ONLY":"SERVER_ONLY",i=-1,s=1,o=0;return(l,a)=>{if(!l.isDefaultPageFile&&a.isDefaultPageFile)return i;if(!a.isDefaultPageFile&&l.isDefaultPageFile)return s;{const c=l.isRendererPageFile,u=a.isRendererPageFile;if(!c&&u)return i;if(!u&&c)return s;r(c===u)}{const c=Z(t,l.filePath),u=Z(t,a.filePath);if(c<u)return i;if(u<c)return s;r(c===u)}{if(l.isEnv(n)&&a.isEnv("CLIENT_AND_SERVER"))return i;if(a.isEnv(n)&&l.isEnv("CLIENT_AND_SERVER"))return s}return o}}function Z(e,t){T(e),T(t);let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);const i=e.slice(n),s=t.slice(n),o=i.split("/").length,l=s.split("/").length;return o+l}const vt="modulepreload",bt=function(e){return"/"+e},ee={},Qt=function(t,n,i){if(!n||n.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=bt(o),o in ee)return;ee[o]=!0;const l=o.endsWith(".css"),a=l?'[rel="stylesheet"]':"";if(!!i)for(let g=s.length-1;g>=0;g--){const f=s[g];if(f.href===o&&(!l||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":vt,l||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),l)return new Promise((g,f)=>{u.addEventListener("load",g),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())};function te(e){const t=e/1e3;if(t<120){const n=ne(t);return`${n} second${ie(n)}`}{const n=t/60,i=ne(n);return`${i} minute${ie(i)}`}}function ne(e){let t=e.toFixed(1);return t.endsWith(".0")&&(t=t.slice(0,-2)),t}function ie(e){return e==="1"?"":"s"}const wt=P("utils/executeHook.ts",{userHookErrors:new Map});function _t(e,t,n){const{timeoutErr:i,timeoutWarn:s}=Rt(t);let o,l;const a=new Promise((f,p)=>{o=h=>{c(),f(h)},l=h=>{c(),p(h)}}),c=()=>{clearTimeout(u),clearTimeout(g)},u=setTimeout(()=>{S(!1,`The ${t}() hook defined by ${n} is taking more than ${te(s)}`)},s),g=setTimeout(()=>{const f=Ie(`Hook timeout: the ${t}() hook defined by ${n} didn't finish after ${te(i)}`);l(f)},i);return(async()=>{try{const f=await e();o(f)}catch(f){w(f)&&wt.userHookErrors.set(f,{hookName:t,hookFilePath:n}),l(f)}})(),a}function Rt(e){return e==="onBeforeRoute"?{timeoutErr:5*1e3,timeoutWarn:1*1e3}:e==="onBeforePrerender"?{timeoutErr:10*60*1e3,timeoutWarn:30*1e3}:{timeoutErr:40*1e3,timeoutWarn:4*1e3}}function Xt(e){const t=window.location.href,{searchOriginal:n,hashOriginal:i,pathname:s}=We(t,"/");let o;return e!=null&&e.withoutHash?o=`${s}${n||""}`:o=`${s}${n||""}${i||""}`,r(o.startsWith("/")),o}r(G());function Zt(){const e="vite-plugin-ssr_pageContext",t=document.getElementById(e);y(t,`The element #${e} (which vite-plugin-ssr automatically injects into the HTML) is missing from the DOM. This may happen if your HTML is malformed. Make sure your HTML isn't malformed, and make sure you don't remove #${e} from the HTML nor from the DOM.`);const n=t.textContent;r(n);const i=J(n);r(d(i,"pageContext","object"));const{pageContext:s}=i;return r(d(s,"_pageId","string")),M(s,{_pageContextRetrievedFromServer:{...s},_comesDirectlyFromServer:!0}),s}function N(e,t){if(!(t in e.exports))return null;const n=e.exports[t],i=e.exportsAll[t][0];r(i.exportValue===n);const s=i.exportSource;return r(s),r(!t.endsWith(")")),y(W(n),`hook ${t}() defined by ${s} should be a function`),{hookFn:n,hookFilePath:s}}function en(e,t){N(e,t)}function $t(e){const t=Object.entries(e);for(const n in e)delete e[n];t.sort(([n],[i])=>Be(n,i)).forEach(([n,i])=>{e[n]=i})}function St(e){Tt(e),Pt(e)}function Tt(e){st(e._pageId,e._pageConfigs)&&r(d(e,"is404","boolean"))}function Pt(e){if(e.is404===void 0||e.is404===null)return;const t=e.pageProps||{};if(!w(t)){S(!1,"pageContext.pageProps should be an object",{showStackTrace:!0,onlyOnce:!0});return}t.is404=t.is404||e.is404,e.pageProps=t}const x=P("preparePageContextForUserConsumptionClientSide.ts",{});function It(e,t){if(t){const s=e;r([!0,!1].includes(s.isHydration)),r([!0,!1,null].includes(s.isBackwardNavigation))}else{const s=e;r(s.isHydration===!0),r(s.isBackwardNavigation===null)}r("config"in e),r("configEntries"in e),r("exports"in e),r("exportsAll"in e),r("pageExports"in e),r(w(e.pageExports));const n=e.exports.Page;M(e,{Page:n}),kt(e),$t(e),r([!0,!1].includes(e._comesDirectlyFromServer));const i=e._comesDirectlyFromServer?Ft(e):e;return St(e),i}const jt=["then","toJSON"],Lt=["_pageId"];function Ft(e){return new Proxy(e,{get:n});function t(i){return!(i in e||jt.includes(i)||typeof i=="symbol"||typeof i!="string"||i.startsWith("__v_"))}function n(i,s){return x.disableAssertPassToClient!==s&&Ot(e._pageContextRetrievedFromServer,s,t(s)),x.disableAssertPassToClient=s,window.setTimeout(()=>{x.disableAssertPassToClient=void 0},0),e[s]}}function Ot(e,t,n){if(!n||e===null)return;const i=Object.keys(e).filter(s=>!Lt.includes(s));y(!1,[`pageContext.${t} isn't available in the browser`,`('${t}' is missing in the passToClient list [${i.map(s=>`'${s}'`).join(", ")}]).`,`Did you forget to add '${t}' to the passToClient list?`,"See https://vite-plugin-ssr.com/passToClient"].join(" "))}function kt(e){Object.entries(e).forEach(([t,n])=>{delete e[t],e[t]=n})}function Wt(e,t){var n;const i=e.filter(o=>o.pageId===t);return r(i.length<=1),(n=i[0])!==null&&n!==void 0?n:null}async function Ct(e,t){const n={};return!t&&"configValues"in e||((await e.loadCodeFiles()).forEach(s=>{const{configName:o,codeFilePath:l}=s;let a;if(s.isPlusFile){const{codeFileExports:c}=s;o!=="client"&&Ye(c,l),Object.entries(c).forEach(([u,g])=>{const f=u!=="default",p=f?u:s.configName,h=g;if(n[p]=h,f){const m=e.configElements[s.configName];r(m),e.configElements[p]={configValue:h,codeFileExport:u,codeFilePath:l,configDefinedByFile:l,configDefinedAt:`${l} > export { ${u} }`,configEnv:m.configEnv,plusConfigFilePath:null}}})}else a=s.codeFileExportValue,n[o]=a}),Object.entries(e.configElements).map(([s,o])=>{o.codeFilePath||(n[s]=o.configValue)}),M(e,{configValues:n})),e}const ye="__whileFetchingAssets";async function tn(e,t,n){const i=yt(e,n),s=Wt(t,n);let o;try{o=(await Promise.all([s&&Ct(s,!1),...i.map(h=>{var m;return(m=h.loadFile)===null||m===void 0?void 0:m.call(h)})]))[0]}catch(p){throw xt(p)&&Object.assign(p,{[ye]:!0}),p}const{config:l,configEntries:a,exports:c,exportsAll:u,pageExports:g}=et(i,o);return{config:l,configEntries:a,exports:c,exportsAll:u,pageExports:g,_pageFilesLoaded:i}}function nn(e){return e?e[ye]===!0:!1}function xt(e){return e instanceof Error?["Failed to fetch dynamically imported module","error loading dynamically imported module","Importing a module script failed","error resolving module specifier","failed to resolve module"].some(n=>e.message.toLowerCase().includes(n.toLowerCase())):!1}function sn(e,t,n){const i=e.configElements[t];if(!i||Ee(e,t))return null;const{configValue:s,configDefinedAt:o}=i;return y(typeof s===n,`${o} has an invalid type \`${typeof s}\`: is should be a ${n} instead`),s}function rn(e,t){const n=e.configElements[t];if(!n||Ee(e,t))return null;if(n.codeFilePath!==null)return n.codeFilePath;const{configValue:i,configDefinedAt:s}=n;y(typeof i=="string",`${s} has an invalid type \`${typeof i}\`: it should be a \`string\` instead`),y(!1,`${s} has an invalid value \`${i}\`: it should be a file path instead`)}function Ee(e,t){const n=e.configElements[t];if(!n)return!0;const{codeFilePath:i,configValue:s}=n;return i?!1:s==null}function At(e,t){const n=t.find(i=>i.pageId===e);return r(t.length>0),r(n),n}async function on(e,t){const n=It(e,t);let i=null,s;i=N(e,"render"),s="render";{const a=N(e,"onRenderClient");a&&(i=a,s="onRenderClient")}if(!i){const a=Dt(e);if(e._pageConfigs.length>0)Nt(e._pageId,e._pageConfigs,a);else{const c=e._pageFilesLoaded.filter(g=>g.fileType===".page.client");let u;c.length===0?u="No file `*.page.client.*` found for URL "+a:u="One of the following files should export a `render()` hook: "+c.map(g=>g.filePath).join(" "),y(!1,u)}}r(i);const o=i.hookFn;r(s);const l=await _t(()=>o(n),s,i.hookFilePath);y(l===void 0,`The ${s}() hook defined by ${i.hookFilePath} isn't allowed to return a value`)}function Dt(e){let t;try{t=e.urlOriginal}catch{}return t=t??window.location.href,t}function Nt(e,t,n){var i,s;const o=At(e,t);r(!(!((i=o.configElements.onRenderClient)===null||i===void 0)&&i.configValue)),r(((s=o.configElements.clientRouting)===null||s===void 0?void 0:s.configValue)===!0);let l=!1;t.forEach(a=>{const c=a.configElements.onRenderClient;c&&c.configValue&&(l=!0)}),y(!1,`No onRenderClient() hook defined${l?` for URL \`${n}\``:""}, but it's needed, see https://vite-plugin-ssr.com/onRenderClient`)}export{rn as A,J as B,Ie as C,qt as D,Ne as E,yt as F,sn as G,Wt as H,ce as I,Bt as J,je as K,nn as L,en as M,on as N,zt as O,Ht as P,Vt as Q,Qt as _,w as a,r as b,Ut as c,G as d,Xt as e,Kt as f,P as g,S as h,W as i,y as j,Mt as k,d as l,Ve as m,Gt as n,M as o,We as p,k as q,C as r,Yt as s,N as t,_t as u,Zt as v,tn as w,Jt as x,It as y,At as z};
